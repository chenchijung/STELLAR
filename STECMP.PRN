Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1


                                
                                	title	Stellar compiler  compile module
                                	subttl	Rev 1.01  08/30/1984
                                	name	('cmpmod')
                                .z80
                                ;*****************************************************
                                ;*                                                   *
                                ;*       Stellar compiler    compile module          *
                                ;*             ( Rev 1.01 )                          *
                                ;*                                                   *
                                ;*      Copyright (c) 1984 H.Ohnuki / MIA            *
                                ;*                                                   *
                                ;*****************************************************
                                
                                ;-----------------------------------------------------
                                ;-		external symbol			     -
                                ;-----------------------------------------------------
                                
                                ;
                                ;  i/o module
                                ;
                                	external	getsou,putobj
                                	external	stptyp,retadr
                                	external	defsta,dsaind
                                	external	regsym,seasym,elisym
                                	external	clrstb
                                	external	putglo,prtmsg
                                	external	abort,error
                                	external	ddspfn,ddspli
                                	external	inclu,edincl,pbreak,tron,troff
                                ;
                                ;  run time module
                                ;
                                	external	@start,@stop
                                	external	@mul.m,@mul.r
                                	external	@div.m,@div.r,@rem.m,@rem.r
                                	external	@shl.m,@shl.r,@shr.m,@shr.r
                                	external	@setag,@prog
                                	external	@rtwork,@stptp,@retad,@temp,@var
                                	external	crelat,drelat
                                
                                ;-----------------------------------------------------
                                ;-		p r o g r a m			     -
                                ;-----------------------------------------------------
  0000'                         		cseg
                                
                                ;
                                ;  start of compile
                                ;
  0000'                         compil::
  0000'   CD 0000*              	call	getsou		;get source program ( first line )
  0003'   D8                    	ret	c
  0004'   22 0000"              	ld	(cptr),hl
  0007'   ED 53 0002"           	ld	(lino),de
  000B'   CD 1B0F'              	call	gtoken		;get first token
  000E'   FE 80                 	cp	80h		;'prog' ?
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-1
Rev 1.01  08/30/1984

  0010'   C2 200E'              	jp	nz,synerr
  0013'   CD 1B0F'              	call	gtoken
  0016'   3D                    	dec	a
  0017'   C2 200E'              	jp	nz,synerr
  001A'   CD 198C'              	call	movname
                                ;
                                ;  option switch
                                ;
  001D'   AF                    	xor	a
  001E'   32 0004"              	ld	(optisw),a	;option switch all off
  0021'   CD 1B0F'              	call	gtoken
  0024'   FE 28                 	cp	'('
  0026'   C2 200E'              	jp	nz,synerr
  0029'                         compil1:
  0029'   CD 1B0F'              	call	gtoken
  002C'   FE 29                 	cp	')'
  002E'   CA 00AD'              	jp	z,compil7
  0031'   FE 25                 	cp	'%'
  0033'   C2 1EBE'              	jp	nz,opserr
  0036'   CD 1B0F'              	call	gtoken
  0039'   FE 84                 	cp	84h		;'debug' ?
  003B'   20 0A                 	jr	nz,compil2
  003D'   21 0004"              	ld	hl,optisw
  0040'   CB E6                 	set	4,(hl)		;%debug sw on
  0042'   CD 1B0F'              	call	gtoken
  0045'   18 5A                 	jr	compil6
  0047'                         compil2:
  0047'   3D                    	dec	a
  0048'   C2 1EBE'              	jp	nz,opserr
  004B'   2A 0017"              	ld	hl,(identi)
  004E'   7C                    	ld	a,h
  004F'   B7                    	or	a
  0050'   C2 1EBE'              	jp	nz,opserr
  0053'   7D                    	ld	a,l
  0054'   CD 1DB5'              	call	traupc		;translate to upper case
  0057'   F5                    	push	af
  0058'   CD 1B0F'              	call	gtoken
  005B'   FE 3A                 	cp	':'
  005D'   C2 1EBE'              	jp	nz,opserr
  0060'   F1                    	pop	af
  0061'   FE 50                 	cp	'P'		;%p ?
  0063'   20 09                 	jr	nz,compil3
  0065'   21 0004"              	ld	hl,optisw
  0068'   CB FE                 	set	7,(hl)		;%p sw on
  006A'   06 80                 	ld	b,80h
  006C'   18 19                 	jr	compil5
  006E'                         compil3:
  006E'   FE 44                 	cp	'D'		;%d ?
  0070'   20 09                 	jr	nz,compil4
  0072'   21 0004"              	ld	hl,optisw
  0075'   CB F6                 	set	6,(hl)
  0077'   06 40                 	ld	b,40h
  0079'   18 0C                 	jr	compil5
  007B'                         compil4:
  007B'   FE 53                 	cp	'S'		;%s ?
  007D'   C2 1EBE'              	jp	nz,opserr
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-2
Rev 1.01  08/30/1984

  0080'   21 0004"              	ld	hl,optisw
  0083'   CB EE                 	set	5,(hl)
  0085'   06 20                 	ld	b,20h
  0087'                         compil5:
  0087'   C5                    	push	bc
  0088'   CD 1B0F'              	call	gtoken
  008B'   CD 1A01'              	call	wodcon		;word constant
  008E'   F1                    	pop	af
  008F'   87                    	add	a,a
  0090'   30 03                 	jr	nc,$+5
  0092'   22 0006"              	ld	(codorg),hl	;set code segment origin address
  0095'   87                    	add	a,a
  0096'   30 03                 	jr	nc,$+5
  0098'   22 0008"              	ld	(datorg),hl	;set data segment origin address
  009B'   87                    	add	a,a
  009C'   30 03                 	jr	nc,$+5
  009E'   22 000A"              	ld	(stkbot),hl	;set stack bottom address
  00A1'                         compil6:
  00A1'   3A 0036"              	ld	a,(tokcod)
  00A4'   FE 2C                 	cp	','
  00A6'   28 81                 	jr	z,compil1
  00A8'   FE 29                 	cp	')'
  00AA'   C2 1EBE'              	jp	nz,opserr
  00AD'                         compil7:
  00AD'   CD 1B0F'              	call	gtoken
  00B0'   FE 3B                 	cp	';'
  00B2'   C2 200E'              	jp	nz,synerr
  00B5'   3A 0004"              	ld	a,(optisw)
  00B8'   CB 67                 	bit	4,a		;%debug sw on ?
  00BA'   3E 55                 	ld	a,55h
  00BC'   28 02                 	jr	z,$+4
  00BE'   3E 65                 	ld	a,65h
  00C0'   CD 0000*              	call	putobj		;put start mark
  00C3'   2A 0006"              	ld	hl,(codorg)
  00C6'   22 000C"              	ld	(cloc),hl	;set code location counter
  00C9'   CD 19B2'              	call	ptloc
  00CC'   2A 0008"              	ld	hl,(datorg)
  00CF'   22 000E"              	ld	(dloc),hl	;set data location counter
  00D2'   22 0010"              	ld	(wloc),hl
  00D5'   3E 56                 	ld	a,56h
  00D7'   CD 199F'              	call	ptname		;put program name
  00DA'   21 03F1'              	ld	hl,pgnati
  00DD'   CD 0000*              	call	prtmsg
  00E0'   21 0026"              	ld	hl,strbuf
  00E3'   CD 0000*              	call	prtmsg		;print program name
  00E6'   CD 0417'              	call	otrunt		;output run time routine
  00E9'   CD 0000*              	call	clrstb		;clear symbol table
                                ;
                                ;  define figurative constant
                                ;
  00EC'   2A 0008"              	ld	hl,(datorg)
  00EF'   CD 0487'              	call	deficn
  00F2'   5F 77 6F 72           	defb	'_work',0
  00F6'   6B 00                 
                                
  00F8'   2A 000E"              	ld	hl,(dloc)
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-3
Rev 1.01  08/30/1984

  00FB'   CD 0487'              	call	deficn
  00FE'   5F 76 61 72           	defb	'_var',0
  0102'   00                    
                                
  0103'   2A 0006"              	ld	hl,(codorg)
  0106'   CD 0487'              	call	deficn
  0109'   5F 63 6F 64           	defb	'_code',0
  010D'   65 00                 
                                
                                ;
                                ;  main
                                ;
  010F'                         main::
  010F'   16 3E                 	ld	d,3eh		;"  LD	A,STOP_TYPE   "
  0111'   1E 00*                	ld	e,stptyp
  0113'   CD 1964'              	call	ptcod2
  0116'   3E 32                 	ld	a,32h		;"  LD	(@STPTY),A    "
  0118'   2A 0008"              	ld	hl,(datorg)
  011B'   11 0000*              	ld	de,@stptp-@rtwork
  011E'   19                    	add	hl,de
  011F'   CD 196E'              	call	ptcod3
  0122'   3E 00*                	ld	a,stptyp
  0124'   B7                    	or	a		;halt ?
  0125'   28 22                 	jr	z,main0
  0127'   3D                    	dec	a		;ret ?
  0128'   20 08                 	jr	nz,main0.5
  012A'   11 ED73               	ld	de,0ed73h	;"  LD	(@RETAD),SP	"
  012D'   CD 1964'              	call	ptcod2
  0130'   18 0D                 	jr	main0.6
  0132'                         main0.5:
  0132'   3E 21                 	ld	a,021h		;"  LD	HL,RETURN_ADDRESS	"
  0134'   21 0000*              	ld	hl,retadr
  0137'   CD 196E'              	call	ptcod3
  013A'   3E 22                 	ld	a,22h		;"  LD	(@RETAD),HL	"
  013C'   CD 1953'              	call	ptcod1
  013F'                         main0.6:
  013F'   2A 0008"              	ld	hl,(datorg)
  0142'   11 0000*              	ld	de,@retad-@rtwork
  0145'   19                    	add	hl,de
  0146'   CD 1966'              	call	ptcodw
  0149'                         main0:
  0149'   3A 0004"              	ld	a,(optisw)
  014C'   2A 000A"              	ld	hl,(stkbot)
  014F'   CB 6F                 	bit	5,a		;%s on ?
  0151'   20 15                 	jr	nz,main1
  0153'   3E 00*                	ld	a,dsaind
  0155'   21 0000*              	ld	hl,defsta
  0158'   B7                    	or	a		;indirect ?
  0159'   28 0D                 	jr	z,main1
  015B'   E5                    	push	hl
  015C'   11 ED7B               	ld	de,0ed7bh	; LD  SP,(DEFSTA)	"
  015F'   CD 1964'              	call	ptcod2
  0162'   E1                    	pop	hl
  0163'   CD 1966'              	call	ptcodw
  0166'   18 05                 	jr	main2
  0168'                         main1:
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-4
Rev 1.01  08/30/1984

  0168'   3E 31                 	ld	a,31h		;"  LD  SP,nn	"
  016A'   CD 196E'              	call	ptcod3
  016D'                         main2:
  016D'   3E 21                 	ld	a,21h		;"  LD  HL,@STOP  "
  016F'   2A 0006"              	ld	hl,(codorg)
  0172'   11 0000*              	ld	de,@stop-@start
  0175'   19                    	add	hl,de
  0176'   CD 196E'              	call	ptcod3
  0179'   3E E5                 	ld	a,0e5h		;"  PUSH  HL  "
  017B'   CD 1953'              	call	ptcod1
                                
  017E'   CD 1B0F'              	call	gtoken
  0181'   AF                    	xor	a
  0182'   32 008C"              	ld	(idxpsf),a
  0185'   CD 049E'              	call	defdcl		;global conatant,variable,data
  0188'   FE 7B                 	cp	'{'
  018A'   C2 200E'              	jp	nz,synerr
  018D'   3E FF                 	ld	a,0ffh
  018F'   32 0005"              	ld	(stmflg),a
  0192'   2A 0002"              	ld	hl,(lino)
  0195'   CD 0000*              	call	ddspli		;line number display object out
  0198'   CD 0B45'              	call	pshlea
  019B'   CD 0788'              	call	compou		;( statement ... )
  019E'   CD 0B5D'              	call	poplea
  01A1'   AF                    	xor	a
  01A2'   32 0005"              	ld	(stmflg),a
  01A5'   CD 1B0F'              	call	gtoken
  01A8'   3E C9                 	ld	a,0c9h		;"  RET  "
  01AA'   CD 1953'              	call	ptcod1
                                ;
                                ;  function
                                ;
  01AD'                         functi::
  01AD'   CD 0000*              	call	elisym		;elimaination local symbol
  01B0'   3A 0036"              	ld	a,(tokcod)
  01B3'   3C                    	inc	a		;end ?
  01B4'   CA 03E8'              	jp	z,endcom
  01B7'   AF                    	xor	a
  01B8'   32 008C"              	ld	(idxpsf),a
  01BB'   67                    	ld	h,a
  01BC'   6F                    	ld	l,a
  01BD'   22 008D"              	ld	(retjad),hl
  01C0'   F5                    	push	af
  01C1'   CD 049E'              	call	defdcl		;global constant,variable,data
  01C4'   2F                    	cpl
  01C5'   32 0037"              	ld	(localf),a
  01C8'   3A 0036"              	ld	a,(tokcod)
  01CB'   FE FF                 	cp	0ffh		;end ?
  01CD'   20 04                 	jr	nz,functi0
  01CF'   F1                    	pop	af
  01D0'   C3 03E8'              	jp	endcom
  01D3'                         functi0:
  01D3'   FE 8F                 	cp	8fh		;'recursive' ?
  01D5'   20 07                 	jr	nz,functi1
  01D7'   F1                    	pop	af
  01D8'   F6 80                 	or	80h
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-5
Rev 1.01  08/30/1984

  01DA'   F5                    	push	af
  01DB'   CD 1B0F'              	call	gtoken
  01DE'                         functi1:
  01DE'   3D                    	dec	a		;identifier ?
  01DF'   C2 1ED7'              	jp	nz,ilferr
  01E2'   21 0016"              	ld	hl,idetyp
  01E5'   CD 0000*              	call	seasym		;search symbol table
  01E8'   06 09                 	ld	b,09h
  01EA'   B7                    	or	a		;found ?
  01EB'   20 16                 	jr	nz,functi2
  01ED'   3A 0016"              	ld	a,(idetyp)
  01F0'   FE 89                 	cp	89h		;function ?
  01F2'   28 07                 	jr	z,functi1.5
  01F4'   C5                    	push	bc
  01F5'   CD 1EF4'              	call	ilefun
  01F8'   C1                    	pop	bc
  01F9'   18 08                 	jr	functi2
  01FB'                         functi1.5:
  01FB'   2A 0023"              	ld	hl,(adrs)
  01FE'   F5                    	push	af
  01FF'   CD 19B7'              	call	ptcha		;put chain address
  0202'   C1                    	pop	bc
  0203'                         functi2:
  0203'   2A 000C"              	ld	hl,(cloc)
  0206'   22 0023"              	ld	(adrs),hl
  0209'   CB B8                 	res	7,b
  020B'   21 0016"              	ld	hl,idetyp
  020E'   70                    	ld	(hl),b
  020F'   CD 0000*              	call	regsym		;symbol table register
  0212'   CD 198C'              	call	movname
  0215'   3E 57                 	ld	a,57h
  0217'   CD 199F'              	call	ptname		;put function name
  021A'   21 0404'              	ld	hl,funati
  021D'   CD 0000*              	call	prtmsg
  0220'   21 0026"              	ld	hl,strbuf
  0223'   E5                    	push	hl
  0224'   CD 0000*              	call	prtmsg		;print function name
  0227'   E1                    	pop	hl
  0228'   CD 0000*              	call	ddspfn		;function name display object out
  022B'   CD 1B0F'              	call	gtoken
  022E'   FE 28                 	cp	'('
  0230'   C2 200E'              	jp	nz,synerr
  0233'   2A 000E"              	ld	hl,(dloc)
  0236'   22 0088"              	ld	(varadr),hl
  0239'   AF                    	xor	a
  023A'   32 008A"              	ld	(varsiz),a
  023D'   CD 1B0F'              	call	gtoken
  0240'   FE 3B                 	cp	';'
  0242'   28 44                 	jr	z,functi5
  0244'   FE 29                 	cp	')'
  0246'   28 7B                 	jr	z,functi10
  0248'   3D                    	dec	a		;identifier ?
  0249'   C2 1F06'              	jp	nz,ilnerr
  024C'   18 03                 	jr	$+5
  024E'                         functi3:
  024E'   CD 1B0F'              	call	gtoken
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-6
Rev 1.01  08/30/1984

  0251'   CD 0662'              	call	symchk		;symbol search & type check
  0254'   F6 02                 	or	02h
  0256'   2A 000E"              	ld	hl,(dloc)
  0259'   22 0023"              	ld	(adrs),hl
  025C'   21 0016"              	ld	hl,idetyp
  025F'   77                    	ld	(hl),a
  0260'   CD 0000*              	call	regsym		;symbol table register
  0263'   2A 000E"              	ld	hl,(dloc)
  0266'   23                    	inc	hl
  0267'   22 000E"              	ld	(dloc),hl
  026A'   22 0010"              	ld	(wloc),hl
  026D'   21 008A"              	ld	hl,varsiz
  0270'   7E                    	ld	a,(hl)
  0271'   FE 20                 	cp	32
  0273'   30 01                 	jr	nc,$+3
  0275'   34                    	inc	(hl)
  0276'   CD 1B0F'              	call	gtoken
  0279'   FE 2C                 	cp	','
  027B'   28 D1                 	jr	z,functi3
  027D'   FE 3B                 	cp	';'
  027F'   28 07                 	jr	z,functi5
  0281'   FE 29                 	cp	')'
  0283'   28 3E                 	jr	z,functi10
  0285'   C3 200E'              	jp	synerr
  0288'                         functi5:
  0288'   CD 1B0F'              	call	gtoken
  028B'   FE 23                 	cp	'#'
  028D'   20 07                 	jr	nz,functi6
  028F'   F1                    	pop	af
  0290'   F6 08                 	or	1000b
  0292'   F5                    	push	af
  0293'   CD 1B0F'              	call	gtoken
  0296'                         functi6:
  0296'   FE BF                 	cp	0bfh		;'ix' ?
  0298'   20 07                 	jr	nz,functi7
  029A'   F1                    	pop	af
  029B'   F6 04                 	or	0100b
  029D'   F5                    	push	af
  029E'   CD 1B0F'              	call	gtoken
  02A1'                         functi7:
  02A1'   FE 2C                 	cp	','
  02A3'   20 19                 	jr	nz,functi9
  02A5'   CD 1B0F'              	call	gtoken
  02A8'   FE 23                 	cp	'#'
  02AA'   20 07                 	jr	nz,functi8
  02AC'   F1                    	pop	af
  02AD'   F6 02                 	or	0010b
  02AF'   F5                    	push	af
  02B0'   CD 1B0F'              	call	gtoken
  02B3'                         functi8:
  02B3'   FE C0                 	cp	0c0h		;'iy' ?
  02B5'   20 07                 	jr	nz,functi9
  02B7'   F1                    	pop	af
  02B8'   F6 01                 	or	0001b
  02BA'   F5                    	push	af
  02BB'   CD 1B0F'              	call	gtoken
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-7
Rev 1.01  08/30/1984

  02BE'                         functi9:
  02BE'   FE 29                 	cp	')'
  02C0'   C2 200E'              	jp	nz,synerr
  02C3'                         functi10:
  02C3'   F1                    	pop	af
  02C4'   CB 57                 	bit	2,a
  02C6'   28 0E                 	jr	z,functi11
  02C8'   F5                    	push	af
  02C9'   3E 22                 	ld	a,22h		;"  LD	(TEMP1),HL  "
  02CB'   2A 0008"              	ld	hl,(datorg)
  02CE'   11 0000*              	ld	de,@temp-@rtwork
  02D1'   19                    	add	hl,de
  02D2'   CD 196E'              	call	ptcod3
  02D5'   F1                    	pop	af
  02D6'                         functi11:
  02D6'   CB 47                 	bit	0,a
  02D8'   28 12                 	jr	z,functi12
  02DA'   F5                    	push	af
  02DB'   11 ED53               	ld	de,0ed53h	;"  LD	(TEMP2),DE  "
  02DE'   CD 1964'              	call	ptcod2
  02E1'   2A 0008"              	ld	hl,(datorg)
  02E4'   11 0002*              	ld	de,@temp+2-@rtwork
  02E7'   19                    	add	hl,de
  02E8'   CD 1966'              	call	ptcodw
  02EB'   F1                    	pop	af
  02EC'                         functi12:
  02EC'   F5                    	push	af
  02ED'   3A 008A"              	ld	a,(varsiz)
  02F0'   5F                    	ld	e,a
  02F1'   16 0E                 	ld	d,0eh		;"  LD	C,n  "
  02F3'   CD 1964'              	call	ptcod2
  02F6'   3E 11                 	ld	a,11h		;"  LD  DE,0  "
  02F8'   21 0000               	ld	hl,0
  02FB'   CD 196E'              	call	ptcod3
  02FE'   2A 0088"              	ld	hl,(varadr)
  0301'   F1                    	pop	af
  0302'   CB 7F                 	bit	7,a
  0304'   28 08                 	jr	z,functi13
  0306'   E5                    	push	hl
  0307'   ED 5B 000C"           	ld	de,(cloc)
  030B'   1B                    	dec	de
  030C'   1B                    	dec	de
  030D'   D5                    	push	de
  030E'                         functi13:
  030E'   F5                    	push	af
  030F'   3E 21                 	ld	a,21h		;"  LD	HL,nn
  0311'   CD 196E'              	call	ptcod3
  0314'   3E CD                 	ld	a,0cdh		;"  CAll @SETAG  "
  0316'   2A 0006"              	ld	hl,(codorg)
  0319'   11 0000*              	ld	de,@setag-@start
  031C'   19                    	add	hl,de
  031D'   CD 196E'              	call	ptcod3
  0320'   F1                    	pop	af
  0321'   CB 5F                 	bit	3,a
  0323'   20 0D                 	jr	nz,functi14
  0325'   F5                    	push	af
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-8
Rev 1.01  08/30/1984

  0326'   11 DDE5               	ld	de,0dde5h	;"  PUAH IX"
  0329'   CD 1964'              	call	ptcod2
  032C'   3E FF                 	ld	a,0ffh
  032E'   32 008C"              	ld	(idxpsf),a
  0331'   F1                    	pop	af
  0332'                         functi14:
  0332'   CB 4F                 	bit	1,a
  0334'   20 0D                 	jr	nz,functi15
  0336'   F5                    	push	af
  0337'   11 FDE5               	ld	de,0fde5h	;"  PUSH IY"
  033A'   CD 1964'              	call	ptcod2
  033D'   3E FF                 	ld	a,0ffh
  033F'   32 008C"              	ld	(idxpsf),a
  0342'   F1                    	pop	af
  0343'                         functi15:
  0343'   CB 57                 	bit	2,a
  0345'   28 12                 	jr	z,functi16
  0347'   F5                    	push	af
  0348'   11 DD2A               	ld	de,0dd2ah	;"  LD	IX,(TEMP1) "
  034B'   CD 1964'              	call	ptcod2
  034E'   2A 0008"              	ld	hl,(datorg)
  0351'   11 0000*              	ld	de,@temp-@rtwork
  0354'   19                    	add	hl,de
  0355'   CD 1966'              	call	ptcodw
  0358'   F1                    	pop	af
  0359'                         functi16:
  0359'   CB 47                 	bit	0,a
  035B'   28 12                 	jr	z,functi17
  035D'   F5                    	push	af
  035E'   11 FD2A               	ld	de,0fd2ah	;"LD	IY,(TEMP2) "
  0361'   CD 1964'              	call	ptcod2
  0364'   2A 0008"              	ld	hl,(datorg)
  0367'   11 0002*              	ld	de,@temp+2-@rtwork
  036A'   19                    	add	hl,de
  036B'   CD 1966'              	call	ptcodw
  036E'   F1                    	pop	af
  036F'                         functi17:
  036F'   F5                    	push	af
  0370'   CD 1B0F'              	call	gtoken
  0373'   FE 3B                 	cp	';'
  0375'   C2 200E'              	jp	nz,synerr
                                ;
  0378'   CD 1B0F'              	call	gtoken
  037B'   3E FF                 	ld	a,0ffh
  037D'   CD 049E'              	call	defdcl		;local constant,variable,data
  0380'   FE 7B                 	cp	'{'
  0382'   C2 200E'              	jp	nz,synerr
  0385'   3E FF                 	ld	a,0ffh
  0387'   32 0005"              	ld	(stmflg),a
  038A'   2A 0002"              	ld	hl,(lino)
  038D'   CD 0000*              	call	ddspli		;line number display object out
  0390'   CD 0B45'              	call	pshlea
  0393'   CD 0788'              	call	compou		;{ statement ... }
  0396'   CD 0B5D'              	call	poplea
  0399'   AF                    	xor	a
  039A'   32 0005"              	ld	(stmflg),a
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-9
Rev 1.01  08/30/1984

  039D'   CD 1B0F'              	call	gtoken
                                ;
  03A0'   2A 008D"              	ld	hl,(retjad)
  03A3'   7C                    	ld	a,h
  03A4'   B5                    	or	l
  03A5'   C4 19B7'              	call	nz,ptcha	;put chain address
  03A8'   F1                    	pop	af
  03A9'   CB 4F                 	bit	1,a
  03AB'   20 08                 	jr	nz,functi18
  03AD'   F5                    	push	af
  03AE'   11 FDE1               	ld	de,0fde1h	;"  POP	IY  "
  03B1'   CD 1964'              	call	ptcod2
  03B4'   F1                    	pop	af
  03B5'                         functi18:
  03B5'   CB 5F                 	bit	3,a
  03B7'   20 08                 	jr	nz,functi19
  03B9'   F5                    	push	af
  03BA'   11 DDE1               	ld	de,0dde1h	;"  POP IX "
  03BD'   CD 1964'              	call	ptcod2
  03C0'   F1                    	pop	af
  03C1'                         functi19:
  03C1'   F5                    	push	af
  03C2'   3E C9                 	ld	a,0c9h		;"  RET  "
  03C4'   CD 1953'              	call	ptcod1
  03C7'   F1                    	pop	af
  03C8'   87                    	add	a,a
  03C9'   D2 01AD'              	jp	nc,functi
  03CC'   E1                    	pop	hl
  03CD'   CD 19B2'              	call	ptloc		;put location count
  03D0'   D1                    	pop	de
  03D1'   2A 000E"              	ld	hl,(dloc)
  03D4'   B7                    	or	a
  03D5'   ED 52                 	sbc	hl,de
  03D7'   CD 1966'              	call	ptcodw		;put word code
  03DA'   2A 000C"              	ld	hl,(cloc)
  03DD'   2B                    	dec	hl
  03DE'   2B                    	dec	hl
  03DF'   22 000C"              	ld	(cloc),hl
  03E2'   CD 19B2'              	call	ptloc		;put location count
  03E5'   C3 01AD'              	jp	(functi)
                                ;
                                ;  end of compile
                                ;
  03E8'                         endcom::
  03E8'   CD 0000*              	call	putglo		;put global symbol
  03EB'   3E FF                 	ld	a,0ffh		;put end mark
  03ED'   CD 0000*              	call	putobj
  03F0'   C9                    	ret
                                ;
  03F1'   0D 0A 50 72           pgnati:	defb	13,10,'Program  name : ',0
  03F5'   6F 67 72 61           
  03F9'   6D 20 20 6E           
  03FD'   61 6D 65 20           
  0401'   3A 20 00              
  0404'   0D 0A 46 75           funati:	defb	13,10,'Function name : ',0
  0408'   6E 63 74 69           
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-10
Rev 1.01  08/30/1984

  040C'   6F 6E 20 6E           
  0410'   61 6D 65 20           
  0414'   3A 20 00              
                                ;
                                ;	**  run time routine relocating out  **
                                ;
  0417'                         otrunt::
  0417'   01 0000*              	ld	bc,@prog-@start
  041A'   21 0000*              	ld	hl,@start
  041D'   DD 21 0000*           	ld	ix,crelat
  0421'   FD 21 0000*           	ld	iy,drelat
  0425'                         otrunt1:
  0425'   7D                    	ld	a,l
  0426'   DD BE 00              	cp	(ix)		;relocate ?
  0429'   20 1B                 	jr	nz,otrunt2
  042B'   7C                    	ld	a,h
  042C'   DD BE 01              	cp	(ix+1)
  042F'   20 15                 	jr	nz,otrunt2
  0431'   DD 23                 	inc	ix
  0433'   DD 23                 	inc	ix
  0435'   11 0000*              	ld	de,@start	;relocatiog code segment address
  0438'   7E                    	ld	a,(hl)
  0439'   93                    	sub	e
  043A'   5F                    	ld	e,a
  043B'   23                    	inc	hl
  043C'   7E                    	ld	a,(hl)
  043D'   9A                    	sbc	a,d
  043E'   57                    	ld	d,a
  043F'   E5                    	push	hl
  0440'   2A 0006"              	ld	hl,(codorg)
  0443'   19                    	add	hl,de
  0444'   18 29                 	jr	otrunt4
  0446'                         otrunt2:
  0446'   7D                    	ld	a,l
  0447'   FD BE 00              	cp	(iy)		;relocate ?
  044A'   20 1B                 	jr	nz,otrunt3
  044C'   7C                    	ld	a,h
  044D'   FD BE 01              	cp	(iy+1)
  0450'   20 15                 	jr	nz,otrunt3
  0452'   FD 23                 	inc	iy
  0454'   FD 23                 	inc	iy
  0456'   11 0000*              	ld	de,@rtwork	;relocatiog data segment address
  0459'   7E                    	ld	a,(hl)
  045A'   93                    	sub	e
  045B'   5F                    	ld	e,a
  045C'   23                    	inc	hl
  045D'   7E                    	ld	a,(hl)
  045E'   9A                    	sbc	a,d
  045F'   57                    	ld	d,a
  0460'   E5                    	push	hl
  0461'   2A 0008"              	ld	hl,(datorg)
  0464'   19                    	add	hl,de
  0465'   18 08                 	jr	otrunt4
  0467'                         otrunt3:
  0467'   7E                    	ld	a,(hl)
  0468'   E5                    	push	hl
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-11
Rev 1.01  08/30/1984

  0469'   C5                    	push	bc
  046A'   CD 1953'              	call	ptcod1		;put byte code
  046D'   18 05                 	jr	otrunt5
  046F'                         otrunt4:
  046F'   0B                    	dec	bc
  0470'   C5                    	push	bc
  0471'   CD 1966'              	call	ptcodw		;put word code
  0474'                         otrunt5:
  0474'   C1                    	pop	bc
  0475'   E1                    	pop	hl
  0476'   23                    	inc	hl
  0477'   0B                    	dec	bc
  0478'   78                    	ld	a,b
  0479'   B1                    	or	c
  047A'   20 A9                 	jr	nz,otrunt1
                                ;
  047C'   2A 000E"              	ld	hl,(dloc)	;reserve run time work
  047F'   11 0000*              	ld	de,@var-@rtwork
  0482'   19                    	add	hl,de
  0483'   22 000E"              	ld	(dloc),hl
  0486'   C9                    	ret
                                ;
                                ;	**  define figurative constant  **
                                ;
  0487'                         deficn:: ;	hl	  : constant value
                                	 ;	m(sp+1,sp): constant name address
  0487'   22 0023"              	ld	(adrs),hl
  048A'   21 0016"              	ld	hl,idetyp
  048D'   36 01                 	ld	(hl),01h		;global constant
  048F'   D1                    	pop	de
  0490'                         deficn1:
  0490'   1A                    	ld	a,(de)
  0491'   13                    	inc	de
  0492'   23                    	inc	hl
  0493'   77                    	ld	(hl),a
  0494'   B7                    	or	a
  0495'   20 F9                 	jr	nz,deficn1
  0497'   D5                    	push	de
  0498'   21 0016"              	ld	hl,idetyp
  049B'   C3 0000*              	jp	regsym		;symbol table register
                                ;
                                ;	**  constant definition & variable, data declare  **
                                ;
  049E'                         defdcl:: ;	a : 00h=global, not 00h=local
  049E'   32 0037"              	ld	(localf),a
  04A1'                         defdcl1:
  04A1'   3A 0036"              	ld	a,(tokcod)
  04A4'   FE 25                 	cp	'%'		;%include,%break,%tron,%troff ?
  04A6'   20 08                 	jr	nz,defdcl2
  04A8'   CD 1B0F'              	call	gtoken
  04AB'   CD 0715'              	call	iclstm
  04AE'   18 F1                 	jr	defdcl1
  04B0'                         defdcl2:
  04B0'   FE 8C                 	cp	8ch		;'cons' ?
  04B2'   20 05                 	jr	nz,defdcl3
  04B4'   CD 04CA'              	call	condef
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-12
Rev 1.01  08/30/1984

  04B7'   18 E8                 	jr	defdcl1
  04B9'                         defdcl3:
  04B9'   FE 8D                 	cp	8dh		;'var' ?
  04BB'   20 05                 	jr	nz,defdcl4
  04BD'   CD 050F'              	call	vardcl
  04C0'   18 DF                 	jr	defdcl1
  04C2'                         defdcl4:
  04C2'   FE 8E                 	cp	8eh		;'data' ?
  04C4'   C0                    	ret	nz
  04C5'   CD 05AC'              	call	datdcl
  04C8'   18 D7                 	jr	defdcl1
                                ;
                                ; constant definition
                                ;
  04CA'                         condef::
  04CA'   CD 1B0F'              	call 	gtoken
  04CD'   3D                    	dec	a		;identifier ?
  04CE'   C2 1F06'              	jp	nz,ilnerr
  04D1'   CD 0662'              	call	symchk		;symbol search & type check
  04D4'   F6 01                 	or	01h		;type = constant name
  04D6'   01 000D               	ld	bc,adrs-idetyp
  04D9'   21 0016"              	ld	hl,idetyp
  04DC'   77                    	ld	(hl),a
  04DD'   CD 1AF3'              	call	blkpsh		;block push
  04E0'   CD 1B0F'              	call	gtoken
  04E3'   FE F0                 	cp	0f0h		;':=' ?
  04E5'   C2 200E'              	jp	nz,synerr
  04E8'   CD 1B0F'              	call	gtoken
  04EB'   CD 19C7'              	call	conexp		;constant expression
  04EE'   22 0023"              	ld	(adrs),hl
  04F1'   01 000D               	ld	bc,adrs-idetyp
  04F4'   21 0016"              	ld	hl,idetyp
  04F7'   CD 1B03'              	call	blkpop		;block pop
  04FA'   21 0016"              	ld	hl,idetyp
  04FD'   CD 0000*              	call	regsym		;symbol table register
  0500'   3A 0036"              	ld	a,(tokcod)
  0503'   FE 2C                 	cp	','
  0505'   28 C3                 	jr	z,condef
  0507'   FE 3B                 	cp	';'
  0509'   C2 200E'              	jp	nz,synerr
  050C'   C3 1B0F'              	jp	gtoken
                                ;
                                ;  variable declare
                                ;
  050F'                         vardcl::
  050F'   CD 1B0F'              	call	gtoken
  0512'   3D                    	dec	a		;identifier ?
  0513'   C2 1F06'              	jp	nz,ilnerr
  0516'   CD 0662'              	call	symchk		;symbol search & type check
  0519'   F6 02                 	or	02h		;type = variable name
  051B'   2A 000E"              	ld	hl,(dloc)
  051E'   22 0088"              	ld	(varadr),hl
  0521'   21 0001               	ld	hl,1
  0524'   22 008A"              	ld	(varsiz),hl
  0527'   01 000D               	ld	bc,adrs-idetyp
  052A'   21 0016"              	ld	hl,idetyp
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-13
Rev 1.01  08/30/1984

  052D'   77                    	ld	(hl),a
  052E'   CD 1AF3'              	call	blkpsh		;block push
  0531'   CD 1B0F'              	call	gtoken
  0534'   FE 5B                 	cp	'['
  0536'   20 14                 	jr	nz,vardcl1
  0538'   CD 1B0F'              	call	gtoken
  053B'   CD 19C7'              	call	conexp		;constant expression
  053E'   22 008A"              	ld	(varsiz),hl
  0541'   3A 0036"              	ld	a,(tokcod)
  0544'   FE 5D                 	cp	']'
  0546'   C2 200E'              	jp	nz,synerr
  0549'   CD 1B0F'              	call	gtoken
  054C'                         vardcl1:
  054C'   FE BE                 	cp	0beh		;'at' ?
  054E'   20 22                 	jr	nz,vardcl2
  0550'   CD 1B0F'              	call	gtoken
  0553'   FE 28                 	cp	'('
  0555'   C2 200E'              	jp	nz,synerr
  0558'   CD 1B0F'              	call	gtoken
  055B'   CD 19C7'              	call	conexp		;constant expression
  055E'   22 0088"              	ld	(varadr),hl
  0561'   21 0000               	ld	hl,0
  0564'   22 008A"              	ld	(varsiz),hl
  0567'   3A 0036"              	ld	a,(tokcod)
  056A'   FE 29                 	cp	')'
  056C'   C2 200E'              	jp	nz,synerr
  056F'   CD 1B0F'              	call	gtoken
  0572'                         vardcl2:
  0572'   2A 0088"              	ld	hl,(varadr)
  0575'   22 0023"              	ld	(adrs),hl
  0578'   01 000D               	ld	bc,adrs-idetyp
  057B'   21 0016"              	ld	hl,idetyp
  057E'   CD 1B03'              	call	blkpop		;block pop
  0581'   21 0016"              	ld	hl,idetyp
  0584'   CD 0000*              	call	regsym		;symbol table register
  0587'   2A 000E"              	ld	hl,(dloc)
  058A'   ED 5B 008A"           	ld	de,(varsiz)
  058E'   19                    	add	hl,de
  058F'   22 000E"              	ld	(dloc),hl
  0592'   22 0010"              	ld	(wloc),hl
  0595'   3A 0036"              	ld	a,(tokcod)
  0598'   FE 2C                 	cp	','
  059A'   CA 050F'              	jp	z,vardcl
  059D'   FE 3B                 	cp	';'
  059F'   C2 200E'              	jp	nz,synerr
  05A2'   C3 1B0F'              	jp	gtoken
                                ;
                                ;  data declare & inline statement
                                ;
  05A5'                         inlstm::
  05A5'   3E 02                 	ld	a,2
  05A7'   32 0038"              	ld	(datinl),a
  05AA'   18 18                 	jr	datdcl2
  05AC'                         datdcl:
  05AC'   3E 01                 	ld	a,1
  05AE'   32 0038"              	ld	(datinl),a
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-14
Rev 1.01  08/30/1984

  05B1'   3E C3                 	ld	a,0c3h		;"  JP	  0  "
  05B3'   21 0000               	ld	hl,0
  05B6'   CD 196E'              	call	ptcod3
  05B9'   2A 000C"              	ld	hl,(cloc)
  05BC'   2B                    	dec	hl
  05BD'   2B                    	dec	hl
  05BE'   22 0084"              	ld	(skpadr),hl
  05C1'                         datdcl1:
  05C1'   CD 1B0F'              	call	gtoken
  05C4'                         datdcl2:
  05C4'   3A 0038"              	ld	a,(datinl)
  05C7'   3D                    	dec	a		;data decalre
  05C8'   20 27                 	jr	nz,datdcl3
  05CA'   3A 0036"              	ld	a,(tokcod)
  05CD'   3D                    	dec	a
  05CE'   20 21                 	jr	nz,datdcl3
  05D0'   2A 0000"              	ld	hl,(cptr)
  05D3'   7E                    	ld	a,(hl)
  05D4'   FE 3A                 	cp	':'		;data name ?
  05D6'   20 19                 	jr	nz,datdcl3
  05D8'   23                    	inc	hl
  05D9'   22 0000"              	ld	(cptr),hl
  05DC'   CD 0662'              	call	symchk		;symbol search & type check
  05DF'   F6 03                 	or	03h		;type = data name
  05E1'   2A 000C"              	ld	hl,(cloc)
  05E4'   22 0023"              	ld	(adrs),hl
  05E7'   21 0016"              	ld	hl,idetyp
  05EA'   77                    	ld	(hl),a
  05EB'   CD 0000*              	call	regsym		;symbol table register
  05EE'   CD 1B0F'              	call	gtoken
  05F1'                         datdcl3:
  05F1'   3A 0036"              	ld	a,(tokcod)
  05F4'   FE 22                 	cp	'"'		;string ?
  05F6'   20 2E                 	jr	nz,datdcl6
  05F8'   2A 0000"              	ld	hl,(cptr)
  05FB'                         datdcl4:
  05FB'   7E                    	ld	a,(hl)
  05FC'   23                    	inc	hl
  05FD'   FE 22                 	cp	'"'
  05FF'   20 0F                 	jr	nz,datdcl5
  0601'   7E                    	ld	a,(hl)
  0602'   23                    	inc	hl
  0603'   FE 22                 	cp	'"'
  0605'   28 09                 	jr	z,datdcl5
  0607'   2B                    	dec	hl
  0608'   22 0000"              	ld	(cptr),hl
  060B'   CD 1B0F'              	call	gtoken
  060E'   18 35                 	jr	datdcl8
  0610'                         datdcl5:
  0610'   B7                    	or	a
  0611'   20 0C                 	jr	nz,datdcl5.5
  0613'   2B                    	dec	hl
  0614'   22 0000"              	ld	(cptr),hl
  0617'   CD 1F48'              	call	bstrdt
  061A'   CD 1B0F'              	call	gtoken
  061D'   18 26                 	jr	datdcl8
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-15
Rev 1.01  08/30/1984

  061F'                         datdcl5.5:
  061F'   E5                    	push	hl
  0620'   CD 1953'              	call	ptcod1		;put byte object
  0623'   E1                    	pop	hl
  0624'   18 D5                 	jr	datdcl4
  0626'                         datdcl6:
  0626'   FE 23                 	cp	'#'
  0628'   28 04                 	jr	z,$+6
  062A'   FE 92                 	cp	92h		;'word' ?
  062C'   20 0B                 	jr	nz,datdcl7
  062E'   CD 1B0F'              	call	gtoken
  0631'   CD 1A01'              	call	wodcon		;word constant
  0634'   CD 1966'              	call	ptcodw		;put word object
  0637'   18 0C                 	jr	datdcl8
  0639'                         datdcl7:
  0639'   FE 91                 	cp	91h		;'byte' ?
  063B'   CC 1B0F'              	call	z,gtoken
  063E'   CD 19ED'              	call	bytcon		;byte constant
  0641'   7D                    	ld	a,l
  0642'   CD 1953'              	call	ptcod1		;put byte constant
  0645'                         datdcl8:
  0645'   3A 0036"              	ld	a,(tokcod)
  0648'   FE 2C                 	cp	','
  064A'   CA 05C1'              	jp	z,datdcl1
  064D'   FE 3B                 	cp	';'
  064F'   C2 200E'              	jp	nz,synerr
  0652'   21 0038"              	ld	hl,datinl
  0655'   7E                    	ld	a,(hl)
  0656'   36 00                 	ld	(hl),0
  0658'   3D                    	dec	a		;data declare ?
  0659'   2A 0084"              	ld	hl,(skpadr)
  065C'   CC 19B7'              	call	z,ptcha		;put chain address
  065F'   C3 1B0F'              	jp	gtoken
                                ;
                                ;	search symbol & table type check
                                ;
  0662'                         symchk::
  0662'   21 0016"              	ld	hl,idetyp
  0665'   CD 0000*              	call	seasym		;search symbol table
  0668'   B7                    	or	a		;found ?
  0669'   20 13                 	jr	nz,symchk2
  066B'   3A 0037"              	ld	a,(localf)
  066E'   B7                    	or	a
  066F'   20 05                 	jr	nz,symchk1
  0671'   CD 1F1A'              	call	ilenam
  0674'   18 08                 	jr	symchk2
  0676'                         symchk1:
  0676'   3A 0016"              	ld	a,(idetyp)
  0679'   CB 67                 	bit	4,a
  067B'   C4 1F1A'              	call	nz,ilenam
  067E'                         symchk2:
  067E'   3A 0037"              	ld	a,(localf)
  0681'   B7                    	or	a
  0682'   C8                    	ret	z
  0683'   3E 10                 	ld	a,10h
  0685'   C9                    	ret
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-16
Rev 1.01  08/30/1984

                                ;
                                ;	** statement
                                ;
  0686'                         statem::
  0686'   3A 0036"              	ld	a,(tokcod)
  0689'   3D                    	dec	a		;identifier ?
  068A'   20 41                 	jr	nz,statem2
  068C'   2A 0000"              	ld	hl,(cptr)
  068F'   7E                    	ld	a,(hl)
  0690'   FE 3A                 	cp	':'		;label ?
  0692'   20 39                 	jr	nz,statem2
  0694'   23                    	inc	hl
  0695'   7E                    	ld	a,(hl)
  0696'   FE 3D                 	cp	'='
  0698'   28 33                 	jr	z,statem2
  069A'   22 0000"              	ld	(cptr),hl
  069D'   21 0016"              	ld	hl,idetyp
  06A0'   CD 0000*              	call	seasym		;search symbol table
  06A3'   B7                    	or	a		;found ?
  06A4'   20 16                 	jr	nz,statem1
  06A6'   3A 0016"              	ld	a,(idetyp)
  06A9'   CB 67                 	bit	4,a		;global ?
  06AB'   28 0F                 	jr	z,statem1
  06AD'   FE 98                 	cp	98h		;undefined label ?
  06AF'   28 05                 	jr	z,statem0
  06B1'   CD 1F2C'              	call	ilelab
  06B4'   18 06                 	jr	statem1
  06B6'                         statem0:
  06B6'   2A 0023"              	ld	hl,(adrs)
  06B9'   CD 19B7'              	call	ptcha		;put chain address
  06BC'                         statem1:
  06BC'   2A 000C"              	ld	hl,(cloc)
  06BF'   22 0023"              	ld	(adrs),hl
  06C2'   21 0016"              	ld	hl,idetyp
  06C5'   36 18                 	ld	(hl),18h
  06C7'   CD 0000*              	call	regsym		;symbol table register
  06CA'   CD 1B0F'              	call	gtoken
  06CD'                         statem2:
  06CD'   CD 1831'              	call	propt		;preset operand table pointer
  06D0'   3A 0036"              	ld	a,(tokcod)
  06D3'   21 06EE'              	ld	hl,stmcod
  06D6'   01 000D               	ld	bc,stmcode-stmcod
  06D9'   ED B1                 	cpir			;search
  06DB'   C2 0B71'              	jp	nz,idxopr
  06DE'   3E 0C                 	ld	a,stmcode-stmcod-1
  06E0'   91                    	sub	c
  06E1'   87                    	add	a,a
  06E2'   4F                    	ld	c,a
  06E3'   21 06FB'              	ld	hl,stmadr
  06E6'   09                    	add	hl,bc
  06E7'   5E                    	ld	e,(hl)
  06E8'   23                    	inc	hl
  06E9'   56                    	ld	d,(hl)
  06EA'   D5                    	push	de
  06EB'   C3 1B0F'              	jp	gtoken
  06EE'   3B 25 7B              stmcod:	defb	';%{'
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-17
Rev 1.01  08/30/1984

  06F1'   90 96 98 9B           	defb	90h,96h,98h,9bh	;'inline','while','for','loop'
  06F5'   93 9E 9D 9C           	defb	93h,9eh,9dh,9ch	;'if','exit','goto','go'
  06F9'   9F A0                 	defb	9fh,0a0h	;'return','stop'
  06FB'                         stmcode	equ	$
                                ;
  06FB'   0787' 0715'           stmadr:	defw	dumstm,iclstm,comstm,inlstm
  06FF'   075C' 05A5'           
  0703'   0796' 07CC'           	defw	whistm,forstm,lopstm,ifstm
  0707'   0902' 09F7'           
  070B'   0A7B' 0A9B'           	defw	extstm,gotstm,gostm,retstm
  070F'   0A93' 0AF1'           
  0713'   0B16'                 	defw	stpstm
                                ;
                                ; %include statement
                                ;
                                ;	%include d:filename.typ;
  0715'                         iclstm::
  0715'   FE 81                 	cp	81h		;include ?
  0717'   20 06                 	jr	nz,brkstm
  0719'   CD 0000*              	call	inclu		;include file open
  071C'   C3 1B0F'              	jp	gtoken
                                ;
                                ; %break statement
                                ;
                                ;	%break;
  071F'                         brkstm::
  071F'   FE 8B                 	cp	8bh		;break ?
  0721'   20 15                 	jr	nz,tronst
  0723'   CD 1B0F'              	call	gtoken
  0726'   FE 3B                 	cp	';'
  0728'   C2 200E'              	jp	nz,synerr
  072B'   3A 0005"              	ld	a,(stmflg)
  072E'   B7                    	or	a		;statement compile ?
  072F'   CA 200E'              	jp	z,synerr
  0732'   CD 0000*              	call	pbreak
  0735'   C3 1B0F'              	jp	gtoken
                                ;
                                ; %tron statement
                                ;
                                ;	%tron;
  0738'                         tronst::
  0738'   D6 85                 	sub	85h		;tron ?
  073A'   20 0E                 	jr	nz,trofst
  073C'   CD 1B0F'              	call	gtoken
  073F'   FE 3B                 	cp	';'
  0741'   C2 200E'              	jp	nz,synerr
  0744'   CD 0000*              	call	tron		;trace on
  0747'   C3 1B0F'              	jp	gtoken
                                ;
                                ; %troff statement
                                ;
                                ;	%troff;
  074A'                         trofst::
  074A'   3D                    	dec	a		;troff ?
  074B'   C2 200E'              	jp	nz,synerr
  074E'   CD 1B0F'              	call	gtoken
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-18
Rev 1.01  08/30/1984

  0751'   FE 3B                 	cp	';'
  0753'   C2 200E'              	jp	nz,synerr
  0756'   CD 0000*              	call	troff		;trace off
  0759'   C3 1B0F'              	jp	gtoken
                                ;
                                ; conpound. until statement
                                ;
                                ;	{  statement ...  }
  075C'                         comstm::
  075C'   CD 0B45'              	call	pshlea
  075F'   CD 078B'              	call	compou1
                                ;
                                ;	{  statement ...  } until exp ;
  0762'   CD 1B0F'              	call	gtoken
  0765'   FE 97                 	cp	97h		;'until' ?
  0767'   20 1B                 	jr	nz,comstm1
  0769'   CD 1831'              	call	propt
  076C'   CD 1B0F'              	call	gtoken
  076F'   CD 0DAF'              	call	expres		;expression
  0772'   3E B7                 	ld	a,0b7h		;"  OR	A  "
  0774'   CD 1953'              	call	ptcod1
  0777'   2A 007A"              	ld	hl,(lopadr)
  077A'   3E 28                 	ld	a,28h		;"  JR	Z,LOPADR  " or
  077C'   CD 0B2A'              	call	ptjr
  077F'   3E CA                 	ld	a,0cah		;"  JP	Z,LOPADR  "
  0781'   DC 196E'              	call	c,ptcod3
  0784'                         comstm1:
  0784'   CD 0B5D'              	call	poplea
  0787'                         dumstm:
  0787'   C9                    	ret
                                ;
  0788'                         compou::
  0788'   CD 1B0F'              	call	gtoken
  078B'                         compou1:
  078B'   CD 0686'              	call	statem		;statement
  078E'   3A 0036"              	ld	a,(tokcod)
  0791'   FE 7D                 	cp	'}'
  0793'   20 F6                 	jr	nz,compou1
  0795'   C9                    	ret
                                ;
                                ; while statement
                                ;
                                ;	while  exp  { statement ... }
  0796'                         whistm::
  0796'   CD 0B45'              	call	pshlea
  0799'   CD 0DBA'              	call	expre		;expression
  079C'   FE 7B                 	cp	'{'
  079E'   C2 200E'              	jp	nz,synerr
  07A1'   3E B7                 	ld	a,0b7h		;"  OR	A  "
  07A3'   CD 1953'              	call	ptcod1
  07A6'   3E CA                 	ld	a,0cah		;"  JP	Z,0  "
  07A8'   21 0000               	ld	hl,0
  07AB'   CD 196E'              	call	ptcod3
  07AE'   2A 000C"              	ld	hl,(cloc)
  07B1'   2B                    	dec	hl
  07B2'   2B                    	dec	hl
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-19
Rev 1.01  08/30/1984

  07B3'   22 007C"              	ld	(extadr),hl
  07B6'   CD 0788'              	call	compou		;{  statement  ... }
  07B9'   2A 007A"              	ld	hl,(lopadr)
  07BC'   3E 18                 	ld	a,18h		;"  JR	LOPADR  " or
  07BE'   CD 0B2A'              	call	ptjr
  07C1'   3E C3                 	ld	a,0c3h
  07C3'   DC 196E'              	call	c,ptcod3	;"  JP  LOPADR  "
  07C6'   CD 0B5D'              	call	poplea
  07C9'   C3 1B0F'              	jp	gtoken
                                ;
                                ; for statement
                                ;
                                ;	for  var := exp_1  to  exp_2  by  exp_3  {  statement  ... }
  07CC'                         forstm::
  07CC'   3D                    	dec	a		;identifier ?
  07CD'   C2 200E'              	jp	nz,synerr
  07D0'   21 0016"              	ld	hl,idetyp
  07D3'   CD 0000*              	call	seasym		;search symbol table
  07D6'   B7                    	or	a		;found ?
  07D7'   C4 1E74'              	call	nz,misvar
  07DA'   21 0016"              	ld	hl,idetyp
  07DD'   7E                    	ld	a,(hl)
  07DE'   E6 2F                 	and	2fh
  07E0'   FE 02                 	cp	2		;variable name ?
  07E2'   C2 200E'              	jp	nz,synerr
  07E5'   01 000F               	ld	bc,adrs-idetyp+2
  07E8'   CD 1AF3'              	call	blkpsh		;block push
  07EB'   21 0016"              	ld	hl,idetyp
  07EE'   CB EE                 	set	5,(hl)
  07F0'   CD 0000*              	call	regsym		;symbol table register
  07F3'   01 0006               	ld	bc,6
  07F6'   21 007E"              	ld	hl,convar
  07F9'   CD 1AF3'              	call	blkpsh		;push convar,terpar,incper
  07FC'   2A 0023"              	ld	hl,(adrs)
  07FF'   22 007E"              	ld	(convar),hl
  0802'   CD 1B0F'              	call	gtoken
  0805'   FE F0                 	cp	0f0h		;':=' ?
  0807'   C2 200E'              	jp	nz,synerr
  080A'   CD 1B0F'              	call	gtoken
  080D'   CD 0DBA'              	call	expre		;expression_1
  0810'   FE 99                 	cp	99h		;'to' ?
  0812'   C2 200E'              	jp	nz,synerr
  0815'   3E 32                 	ld	a,32h		;"  LD	(CONVER),A  "
  0817'   2A 007E"              	ld	hl,(convar)
  081A'   CD 196E'              	call	ptcod3
  081D'   CD 1B0F'              	call	gtoken
  0820'   CD 0DBA'              	call	expre		;expression_2
  0823'   2A 0010"              	ld	hl,(wloc)
  0826'   E5                    	push	hl
  0827'   22 0080"              	ld	(terpar),hl
  082A'   CD 08DD'              	call	forstm8
  082D'   3E 32                 	ld	a,32h		;"  LS  (TERPAR),A  "
  082F'   2B                    	dec	hl
  0830'   CD 196E'              	call	ptcod3
  0833'   21 0000               	ld	hl,0
  0836'   22 0082"              	ld	(incpar),hl
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-20
Rev 1.01  08/30/1984

  0839'   3A 0036"              	ld	a,(tokcod)
  083C'   FE 7B                 	cp	'{'
  083E'   28 1F                 	jr	z,forstm1
  0840'   FE 9A                 	cp	9ah		;'by' ?
  0842'   C2 200E'              	jp	nz,synerr
  0845'   CD 1B0F'              	call	gtoken
  0848'   CD 0DBA'              	call	expre		;expression_3
  084B'   FE 7B                 	cp	'{'
  084D'   C2 200E'              	jp	nz,synerr
  0850'   2A 0010"              	ld	hl,(wloc)
  0853'   22 0082"              	ld	(incpar),hl
  0856'   CD 08DD'              	call	forstm8
  0859'   3E 32                 	ld	a,32h		;"  LD  (INCPAR),A  "
  085B'   2B                    	dec	hl
  085C'   CD 196E'              	call	ptcod3
  085F'                         forstm1:
  085F'   CD 0B45'              	call	pshlea
  0862'   2A 0080"              	ld	hl,(terpar)
  0865'   CD 183D'              	call	stoptb		;opr1 = terminal parameter address
  0868'   2A 007E"              	ld	hl,(convar)
  086B'   CD 183D'              	call	stoptb		;opr2 = constant variable address
  086E'   21 08EE'              	ld	hl,forobj1
  0871'   CD 189A'              	call	codgen0		;code generate
  0874'   2A 000C"              	ld	hl,(cloc)
  0877'   2B                    	dec	hl
  0878'   2B                    	dec	hl
  0879'   22 007C"              	ld	(extadr),hl
  087C'   CD 0788'              	call	compou		; {  statement ... }
  087F'   2A 0082"              	ld	hl,(incpar)
  0882'   7C                    	ld	a,h
  0883'   B5                    	or	l
  0884'   20 19                 	jr	nz,forstm3
  0886'   2A 007E"              	ld	hl,(convar)
  0889'   3E 21                 	ld	a,21h		;"  LD	HL,CONVAR  "
  088B'   CD 196E'              	call	ptcod3
  088E'   3E 34                 	ld	a,34h		;"  INC	(HL)  "
  0890'   CD 1953'              	call	ptcod1
  0893'   2A 007A"              	ld	hl,(lopadr)
  0896'   3E 20                 	ld	a,20h		;"  JR	NZ,LOPADR  " or
  0898'   CD 0B2A'              	call	ptjr
  089B'   3E C2                 	ld	a,0c2h		;"  JP	NZ,LOPADR  "
  089D'   18 19                 	jr	forstm4
  089F'                         forstm3:
  089F'   CD 183D'              	call	stoptb		;opr1 = incremental parameter address
  08A2'   2A 007E"              	ld	hl,(convar)
  08A5'   CD 183D'              	call	stoptb		;opr2 = control variable address
  08A8'   21 08F9'              	ld	hl,forobj2
  08AB'   CD 189A'              	call	codgen0		;code generate
  08AE'   2A 007A"              	ld	hl,(lopadr)
  08B1'   3E 30                 	ld	a,30h		;"  JR	NC,LOPADR  " or
  08B3'   CD 0B2A'              	call	ptjr
  08B6'   3E D2                 	ld	a,0d2h		;"  JP	NC,LOPADR  "
  08B8'                         forstm4:
  08B8'   DC 196E'              	call	c,ptcod3
  08BB'   CD 0B5D'              	call	poplea
  08BE'   E1                    	pop	hl
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-21
Rev 1.01  08/30/1984

  08BF'   22 0010"              	ld	(wloc),hl
  08C2'   01 0006               	ld	bc,6
  08C5'   21 007E"              	ld	hl,convar
  08C8'   CD 1B03'              	call	blkpop		;pop incpar,terpar,convar
  08CB'   01 000F               	ld	bc,adrs-idetyp+2
  08CE'   21 0016"              	ld	hl,idetyp
  08D1'   CD 1B03'              	call	blkpop		;block pop
  08D4'   21 0016"              	ld	hl,idetyp
  08D7'   CD 0000*              	call	regsym		;symbol table register
  08DA'   C3 1B0F'              	jp	gtoken
                                ;
  08DD'                         forstm8:
  08DD'   23                    	inc	hl
  08DE'   22 0010"              	ld	(wloc),hl
  08E1'   EB                    	ex	de,hl
  08E2'   2A 000E"              	ld	hl,(dloc)
  08E5'   B7                    	or	a
  08E6'   ED 52                 	sbc	hl,de		; dloc >= wloc ?
  08E8'   EB                    	ex	de,hl
  08E9'   D0                    	ret	nc
  08EA'   22 000E"              	ld	(dloc),hl
  08ED'   C9                    	ret
                                ;
  08EE'   0A                    forobj1:  defb	10
  08EF'   3A B9B9               	ld	a,(opr1w)
  08F2'   21 BBBB               	ld	hl,opr2w
  08F5'   96                    	sub	(hl)
  08F6'   DA 0000               	jp	c,0
  08F9'   08                    forobj2:  defb	8
  08FA'   3A B9B9               	ld	a,(opr1w)
  08FD'   21 BBBB               	ld	hl,opr2w
  0900'   86                    	add	a,(hl)
  0901'   77                    	ld	(hl),a
                                ;
                                ; loop statement
                                ;
                                ;	   loop  var,  exp  {  statement ... }
  0902'                         lopstm::
  0902'   FE 23                 	cp	'#'
  0904'   CA 098C'              	jp	z,lopstb
  0907'   3D                    	dec	a
  0908'   C2 200E'              	jp	nz,synerr
  090B'   21 0016"              	ld	hl,idetyp
  090E'   CD 0000*              	call	seasym		;search symbol table
  0911'   B7                    	or	a		;found ?
  0912'   C4 1E74'              	call	nz,misvar
  0915'   21 0016"              	ld	hl,idetyp
  0918'   7E                    	ld	a,(hl)
  0919'   E6 2F                 	and	2fh
  091B'   FE 02                 	cp	2		;variable name ?
  091D'   C2 200E'              	jp	nz,synerr
  0920'   01 000F               	ld	bc,adrs-idetyp+2
  0923'   CD 1AF3'              	call	blkpsh		;block push
  0926'   21 0016"              	ld	hl,idetyp
  0929'   CB EE                 	set	5,(hl)
  092B'   CD 0000*              	call	regsym		;symbol table register
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-22
Rev 1.01  08/30/1984

  092E'   2A 007E"              	ld	hl,(convar)
  0931'   E5                    	push	hl
  0932'   2A 0023"              	ld	hl,(adrs)
  0935'   22 007E"              	ld	(convar),hl
  0938'   CD 1B0F'              	call	gtoken
  093B'   FE 2C                 	cp	','
  093D'   C2 200E'              	jp	nz,synerr
  0940'   CD 1B0F'              	call	gtoken
  0943'   CD 0DBA'              	call	expre		;expression
  0946'   FE 7B                 	cp	'{'
  0948'   C2 200E'              	jp	nz,synerr
  094B'   3E 32                 	ld	a,32h		;"  LD  (CONVAR),A  "
  094D'   2A 007E"              	ld	hl,(convar)
  0950'   CD 196E'              	call	ptcod3
  0953'   CD 0B45'              	call	pshlea
  0956'   CD 0788'              	call	compou		; { statement ...  }
  0959'   3E 21                 	ld	a,21h		;"  LD	HL,CONVAR  "
  095B'   2A 007E"              	ld	hl,(convar)
  095E'   CD 196E'              	call	ptcod3
  0961'   3E 35                 	ld	a,35h		;"  DEC	(HL)  "
  0963'   CD 1953'              	call	ptcod1
  0966'   2A 007A"              	ld	hl,(lopadr)
  0969'   3E 20                 	ld	a,20h		;"  JR	NZ,LOPADR  " or
  096B'   CD 0B2A'              	call	ptjr
  096E'   3E C2                 	ld	a,0c2h
  0970'   DC 196E'              	call	c,ptcod3	;"  JP  NZ,LOPADR  "
  0973'   CD 0B5D'              	call	poplea
  0976'   E1                    	pop	hl
  0977'   22 007E"              	ld	(convar),hl
  097A'   01 000F               	ld	bc,adrs-idetyp+2
  097D'   21 0016"              	ld	hl,idetyp
  0980'   CD 1B03'              	call	blkpop		;block pop
  0983'   21 0016"              	ld	hl,idetyp
  0986'   CD 0000*              	call	regsym		;symbol table register
  0989'   C3 1B0F'              	jp	gtoken
                                ;
                                ;	   loop  #,  exp  {  statement ... }
                                ;
  098C'                         lopstb:
  098C'   21 0039"              	ld	hl,loopb
  098F'   7E                    	ld	a,(hl)
  0990'   B7                    	or	a
  0991'   C2 200E'              	jp	nz,synerr
  0994'   2F                    	cpl
  0995'   77                    	ld	(hl),a
  0996'   CD 1B0F'              	call	gtoken
  0999'   FE 2C                 	cp	','
  099B'   C2 200E'              	jp	nz,synerr
  099E'   CD 1B0F'              	call	gtoken
  09A1'   CD 0DF5'              	call	logexp		;expression
  09A4'   47                    	ld	b,a
  09A5'   3A 003B"              	ld	a,(optble)
  09A8'   3D                    	dec	a
  09A9'   C2 203D'              	jp	nz,experr
  09AC'   78                    	ld	a,b
  09AD'   FE 7B                 	cp	'{'
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-23
Rev 1.01  08/30/1984

  09AF'   C2 200E'              	jp	nz,synerr
  09B2'   FD 7E FD              	ld	a,(iy-3)
  09B5'   B7                    	or	a
  09B6'   28 11                 	jr	z,lopstb2
  09B8'   21 0DEC'              	ld	hl,ldexa
  09BB'   3D                    	dec	a
  09BC'   28 08                 	jr	z,lopstb1
  09BE'   21 09F4'              	ld	hl,ldbim
  09C1'   CD 188F'              	call	codgen		;code generate
  09C4'   18 08                 	jr	lopstb3
  09C6'                         lopstb1:
  09C6'   CD 188F'              	call	codgen		;code generate
  09C9'                         lopstb2:
  09C9'   3E 47                 	ld	a,47h		;"  LD	B,A  "
  09CB'   CD 1953'              	call	ptcod1
  09CE'                         lopstb3:
  09CE'   CD 0B45'              	call	pshlea
  09D1'   CD 0788'              	call	compou		; {  statement ... }
  09D4'   2A 007A"              	ld	hl,(lopadr)
  09D7'   3E 10                 	ld	a,10h		;"  DJNZ  LOPADR  " or
  09D9'   CD 0B2A'              	call	ptjr
  09DC'   30 0C                 	jr	nc,lopstb4
  09DE'   E5                    	push	hl
  09DF'   3E 05                 	ld	a,05h		;"  DEC	B  "
  09E1'   CD 1953'              	call	ptcod1
  09E4'   E1                    	pop	hl
  09E5'   3E C2                 	ld	a,0c2h		;"  JP	NZ,LOPADR "
  09E7'   CD 196E'              	call	ptcod3
  09EA'                         lopstb4:
  09EA'   AF                    	xor	a
  09EB'   32 0039"              	ld	(loopb),a
  09EE'   CD 0B5D'              	call	poplea
  09F1'   C3 1B0F'              	jp	gtoken
                                ;
  09F4'   02                    ldbim:	defb	2
  09F5'   06 B8                 	ld	b,opr1b
                                ;
                                ;  if statement
                                ;
                                ;	   if  exp  then  statement_1 else statement
  09F7'                         ifstm::
  09F7'   2A 0086"              	ld	hl,(nxtadr)
  09FA'   E5                    	push	hl
  09FB'   2A 0084"              	ld	hl,(skpadr)
  09FE'   E5                    	push	hl
  09FF'   21 0000               	ld	hl,0
  0A02'   22 0086"              	ld	(nxtadr),hl
  0A05'   22 0084"              	ld	(skpadr),hl
  0A08'                         ifstm1:
  0A08'   CD 0DBA'              	call	expre		;expression
  0A0B'   FE 94                 	cp	94h		;'then' ?
  0A0D'   C2 200E'              	jp	nz,synerr
  0A10'   3E B7                 	ld	a,0b7h		;"  OR	A  "
  0A12'   CD 1953'              	call	ptcod1
  0A15'   3E CA                 	ld	a,0cah		;"  JP	Z,0  "
  0A17'   21 0000               	ld	hl,0
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-24
Rev 1.01  08/30/1984

  0A1A'   CD 196E'              	call	ptcod3
  0A1D'   2A 000C"              	ld	hl,(cloc)
  0A20'   2B                    	dec	hl
  0A21'   2B                    	dec	hl
  0A22'   22 0084"              	ld	(skpadr),hl
  0A25'   CD 1B0F'              	call	gtoken
  0A28'   CD 0686'              	call	statem		;statement_1
  0A2B'   3A 0036"              	ld	a,(tokcod)
  0A2E'   FE BD                 	cp	0bdh		;'elseif' ?
  0A30'   28 2A                 	jr	z,ifstm4
  0A32'   FE 95                 	cp	095h		;'else' ?
  0A34'   28 08                 	jr	z,ifstm2
  0A36'   2A 0084"              	ld	hl,(skpadr)
  0A39'   CD 19B7'              	call	ptcha		;put chain address
  0A3C'   18 0D                 	jr	ifstm3
  0A3E'                         ifstm2:
  0A3E'   CD 1B0F'              	call	gtoken
  0A41'   FE 93                 	cp	93h		;'if' ?
  0A43'   28 17                 	jr	z,ifstm4
  0A45'   CD 0A64'              	call	ifstm5
  0A48'   CD 0686'              	call	statem		;statement_2
  0A4B'                         ifstm3:
  0A4B'   2A 0086"              	ld 	hl,(nxtadr)
  0A4E'   7C                    	ld	a,h
  0A4F'   B5                    	or	l
  0A50'   C4 19B7'              	call	nz,ptcha	;put chain address
  0A53'   E1                    	pop	hl
  0A54'   22 0084"              	ld	(skpadr),hl
  0A57'   E1                    	pop	hl
  0A58'   22 0086"              	ld	(nxtadr),hl
  0A5B'   C9                    	ret
  0A5C'                         ifstm4:
  0A5C'   CD 0A64'              	call	ifstm5
  0A5F'   CD 1B0F'              	call	gtoken
  0A62'   18 A4                 	jr	ifstm1
                                ;
  0A64'                         ifstm5:
  0A64'   2A 0086"              	ld	hl,(nxtadr)
  0A67'   3E C3                 	ld	a,0c3h		;"  JP	NXTADR  "
  0A69'   CD 196E'              	call	ptcod3
  0A6C'   2A 0084"              	ld	hl,(skpadr)
  0A6F'   CD 19B7'              	call	ptcha		;put chain address
  0A72'   2A 000C"              	ld	hl,(cloc)
  0A75'   2B                    	dec	hl
  0A76'   2B                    	dec	hl
  0A77'   22 0086"              	ld	(nxtadr),hl
  0A7A'   C9                    	ret
                                ;
                                ; exit statement
                                ;
                                ;	   exit :
  0A7B'                         extstm::
  0A7B'   FE 3B                 	cp	';'
  0A7D'   C2 200E'              	jp	nz,synerr
  0A80'   3E C3                 	ld	a,0c3h		;"  JP	EXTADR  "
  0A82'   2A 007C"              	ld	hl,(extadr)
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-25
Rev 1.01  08/30/1984

  0A85'   CD 196E'              	call	ptcod3
  0A88'   2A 000C"              	ld	hl,(cloc)
  0A8B'   2B                    	dec	hl
  0A8C'   2B                    	dec	hl
  0A8D'   22 007C"              	ld	(extadr),hl
  0A90'   C3 1B0F'              	jp	gtoken
                                ;
                                ; goto statement
                                ;
                                ;	  goto label;	go to label;
  0A93'                         gostm::
  0A93'   FE 99                 	cp	99h		;'to' ?
  0A95'   C2 200E'              	jp	nz,synerr
  0A98'   CD 1B0F'              	call	gtoken
  0A9B'                         gotstm::
  0A9B'   3D                    	dec	a
  0A9C'   C2 200E'              	jp	nz,synerr
  0A9F'   21 0016"              	ld	hl,idetyp
  0AA2'   CD 0000*              	call	seasym		;search symbol table
  0AA5'   B7                    	or	a		;found ?
  0AA6'   28 0D                 	jr	z,gotstm1
  0AA8'   3E 98                 	ld	a,98h
  0AAA'   32 0016"              	ld	(idetyp),a
  0AAD'   21 0000               	ld	hl,0
  0AB0'   22 0023"              	ld	(adrs),hl
  0AB3'   18 1E                 	jr	gotstm2
  0AB5'                         gotstm1:
  0AB5'   3A 0016"              	ld	a,(idetyp)
  0AB8'   47                    	ld	b,a
  0AB9'   E6 0F                 	and	0fh
  0ABB'   FE 08                 	cp	8		;label ?
  0ABD'   C2 200E'              	jp	nz,synerr
  0AC0'   2A 0023"              	ld	hl,(adrs)
  0AC3'   78                    	ld	a,b
  0AC4'   87                    	add	a,a		;defined label ?
  0AC5'   38 0C                 	jr	c,gotstm2
  0AC7'   3E 18                 	ld	a,18h		;"  JR	LABEL   "  or
  0AC9'   CD 0B2A'              	call	ptjr
  0ACC'   3E C3                 	ld	a,0c3h		;"  LP  LABEL   "
  0ACE'   DC 196E'              	call	c,ptcod3
  0AD1'   18 13                 	jr	gotstm3
  0AD3'                         gotstm2:
  0AD3'   3E C3                 	ld	a,0c3h		;"  JP	LABEL  "
  0AD5'   CD 196E'              	call	ptcod3
  0AD8'   2A 000C"              	ld	hl,(cloc)
  0ADB'   2B                    	dec	hl
  0ADC'   2B                    	dec	hl
  0ADD'   22 0023"              	ld	(adrs),hl
  0AE0'   21 0016"              	ld	hl,idetyp
  0AE3'   CD 0000*              	call	regsym		;symbol table register
  0AE6'                         gotstm3:
  0AE6'   CD 1B0F'              	call	gtoken
  0AE9'   FE 3B                 	cp	';'
  0AEB'   C2 200E'              	jp	nz,synerr
  0AEE'   C3 1B0F'              	jp	gtoken
                                ;
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-26
Rev 1.01  08/30/1984

                                ; return statement
                                ;
                                ;	   return ;
  0AF1'                         retstm::
  0AF1'   FE 3B                 	cp	';'
  0AF3'   C2 200E'              	jp	nz,synerr
  0AF6'   3A 008C"              	ld	a,(idxpsf)
  0AF9'   B7                    	or	a		;index push ?
  0AFA'   28 12                 	jr	z,retstm1
  0AFC'   3E C3                 	ld	a,0c3h		;"  JP	RETJAD  "
  0AFE'   2A 008D"              	ld	hl,(retjad)
  0B01'   CD 196E'              	call	ptcod3
  0B04'   2A 000C"              	ld	hl,(cloc)
  0B07'   2B                    	dec	hl
  0B08'   2B                    	dec	hl
  0B09'   22 008D"              	ld	(retjad),hl
  0B0C'   18 05                 	jr	retstm2
  0B0E'                         retstm1:
  0B0E'   3E C9                 	ld	a,0c9h		;"  RET  "
  0B10'   CD 1953'              	call	ptcod1
  0B13'                         retstm2:
  0B13'   C3 1B0F'              	jp	gtoken
                                ;
                                ; stop statement
                                ;
                                ;	   stop ;
  0B16'                         stpstm::
  0B16'   FE 3B                 	cp	';'
  0B18'   C2 200E'              	jp	nz,synerr
  0B1B'   3E C3                 	ld	a,0c3h		;"  JP	@STOP  "
  0B1D'   2A 0006"              	ld	hl,(codorg)
  0B20'   11 0000*              	ld	de,@stop-@start
  0B23'   19                    	add	hl,de
  0B24'   CD 196E'              	call	ptcod3
  0B27'   C3 1B0F'              	jp	gtoken
                                ;
                                ;	**  put relative jump  **
                                ;
  0B2A'                         ptjr::	 ;	a : op code
                                	 ;	hl : jump address
  0B2A'   E5                    	push	hl
  0B2B'   F5                    	push	af
  0B2C'   ED 5B 000C"           	ld	de,(cloc)
  0B30'   13                    	inc	de
  0B31'   13                    	inc	de
  0B32'   B7                    	or	a
  0B33'   ED 52                 	sbc	hl,de		; hl := hl - $ + 2
  0B35'   D1                    	pop	de
  0B36'   5D                    	ld	e,l
  0B37'   7D                    	ld	a,l
  0B38'   87                    	add	a,a
  0B39'   9F                    	sbc	a,a
  0B3A'   BC                    	cp	h
  0B3B'   E1                    	pop	hl
  0B3C'   20 05                 	jr	nz,ptjr1
  0B3E'   CD 1964'              	call	ptcod2
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-27
Rev 1.01  08/30/1984

  0B41'   B7                    	or	a		; cy=0 : OK
  0B42'   C9                    	ret
  0B43'                         ptjr1:
  0B43'   37                    	scf			; cy=1 : NG
  0B44'   C9                    	ret
                                ;
                                ;	**  push loop adddress, exit jump address & preset  **
                                ;
  0B45'                         pshlea::
  0B45'   DD E1                 	pop	ix
  0B47'   2A 007A"              	ld	hl,(lopadr)
  0B4A'   E5                    	push	hl
  0B4B'   2A 007C"              	ld	hl,(extadr)
  0B4E'   E5                    	push	hl
  0B4F'   21 0000               	ld	hl,0
  0B52'   22 007C"              	ld	(extadr),hl
  0B55'   2A 000C"              	ld	hl,(cloc)
  0B58'   22 007A"              	ld	(lopadr),hl
  0B5B'   DD E9                 	jp	(ix)
                                ;
                                ;	**  pop loop address, exit jump address  **
                                ;
  0B5D'                         poplea::
  0B5D'   DD E1                 	pop	ix
  0B5F'   2A 007C"              	ld	hl,(extadr)
  0B62'   7C                    	ld	a,h
  0B63'   B5                    	or	l
  0B64'   C4 19B7'              	call	nz,ptcha	;put chain address
  0B67'   E1                    	pop	hl
  0B68'   22 007C"              	ld	(extadr),hl
  0B6B'   E1                    	pop	hl
  0B6C'   22 007A"              	ld	(lopadr),hl
  0B6F'   DD E9                 	jp	(ix)
                                ;
                                ;	**  index operation  **
                                ;
  0B71'                         idxopr::
  0B71'   3A 0036"              	ld	a,(tokcod)
  0B74'   D6 A1                 	sub	0a1h	   ;'set' or 'idx' or 'stx' or 'inx' or 'dex' ?
  0B76'   DA 0DAF'              	jp	c,expres
  0B79'   FE 05                 	cp	5
  0B7B'   D2 0DAF'              	jp	nc,expres
  0B7E'   87                    	add	a,a
  0B7F'   5F                    	ld	e,a
  0B80'   16 00                 	ld	d,0
  0B82'   21 0B8D'              	ld	hl,idopad
  0B85'   19                    	add	hl,de
  0B86'   5E                    	ld	e,(hl)
  0B87'   23                    	inc	hl
  0B88'   56                    	ld	d,(hl)
  0B89'   D5                    	push	de
  0B8A'   C3 1B0F'              	jp	gtoken
                                ;
  0B8D'   0B97' 0C44'           idopad:	defw	idxset,ldx,stx,inx,dex
  0B91'   0CED' 0D9D'           
  0B95'   0DA0'                 
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-28
Rev 1.01  08/30/1984

                                ;
                                ;	   set	index := const +- expression;
                                ;	   set	index := index +- expression;
  0B97'                         idxset::
  0B97'   D6 BF                 	sub	0bfh		;'ix' ?
  0B99'   28 05                 	jr	z,idxset1
  0B9B'   FE 01                 	cp	1		;'iy' ?
  0B9D'   C2 2022'              	jp	nz,idxerr
  0BA0'                         idxset1:
  0BA0'   F5                    	push	af
  0BA1'   CD 1B0F'              	call	gtoken
  0BA4'   FE F0                 	cp	0f0h		;':=' ?
  0BA6'   C2 2022'              	jp	nz,idxerr
  0BA9'   CD 1B0F'              	call	gtoken
  0BAC'   D6 BF                 	sub	0bfh		;'ix' ?
  0BAE'   28 0B                 	jr	z,idxset2
  0BB0'   FE 01                 	cp	1
  0BB2'   28 07                 	jr	z,idxset2
  0BB4'   CD 1A01'              	call	wodcon
  0BB7'   3E 02                 	ld	a,2
  0BB9'   18 05                 	jr	idxset3
  0BBB'                         idxset2:
  0BBB'   F5                    	push	af
  0BBC'   CD 1B0F'              	call	gtoken
  0BBF'   F1                    	pop	af
  0BC0'                         idxset3:
  0BC0'   D1                    	pop	de
  0BC1'   5F                    	ld	e,a
  0BC2'   3A 0036"              	ld	a,(tokcod)
  0BC5'   FE 3B                 	cp	';'
  0BC7'   28 43                 	jr	z,idxset7
  0BC9'   FE 2B                 	cp	'+'
  0BCB'   28 05                 	jr	z,idxset4
  0BCD'   D6 2D                 	sub	'-'
  0BCF'   C2 2022'              	jp	nz,idxerr
  0BD2'                         idxset4:
  0BD2'   F5                    	push	af
  0BD3'   D5                    	push	de
  0BD4'   E5                    	push	hl
  0BD5'   CD 1B0F'              	call	gtoken
  0BD8'   CD 0DAF'              	call	expres		;expression
  0BDB'   E1                    	pop	hl
  0BDC'   D1                    	pop	de
  0BDD'   D5                    	push	de
  0BDE'   CD 0C12'              	call	idxset10
  0BE1'   D1                    	pop	de
  0BE2'   15                    	dec	d
  0BE3'   16 DD                 	ld	d,0ddh		;index ix
  0BE5'   20 02                 	jr	nz,$+4
  0BE7'   16 FD                 	ld	d,0fdh		;index iy
  0BE9'   1E 19                 	ld	e,19h
  0BEB'   F1                    	pop	af
  0BEC'   D5                    	push	de
  0BED'   B7                    	or	a
  0BEE'   28 0A                 	jr	z,idxset5
  0BF0'   3E 5F                 	ld	a,5fh		;"  LD	E,A  "
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-29
Rev 1.01  08/30/1984

  0BF2'   21 0016               	ld	hl,16h		;"  LD	D,0  "
  0BF5'   CD 196E'              	call	ptcod3
  0BF8'   18 0E                 	jr	idxset6
  0BFA'                         idxset5:
  0BFA'   11 2F5F               	ld	de,2f5fh	;"  CPL  "
  0BFD'   CD 1964'              	call	ptcod2		;"  LD	E,A  "
  0C00'   3E 16                 	ld	a,16h		;"  LD	D,0FFH  "
  0C02'   21 13FF               	ld	hl,13ffh	;"  INC	DE  "
  0C05'   CD 196E'              	call	ptcod3
  0C08'                         idxset6:
  0C08'   D1                    	pop	de		;"  ADD	IX,DE  " or  "  ADD  IY,DE  "
  0C09'   C3 1964'              	jp	ptcod2
  0C0C'                         idxset7:
  0C0C'   CD 0C12'              	call	idxset10
  0C0F'   C3 1B0F'              	jp	gtoken
                                ;
  0C12'                         idxset10:
  0C12'   7B                    	ld	a,e
  0C13'   BA                    	cp	d
  0C14'   C8                    	ret	z
  0C15'   B7                    	or	a		;' iy := ix ' ?
  0C16'   20 0C                 	jr	nz,idxset11
  0C18'   11 DDE5               	ld	de,0dde5h	;"  PUSH  IX  "
  0C1B'   CD 1964'              	call	ptcod2
  0C1E'   11 FDE1               	ld	de,0fde1h	;"  POP  IY  "
  0C21'   C3 1964'              	jp	ptcod2
  0C24'                         idxset11:
  0C24'   3D                    	dec	a
  0C25'   20 0C                 	jr	nz,idxset12
  0C27'   11 FDE5               	ld	de,0fde5h	;"  PUSH  IY  "
  0C2A'   CD 1964'              	call	ptcod2
  0C2D'   11 DDE1               	ld	de,0dde1h	;"  POP	IX  "
  0C30'   C3 1964'              	jp	ptcod2
  0C33'                         idxset12:
  0C33'   15                    	dec	d
  0C34'   3E DD                 	ld	a,0ddh
  0C36'   20 02                 	jr	nz,$+4
  0C38'   3E FD                 	ld	a,0fdh
  0C3A'   E5                    	push	hl
  0C3B'   CD 1953'              	call	ptcod1
  0C3E'   E1                    	pop	hl
  0C3F'   3E 21                 	ld	a,21h		;"  LD	IX,nn  "  or  "  LD  IY,nn  "
  0C41'   C3 196E'              	jp	ptcod3
                                ;
                                ;	  ldx  index := var[ exp ];
  0C44'                         ldx::
  0C44'   16 DD                 	ld	d,0ddh
  0C46'   D6 BF                 	sub	0bfh		;'ix' ?
  0C48'   28 06                 	jr	z,ldx1
  0C4A'   16 FD                 	ld	d,0fdh
  0C4C'   3D                    	dec	a		;'iy' ?
  0C4D'   C2 2022'              	jp	nz,idxerr
  0C50'                         ldx1:
  0C50'   D5                    	push	de
  0C51'   CD 1B0F'              	call	gtoken
  0C54'   FE F0                 	cp	0f0h		;':=' ?
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-30
Rev 1.01  08/30/1984

  0C56'   C2 2022'              	jp	nz,idxerr
  0C59'   CD 1B0F'              	call	gtoken
  0C5C'   3D                    	dec	a
  0C5D'   C2 2022'              	jp	nz,idxerr
  0C60'   21 0016"              	ld	hl,idetyp
  0C63'   CD 0000*              	call	seasym		;search symbol table
  0C66'   B7                    	or	a		;found ?
  0C67'   C4 1E74'              	call	nz,misvar
  0C6A'   2A 0023"              	ld	hl,(adrs)
  0C6D'   3A 0016"              	ld	a,(idetyp)
  0C70'   E6 0F                 	and	0fh
  0C72'   D6 02                 	sub	2		;variable name ?
  0C74'   28 04                 	jr	z,ldx2
  0C76'   3D                    	dec	a		;data name ?
  0C77'   C2 2022'              	jp	nz,idxerr
  0C7A'                         ldx2:
  0C7A'   E5                    	push	hl
  0C7B'   CD 1B0F'              	call	gtoken
  0C7E'   FE 5B                 	cp	'['
  0C80'   20 44                 	jr	nz,ldx6
  0C82'   CD 1B0F'              	call	gtoken
  0C85'   CD 0DF5'              	call	logexp		;expression
  0C88'   3A 003B"              	ld	a,(optble)
  0C8B'   3D                    	dec	a
  0C8C'   C2 203D'              	jp	nz,experr
  0C8F'   3A 0036"              	ld	a,(tokcod)
  0C92'   FE 5D                 	cp	']'
  0C94'   C2 2022'              	jp	nz,idxerr
  0C97'   CD 1B0F'              	call	gtoken
  0C9A'   FD 7E FD              	ld	a,(iy-3)
  0C9D'   FE 02                 	cp	2		;constant ?
  0C9F'   28 1B                 	jr	z,ldx5
  0CA1'   B7                    	or	a		;expression ?
  0CA2'   28 06                 	jr	z,ldx3
  0CA4'   21 0CDD'              	ld	hl,ldxobj1
  0CA7'   CD 188F'              	call	codgen		;code generate
  0CAA'                         ldx3:
                                
  0CAA'   E1                    	pop	hl
  0CAB'   CD 183D'              	call	stoptb		;store oprand table
  0CAE'   21 0CE1'              	ld	hl,ldxobj2
  0CB1'   CD 188F'              	call	codgen
  0CB4'   D1                    	pop	de
  0CB5'   1E E1                 	ld	e,0e1h		;"  POP   IX  " or  "POP   IY "
  0CB7'   CD 1964'              	call	ptcod2
  0CBA'   18 16                 	jr	ldx7
  0CBC'                         ldx5:
  0CBC'   E1                    	pop	hl
  0CBD'   FD 7E FE              	ld	a,(iy-2)
  0CC0'   85                    	add	a,l
  0CC1'   6F                    	ld	l,a
  0CC2'   30 01                 	jr	nc,$+3
  0CC4'   24                    	inc	h		;hl := hl + opr
  0CC5'   FE                    	defb	0feh		;skip 1 byte
  0CC6'                         ldx6:
  0CC6'   E1                    	pop	hl
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-31
Rev 1.01  08/30/1984

  0CC7'   E3                    	ex	(sp),hl
  0CC8'   EB                    	ex	de,hl
  0CC9'   1E 2A                 	ld	e,2ah		;"  LD  IX,(nn)  " or "  LD  IY,(nn)  "
  0CCB'   CD 1964'              	call	ptcod2
  0CCE'   E1                    	pop	hl
  0CCF'   CD 1966'              	call	ptcodw
  0CD2'                         ldx7:
  0CD2'   3A 0036"              	ld	a,(tokcod)
  0CD5'   FE 3B                 	cp	';'
  0CD7'   CA 1B0F'              	jp	z,gtoken
  0CDA'   C3 2022'              	jp	idxerr		;error : bad index operation
                                ;
  0CDD'   03                    ldxobj1: defb	3
  0CDE'   3A B9B9               	ld	a,(opr1w)
                                ;
  0CE1'   0B                    ldxobj2: defb	11
  0CE2'   5F                    	ld	e,a
  0CE3'   16 00                 	ld	d,0
  0CE5'   21 B9B9               	ld	hl,opr1w
  0CE8'   19                    	add	hl,de
  0CE9'   5E                    	ld	e,(hl)
  0CEA'   23                    	inc	hl
  0CEB'   56                    	ld	d,(hl)
  0CEC'   D5                    	push	de
                                ;
                                ;	   stx  var[  exp  ] := index;
  0CED'                         stx::
  0CED'   3D                    	dec	a
  0CEE'   C2 2022'              	jp	nz,idxerr
  0CF1'   21 0016"              	ld	hl,idetyp
  0CF4'   CD 0000*              	call	seasym		;search symbol table
  0CF7'   B7                    	or	a
  0CF8'   C4 1E74'              	call	nz,misvar
  0CFB'   2A 0023"              	ld	hl,(adrs)
  0CFE'   3A 0016"              	ld	a,(idetyp)
  0D01'   E6 0F                 	and	0fh
  0D03'   FE 02                 	cp	2		;variable name ?
  0D05'   C2 2022'              	jp	nz,idxerr
  0D08'   E5                    	push	hl
  0D09'   CD 1B0F'              	call	gtoken
  0D0C'   FE 5B                 	cp	'['
  0D0E'   20 5C                 	jr	nz,stx3
  0D10'   CD 1B0F'              	call	gtoken
  0D13'   CD 0DF5'              	call	logexp		;expression
  0D16'   3A 003B"              	ld	a,(optble)
  0D19'   3D                    	dec	a
  0D1A'   C2 203D'              	jp	nz,experr
  0D1D'   3A 0036"              	ld	a,(tokcod)
  0D20'   FE 5D                 	cp	']'
  0D22'   C2 2022'              	jp	nz,idxerr
  0D25'   FD 7E FD              	ld	a,(iy-3)
  0D28'   FE 02                 	cp	2		;conatant ?
  0D2A'   28 33                 	jr	z,stx2
  0D2C'   B7                    	or	a		;expression ?
  0D2D'   28 06                 	jr	z,stx1
  0D2F'   21 0CDD'              	ld	hl,ldxobj1
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-32
Rev 1.01  08/30/1984

  0D32'   CD 188F'              	call	codgen		;code generate
  0D35'                         stx1:
  0D35'   E1                    	pop	hl
  0D36'   CD 183D'              	call	stoptb		;store operand table
  0D39'   21 0D90'              	ld	hl,stxobj1
  0D3C'   CD 188F'              	call	codgen
  0D3F'   CD 1B0F'              	call	gtoken
  0D42'   FE F0                 	cp	0f0h		;':=' ?
  0D44'   C2 2022'              	jp	nz,idxerr
  0D47'   CD 1B0F'              	call	gtoken
  0D4A'   16 DD                 	ld	d,0ddh		;index ix
  0D4C'   FE BF                 	cp	0bfh
  0D4E'   28 02                 	jr	z,$+4
  0D50'   16 FD                 	  ld	d,0fdh		;index iy
  0D52'   1E E5                 	ld	e,0e5h		;"  PUSH  IX " or "  PUSH  IY  "
  0D54'   CD 1964'              	call	ptcod2
  0D57'   21 0D98'              	ld	hl,stxobj2
  0D5A'   CD 188F'              	call	codgen
  0D5D'   18 26                 	jr	stx4
  0D5F'                         stx2:
  0D5F'   E1                    	pop	hl
  0D60'   FD 7E FE              	ld	a,(iy-2)
  0D63'   85                    	add	a,l
  0D64'   6F                    	ld	l,a
  0D65'   30 01                 	jr	nc,$+3
  0D67'   24                    	inc	h		;hl := hl + opr
  0D68'   E5                    	push	hl
  0D69'   CD 1B0F'              	call	gtoken
  0D6C'                         stx3:
  0D6C'   FE F0                 	cp	0f0h		;':=' ?
  0D6E'   C2 2022'              	jp	nz,idxerr
  0D71'   CD 1B0F'              	call	gtoken
  0D74'   16 DD                 	ld	d,0ddh		;index ix
  0D76'   FE BF                 	cp	0bfh
  0D78'   28 02                 	jr	z,$+4
  0D7A'   16 FD                 	ld	d,0fdh		;index iy
  0D7C'   1E 22                 	ld	e,22h
  0D7E'   CD 1964'              	call	ptcod2
  0D81'   E1                    	pop	hl
  0D82'   CD 1966'              	call	ptcodw
  0D85'                         stx4:
  0D85'   CD 1B0F'              	call	gtoken
  0D88'   FE 3B                 	cp	';'
  0D8A'   CA 1B0F'              	jp	z,gtoken
  0D8D'   C3 2022'              	jp	idxerr
                                ;
  0D90'   07                    stxobj1: defb	7
  0D91'   5F                    	ld	e,a
  0D92'   16 00                 	ld	d,0
  0D94'   21 B9B9               	ld	hl,opr1w
  0D97'   19                    	add	hl,de
                                ;
  0D98'   04                    stxobj2: defb	4
  0D99'   D1                    	pop	de
  0D9A'   73                    	ld	(hl),e
  0D9B'   23                    	inc	hl
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-33
Rev 1.01  08/30/1984

  0D9C'   72                    	ld	(hl),d
                                ;
                                ;	   inx	index;
  0D9D'                         inx::
  0D9D'   1E 23                 	ld	e,23h
  0D9F'   21                    	defb	21h		;skip 2 byte
                                ;
                                ;	   dex	index;
  0DA0'                         dex::
  0DA0'   1E 2B                 	ld	e,2bh
  0DA2'   16 DD                 	ld	d,0ddh		;index ix
  0DA4'   FE BF                 	cp	0bfh
  0DA6'   28 02                 	jr	z,$+4
  0DA8'   16 FD                 	ld	d,0fdh		;index iy
  0DAA'   CD 1964'              	call	ptcod2
  0DAD'   18 D6                 	jr	stx4
                                ;
                                ;	**  expression  **
                                ;
  0DAF'                         expres::
  0DAF'   CD 0DBD'              	call	expr0
  0DB2'   FE 3B                 	cp	';'
  0DB4'   CA 1B0F'              	jp	z,gtoken
  0DB7'   C3 203D'              	jp	experr		;error : bad expression
                                ;
  0DBA'                         expre::
  0DBA'   CD 1831'              	call	propt		;preset operand table pointer
  0DBD'                         expr0:
  0DBD'   CD 0DCF'              	call	expr2		;make expression object
  0DC0'   3A 003B"              	ld	a,(optble)	;check
  0DC3'   3D                    	dec	a
  0DC4'   C2 203D'              	jp	nz,experr
  0DC7'   3A 0036"              	ld	a,(tokcod)
  0DCA'   C9                    	ret
                                ;
  0DCB'                         expr1:
  0DCB'   AF                    	xor	a
  0DCC'   32 003A"              	ld	(puhptf),a
  0DCF'                         expr2:
  0DCF'   CD 0DF5'              	call	logexp		;logical expression
                                ;
  0DD2'                         expr5:
  0DD2'   FD 7E FD              	ld	a,(iy-3)
  0DD5'   B7                    	or	a
  0DD6'   C8                    	ret	z
  0DD7'   21 0DEC'              	ld	hl,ldexa
  0DDA'   3D                    	dec	a
  0DDB'   28 0C                 	jr	z,expr6
  0DDD'   21 0DF3'              	ld	hl,xora
  0DE0'   FD 7E FE              	ld	a,(iy-2)
  0DE3'   B7                    	or	a		;zero ?
  0DE4'   28 03                 	jr	z,expr6
  0DE6'   21 0DF0'              	ld	hl,ldime
  0DE9'                         expr6:
  0DE9'   C3 188F'              	jp	codgen		;code generate
                                ;
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-34
Rev 1.01  08/30/1984

  0DEC'   FD                    ldexa:	defb	-3
  0DED'   3A B9B9               	ld	a,(opr1w)
  0DF0'   FE                    ldime:	defb	-2
  0DF1'   3E B8                 	ld	a,opr1b
  0DF3'   FF                    xora:	defb	-1
  0DF4'   AF                    	xor	a
                                ;
                                ;  logical expression
                                ;
  0DF5'                         logexp::
  0DF5'   CD 0EA7'              	call	logtem0		;logical term
  0DF8'                         logexp1:
  0DF8'   3A 0036"              	ld	a,(tokcod)
  0DFB'   FE A6                 	cp	0a6h		;'xor' ?
  0DFD'   28 21                 	jr	z,logexp6
  0DFF'   FE A7                 	cp	0a7h		;'or' ?
  0E01'   28 07                 	jr	z,logexp4
  0E03'   FE 21                 	cp	'!'
  0E05'   28 03                 	jr	z,logexp4
  0E07'   FE 7C                 	cp	'|'
  0E09'   C0                    	ret	nz
                                ;
                                ;	   opr1 := opr1 | opr2
  0E0A'                         logexp4:
  0E0A'   CD 0EA4'              	call	logtem		;logical term
  0E0D'   21 0E36'              	ld	hl,orobj
  0E10'   CD 1876'              	call	dyagen		;code generate
  0E13'   30 E3                 	jr	nc,logexp1
  0E15'   FD 7E FE              	ld	a,(iy-2)
  0E18'   FD B6 01              	or	(iy+1)
  0E1B'   FD 77 FE              	ld	(iy-2),a	;m(iy-2) := m(iy-2) | m(iy+1)
  0E1E'   18 D8                 	jr	logexp1
                                ;
                                ;	   opr1 := opr1 xor opr2
  0E20'                         logexp6:
  0E20'   CD 0EA4'              	call	logtem
  0E23'   21 0E6D'              	ld	hl,xorobj
  0E26'   CD 1876'              	call	dyagen		;code generate
  0E29'   30 CD                 	jr	nc,logexp1
  0E2B'   FD 7E FE              	ld	a,(iy-2)
  0E2E'   FD AE 01              	xor	(iy+1)
  0E31'   FD 77 FE              	ld	(iy-2),a	;m(iy-2) := m(iy-2) xor m(iy+1)
  0E34'   18 C2                 	jr	logexp1
                                ;
                                ;  -- or object --
                                ;
  0E36'   0E46' 0E49'           orobj:	defw	oree,orev,orec
  0E3A'   0E4E'                 
  0E3C'   0E51' 0E56'           	defw	orve,orvv,orvc
  0E40'   0E5E'                 
  0E42'   0E64' 0E67'           	defw	orce,orcv
  0E46'   02                    oree:	defb	2
  0E47'   D1                    	pop	de
  0E48'   B2                    	or	d
                                
  0E49'   04                    orev:	defb	4
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-35
Rev 1.01  08/30/1984

  0E4A'   21 BBBB               	ld	hl,opr2w
  0E4D'   B6                    	or	(hl)
                                
  0E4E'   02                    orec:	defb	2
  0E4F'   F6 BA                 	or	opr2b
                                
  0E51'   04                    orve:	defb	4
  0E52'   21 B9B9               	ld	hl,opr1w
  0E55'   B6                    	or	(hl)
                                
  0E56'   F9                    orvv:	defb	-7
  0E57'   3A B9B9               	ld	a,(opr1w)
  0E5A'   21 BBBB               	ld	hl,opr2w
  0E5D'   B6                    	or	(hl)
                                
  0E5E'   FB                    orvc:	defb	-5
  0E5F'   3A B9B9               	ld	a,(opr1w)
  0E62'   F6 BA                 	or	opr2b
                                
  0E64'   02                    orce:	defb	2
  0E65'   F6 B8                 	or	opr1b
                                
  0E67'   FB                    orcv:	defb	-5
  0E68'   3A BBBB               	ld	a,(opr2w)
  0E6B'   F6 B8                 	or	opr1b
                                ;
                                ;  --  exclusive or object  --
                                ;
  0E6D'   0E7D' 0E80'           xorobj: defw	xoree,xorev,xorec
  0E71'   0E85'                 
  0E73'   0E88' 0E8D'           	defw	xorve,xorvv,xorvc
  0E77'   0E95'                 
  0E79'   0E9B' 0E9E'           	defw	xorce,xorcv
                                
  0E7D'   02                    xoree:	defb	2
  0E7E'   D1                    	pop	de
  0E7F'   AA                    	xor	d
                                
  0E80'   04                    xorev:	defb	4
  0E81'   21 BBBB               	ld	hl,opr2w
  0E84'   AE                    	xor	(hl)
                                
  0E85'   02                    xorec:	defb	2
  0E86'   EE BA                 	xor	opr2b
                                
  0E88'   04                    xorve:	defb	4
  0E89'   21 B9B9               	ld	hl,opr1w
  0E8C'   AE                    	xor	(hl)
                                
  0E8D'   F9                    xorvv:	defb	-7
  0E8E'   3A B9B9               	ld	a,(opr1w)
  0E91'   21 BBBB               	ld	hl,opr2w
  0E94'   AE                    	xor	(hl)
                                
  0E95'   FB                    xorvc:	defb	-5
  0E96'   3A B9B9               	ld	a,(opr1w)
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-36
Rev 1.01  08/30/1984

  0E99'   EE BA                 	xor	opr2b
                                
  0E9B'   02                    xorce:	defb	2
  0E9C'   EE B8                 	xor	opr1b
                                
  0E9E'   FB                    xorcv:	defb	-5
  0E9F'   3A BBBB               	ld	a,(opr2w)
  0EA2'   EE B8                 	xor	opr1b
                                
                                ;
                                ;  logical term
                                ;
  0EA4'                         logtem::
  0EA4'   CD 1B0F'              	call	gtoken		;get next token
  0EA7'                         logtem0:
  0EA7'   CD 0F04'              	call	logfac0		;logical factor
  0EAA'                         logtem1:
  0EAA'   3A 0036"              	ld	a,(tokcod)
  0EAD'   FE A8                 	cp	0a8h		;'and' ?
  0EAF'   28 03                 	jr	z,logtem2
  0EB1'   FE 26                 	cp	'&'
  0EB3'   C0                    	ret	nz
                                ;
                                ;	   opr1 := opr1 & opr2
  0EB4'                         logtem2:
  0EB4'   CD 0F01'              	call	logfac		;logical factor
  0EB7'   21 0ECA'              	ld	hl,andobj
  0EBA'   CD 1876'              	call	dyagen		;code generate
  0EBD'   30 EB                 	jr	nc,logtem1
  0EBF'   FD 7E FE              	ld	a,(iy-2)
  0EC2'   FD A6 01              	and	(iy+1)
  0EC5'   FD 77 FE              	ld	(iy-2),a	;m(iy-2) := m(iy-2) & m(iy+1)
  0EC8'   18 E0                 	jr	logtem1
                                ;
                                ;  --  and object  --
                                ;
  0ECA'   0EDA' 0EDD'           andobj:	defw	andee,andev,andec
  0ECE'   0EE2'                 
  0ED0'   0EE5' 0EEA'           	defw	andve,andvv,andvc
  0ED4'   0EF2'                 
  0ED6'   0EF8' 0EFB'           	defw	andce,andcv
                                
  0EDA'   02                    andee:	defb	2
  0EDB'   D1                    	pop	de
  0EDC'   A2                    	and	d
                                
  0EDD'   04                    andev:	defb	4
  0EDE'   21 BBBB               	ld	hl,opr2w
  0EE1'   A6                    	and	(hl)
                                
  0EE2'   02                    andec:	defb	2
  0EE3'   E6 BA                 	and	opr2b
                                
  0EE5'   04                    andve:	defb	4
  0EE6'   21 B9B9               	ld	hl,opr1w
  0EE9'   A6                    	and	(hl)
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-37
Rev 1.01  08/30/1984

                                
  0EEA'   F9                    andvv:	defb	-7
  0EEB'   3A B9B9               	ld	a,(opr1w)
  0EEE'   21 BBBB               	ld	hl,opr2w
  0EF1'   A6                    	and	(hl)
                                
  0EF2'   FB                    andvc:	defb	-5
  0EF3'   3A B9B9               	ld	a,(opr1w)
  0EF6'   E6 BA                 	and	opr2b
                                
  0EF8'   02                    andce:	defb	2
  0EF9'   E6 B8                 	and	opr1b
                                	
  0EFB'   FB                    andcv:	defb	-5
  0EFC'   3A BBBB               	ld	a,(opr2w)
  0EFF'   E6 B8                 	and	opr1b
                                
                                ;
                                ;  logical factor
                                ;
  0F01'                         logfac::
  0F01'   CD 1B0F'              	call	gtoken		;get next token
  0F04'                         logfac0:
  0F04'   3A 0036"              	ld	a,(tokcod)
  0F07'   FE A9                 	cp	0a9h		;'not' ?
  0F09'   28 08                 	jr	z,logfac1
  0F0B'   FE 5E                 	cp	'^'
  0F0D'   28 04                 	jr	z,logfac1
  0F0F'   FE 7E                 	cp	'~'
  0F11'   20 27                 	jr	nz,relexp	;relational expression
                                ;
                                ;	   opr := ^ opr
  0F13'                         logfac1:
  0F13'   CD 1B0F'              	call	gtoken		;get next token
  0F16'   CD 0F3A'              	call	relexp		;relational expression
  0F19'   FD 7E FD              	ld	a,(iy-3)
  0F1C'   B7                    	or	a
  0F1D'   28 11                 	jr	z,logfac3
  0F1F'   3D                    	dec	a		;variable ?
  0F20'   28 08                 	jr	z,logfac2
  0F22'   FD 7E FE              	ld	a,(iy-2)
  0F25'   2F                    	cpl
  0F26'   FD 77 FE              	ld	(iy-2),a	;m(iy-2) := ^m(iy-2)
  0F29'   C9                    	ret
  0F2A'                         logfac2:
  0F2A'   21 0F35'              	ld	hl,notobj
  0F2D'   C3 188F'              	jp	codgen		;code generate
  0F30'                         logfac3:
  0F30'   3E 2F                 	ld	a,2fh		;"  CPL  "
  0F32'   C3 1953'              	jp	ptcod1
                                ;
                                ;  --- not object  --
                                ;
  0F35'   FC                    notobj:	defb	-4
  0F36'   3A B9B9               	ld	a,(opr1w)
  0F39'   2F                    	cpl
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-38
Rev 1.01  08/30/1984

                                ;
                                ;  relational expression
                                ;
  0F3A'                         relexp::
  0F3A'   CD 0FBA'              	call	ariexp0		;arithmetic expression
  0F3D'   3A 0036"              	ld	a,(tokcod)
  0F40'   FE 3D                 	cp	'='
  0F42'   28 57                 	jr	z,relexp50
  0F44'   FE F3                 	cp	0f3h		;'<>' ?
  0F46'   28 42                 	jr	z,relexp40
  0F48'   FE 3E                 	cp	'>'
  0F4A'   28 2D                 	jr	z,relexp30
  0F4C'   FE F4                 	cp	0f4h		;'>=' ?
  0F4E'   28 1A                 	jr	z,relexp20
  0F50'   FE 3C                 	cp	'<'
  0F52'   28 0E                 	jr	z,relexp10
  0F54'   FE F2                 	cp	0f2h		;'<=' ?
  0F56'   C0                    	ret	nz
                                ;
                                ;	   opr1 := opr1 <= opr2
  0F57'                         relexp1:
  0F57'   CD 0FB7'              	call	ariexp		;arithmetic expression
  0F5A'   CD 1863'              	call	oprexc		;exchange
  0F5D'   CD 0FFD'              	call	subtra
  0F60'   18 10                 	jr	relexp21
                                ;
                                ;	   opr1 := opr1 < opr2
  0F62'                         relexp10:
  0F62'   CD 0FB7'              	call	ariexp
  0F65'   CD 0FFD'              	call	subtra
  0F68'   18 1A                 	jr	relexp31
                                ;
                                ;	   opr1 := opr1 >= opr2
  0F6A'                         relexp20:
  0F6A'   CD 0FB7'              	call	ariexp
  0F6D'   CD 0FFD'              	call	subtra
  0F70'   06                    	defb	06h		;skip 1 byte
  0F71'                         relobj3:
  0F71'   02                    	defb	2
  0F72'                         relexp21:
  0F72'   3F                    	ccf
  0F73'   9F                    	sbc	a,a
  0F74'   21 0F71'              	ld	hl,relobj3
  0F77'   18 32                 	jr	relexp60
                                ;
                                ;	   opr1 := opr1 > opr2
  0F79'                         relexp30:
  0F79'   CD 0FB7'              	call	ariexp
  0F7C'   CD 1863'              	call	oprexc		;exchange
  0F7F'   CD 0FFD'              	call	subtra
  0F82'   06                    	defb	06h		;skip 1 byte
  0F83'                         relobj2:
  0F83'   01                    	defb	1
  0F84'                         relexp31:
  0F84'   9F                    	sbc	a,a
  0F85'   21 0F83'              	ld	hl,relobj2
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-39
Rev 1.01  08/30/1984

  0F88'   18 21                 	jr	relexp60
                                ;
                                ;	   opr1 := opr1 <> opr2
  0F8A'                         relexp40:
  0F8A'   CD 0FB7'              	call	ariexp
  0F8D'   CD 0FFD'              	call	subtra
  0F90'   06                    	defb	06h		;skip 1 byte
  0F91'                         relobj1:
  0F91'   04                    	defb	4
  0F92'   28 02                 	jr	z,$+4		;if opr1 <> opr2
  0F94'   3E FF                 	ld	a,0ffh		;  then  a := 0ffh else a := 0
  0F96'   21 0F91'              	ld	hl,relobj1
  0F99'   18 10                 	jr	relexp60
                                ;
                                ;	   opr1 := opr1 = opr2
  0F9B'                         relexp50:
  0F9B'   CD 0FB7'              	call	ariexp
  0F9E'   CD 0FFD'              	call	subtra
  0FA1'   06                    	defb	06h		;skip 1 byte
  0FA2'                         relobj0:
  0FA2'   05                    	defb	5
  0FA3'   28 02                 	jr	z,$+4		;if opr1 = opr2
  0FA5'   3E FF                 	ld	a,0ffh		;  then a := 0ffh
  0FA7'   2F                    	cpl			;  else a := 0
  0FA8'   21 0FA2'              	ld	hl,relobj0
                                ;
  0FAB'                         relexp60:
  0FAB'   47                    	ld	b,a
  0FAC'   FD 7E FD              	ld	a,(iy-3)
  0FAF'   B7                    	or	a
  0FB0'   CA 188F'              	jp	z,codgen	;code generate
  0FB3'   FD 70 FE              	ld	(iy-2),b
  0FB6'   C9                    	ret
                                ;
                                ;  arithmetic expression
                                ;
  0FB7'                         ariexp::
  0FB7'   CD 1B0F'              	call	gtoken		;get next token
  0FBA'                         ariexp0:
  0FBA'   CD 1117'              	call	term0		;term
  0FBD'                         ariexp1:
  0FBD'   3A 0036"              	ld	a,(tokcod)
  0FC0'   FE 2B                 	cp	'+'
  0FC2'   28 4A                 	jr	z,ariexp5
  0FC4'   FE 2D                 	cp	'-'
  0FC6'   28 2D                 	jr	z,ariexp4
  0FC8'   FE AA                 	cp	0aah		;'plus' ?
  0FCA'   28 16                 	jr	z,ariexp3
  0FCC'   FE AB                 	cp	0abh		;'minus' ?
  0FCE'   C0                    	ret	nz
                                ;
                                ;	     opr1 := opr1  minus opr2
  0FCF'                         ariexp2:
  0FCF'   CD 1114'              	call	term
  0FD2'   21 1024'              	ld	hl,minobj
  0FD5'   CD 1876'              	call	dyagen		;code generate
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-40
Rev 1.01  08/30/1984

  0FD8'   30 E3                 	jr	nc,ariexp1
  0FDA'   21 1060'              	ld	hl,mincc
  0FDD'   CD 189A'              	call	codgen0
  0FE0'   18 DB                 	jr	ariexp1
                                ;
                                ;	   opr1 := opr1 plus opr2
                                ;
  0FE2'                         ariexp3:
  0FE2'   CD 1114'              	call	term
  0FE5'   21 1065'              	ld	hl,pluobj
  0FE8'   CD 1876'              	call	dyagen		;code generate
  0FEB'   30 D0                 	jr	nc,ariexp1
  0FED'   21 109C'              	ld	hl,plucc
  0FF0'   CD 189A'              	call	codgen0		;code generate
  0FF3'   18 C8                 	jr	ariexp1
                                ;
                                ;	   opr1 := opr1 - opr2
  0FF5'                         ariexp4:
  0FF5'   CD 1114'              	call	term
  0FF8'   CD 0FFD'              	call	subtra
  0FFB'   18 C0                 	jr	ariexp1
  0FFD'                         subtra:
  0FFD'   21 10A1'              	ld	hl,subobj
  1000'   CD 1876'              	call	dyagen		;code generate
  1003'   D0                    	ret	nc
  1004'   FD 7E FE              	ld	a,(iy-2)
  1007'   FD 96 01              	sub	(iy+1)
  100A'   FD 77 FE              	ld	(iy-2),a	;m(iy-2) := m(iy-2) - m(iy+1)
  100D'   C9                    	ret
                                ;
                                ;	   opr1 := opr1 + opr2
  100E'                         ariexp5:
  100E'   CD 1114'              	call	term
  1011'   21 10DD'              	ld	hl,addobj
  1014'   CD 1876'              	call	dyagen		;code generate
  1017'   30 A4                 	jr	nc,ariexp1
  1019'   FD 7E FE              	ld	a,(iy-2)
  101C'   FD 86 01              	add	a,(iy+1)
  101F'   FD 77 FE              	ld	(iy-2),a	;m(iy-2) := m(iy-2) + m(iy+1)
  1022'   18 99                 	jr	ariexp1
                                ;
                                ;  --  minus object  --
                                ;
  1024'   1034' 1038'           minobj:	defw	minee,minev,minec
  1028'   103D'                 
  102A'   1040' 1046'           	defw	minve,minvv,minvc
  102E'   104E'                 
  1030'   1054' 1059'           	defw	mince,mincv
                                
  1034'   03                    minee:	defb	3
  1035'   57                    	ld	d,a
  1036'   F1                    	pop	af
  1037'   9A                    	sbc	a,d
                                
  1038'   04                    minev:	defb	4
  1039'   21 BBBB               	ld	hl,opr2w
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-41
Rev 1.01  08/30/1984

  103C'   9E                    	sbc	a,(hl)
                                
  103D'   02                    minec:	defb	2
  103E'   DE BA                 	sbc	a,opr2b
                                
  1040'   05                    minve:	defb	5
  1041'   57                    	ld	d,a
  1042'   3A B9B9               	ld	a,(opr1w)
  1045'   9A                    	sbc	a,d
                                
  1046'   F9                    minvv:	defb	-7
  1047'   3A B9B9               	ld	a,(opr1w)
  104A'   21 BBBB               	ld	hl,opr2w
  104D'   9E                    	sbc	a,(hl)
                                
  104E'   FB                    minvc:	defb	-5
  104F'   3A B9B9               	ld	a,(opr1w)
  1052'   DE BA                 	sbc	a,opr2b
                                
  1054'   04                    mince:	defb	4
  1055'   57                    	ld	d,a
  1056'   3E B8                 	ld	a,opr1b
  1058'   9A                    	sbc	a,d
                                
  1059'   FA                    mincv:	defb	-6
  105A'   3E B8                 	ld	a,opr1b
  105C'   21 BBBB               	ld	hl,opr2w
  105F'   9E                    	sbc	a,(hl)
                                
  1060'   FC                    mincc:	defb	-4
  1061'   3E B8                 	ld	a,opr1b
  1063'   DE BA                 	sbc	a,opr2b
                                
                                ;
                                ; -- plus object
                                ;
  1065'   1075' 1078'           pluobj:	defw	pluee,pluev,pluec
  1069'   107D'                 
  106B'   1080' 1085'           	defw	pluve,pluvv,pluvc
  106F'   108D'                 
  1071'   1093' 1096'           	defw	pluce,plucv
                                
  1075'   02                    pluee:	defb	2
  1076'   D1                    	pop	de
  1077'   8A                    	adc	a,d
                                
  1078'   04                    pluev:	defb	4
  1079'   21 BBBB               	ld	hl,opr2w
  107C'   8E                    	adc	a,(hl)
                                
  107D'   02                    pluec:	defb	2
  107E'   CE BA                 	adc	a,opr2b
                                
  1080'   04                    pluve:	defb	4
  1081'   21 B9B9               	ld	hl,opr1w
  1084'   8E                    	adc	a,(hl)
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-42
Rev 1.01  08/30/1984

                                
  1085'   F9                    pluvv:	defb	-7
  1086'   3A B9B9               	ld	a,(opr1w)
  1089'   21 BBBB               	ld	hl,opr2w
  108C'   8E                    	adc	a,(hl)
                                
  108D'   FB                    pluvc:	defb	-5
  108E'   3A B9B9               	ld	a,(opr1w)
  1091'   CE BA                 	adc	a,opr2b
                                
  1093'   02                    pluce:	defb	2
  1094'   CE BA                 	adc	a,opr2b
                                
  1096'   FB                    plucv:	defb	-5
  1097'   3A BBBB               	ld	a,(opr2w)
  109A'   CE B8                 	adc	a,opr1b
                                
  109C'   FC                    plucc:	defb	-4
  109D'   3E B8                 	ld	a,opr1b
  109F'   CE BA                 	adc	a,opr2b
                                ;
                                ;  --  subtract object  --
                                ;
  10A1'   10B1' 10B5'           subobj:	defw	subee,subev,subec
  10A5'   10BA'                 
  10A7'   10BD' 10C3'           	defw	subve,subvv,subvc
  10AB'   10CB'                 
  10AD'   10D1' 10D6'           	defw	subce,subcv
                                
  10B1'   03                    subee:	defb	3
  10B2'   57                    	ld	d,a
  10B3'   F1                    	pop	af
  10B4'   92                    	sub	d
                                
  10B5'   04                    subev:	defb	4
  10B6'   21 BBBB               	ld	hl,opr2w
  10B9'   96                    	sub	(hl)
                                
  10BA'   02                    subec:	defb	2
  10BB'   D6 BA                 	sub	opr2b
                                
  10BD'   05                    subve:	defb	5
  10BE'   57                    	ld	d,a
  10BF'   3A B9B9               	ld	a,(opr1w)
  10C2'   92                    	sub	d
                                
  10C3'   F9                    subvv:	defb	-7
  10C4'   3A B9B9               	ld	a,(opr1w)
  10C7'   21 BBBB               	ld	hl,opr2w
  10CA'   96                    	sub	(hl)
                                
  10CB'   FB                    subvc:	defb	-5
  10CC'   3A B9B9               	ld	a,(opr1w)
  10CF'   D6 BA                 	sub	opr2b
                                
  10D1'   04                    subce:	defb	4
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-43
Rev 1.01  08/30/1984

  10D2'   57                    	ld	d,a
  10D3'   3E B8                 	ld	a,opr1b
  10D5'   92                    	sub	d
                                
  10D6'   FA                    subcv:	defb	-6
  10D7'   3E B8                 	ld	a,opr1b
  10D9'   21 BBBB               	ld	hl,opr2w
  10DC'   96                    	sub	(hl)
                                ;
                                ;  --  add object  --
                                ;
  10DD'   10ED' 10F0'           addobj:	defw	addee,addev,addec
  10E1'   10F5'                 
  10E3'   10F8' 10FD'           	defw	addve,addvv,addvc
  10E7'   1105'                 
  10E9'   110B' 110E'           	defw	addce,addcv
                                
  10ED'   02                    addee:	defb	2
  10EE'   D1                    	pop	de
  10EF'   82                    	add	a,d
                                
  10F0'   04                    addev:	defb	4
  10F1'   21 BBBB               	ld	hl,opr2w
  10F4'   86                    	add	a,(hl)
                                
  10F5'   02                    addec:	defb	2
  10F6'   C6 BA                 	add	a,opr2b
                                
  10F8'   04                    addve:	defb	4
  10F9'   21 B9B9               	ld	hl,opr1w
  10FC'   86                    	add	a,(hl)
                                
  10FD'   F9                    addvv:	defb	-7
  10FE'   3A B9B9               	ld	a,(opr1w)
  1101'   21 BBBB               	ld	hl,opr2w
  1104'   86                    	add	a,(hl)
                                
  1105'   FB                    addvc:	defb	-5
  1106'   3A B9B9               	ld	a,(opr1w)
  1109'   C6 BA                 	add	a,opr2b
                                
  110B'   02                    addce:	defb	2
  110C'   C6 B8                 	add	a,opr1b
                                
  110E'   FB                    addcv:	defb	-5
  110F'   3A BBBB               	ld	a,(opr2w)
  1112'   C6 B8                 	add	a,opr1b
                                
                                ;
                                ;  term
                                ;
  1114'                         term::
  1114'   CD 1B0F'              	call	gtoken		;get next token
  1117'                         term0:
  1117'   CD 1335'              	call	factor0		;factor
  111A'                         term1:
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-44
Rev 1.01  08/30/1984

  111A'   3A 0036"              	ld	a,(tokcod)
  111D'   FE 2A                 	cp	'*'
  111F'   28 73                 	jr	z,term6
  1121'   FE 2F                 	cp	'/'
  1123'   28 56                 	jr	z,term5
  1125'   FE 25                 	cp	'%'
  1127'   28 39                 	jr	z,term4
  1129'   FE F1                 	cp	0f1h		;'<<' ?
  112B'   28 1C                 	jr	z,term3
  112D'   FE F5                 	cp	0f5h		;'>>' ?
  112F'   C0                    	ret	nz
                                ;
                                ;	   opr1 := opr1 >> opr2
  1130'                         term2:
  1130'   CD 1332'              	call	factor
  1133'   21 11AF'              	ld	hl,shrobj
  1136'   CD 1876'              	call	dyagen		;code generate
  1139'   30 DF                 	jr	nc,term1
  113B'   FD 7E FE              	ld	a,(iy-2)
  113E'   FD 56 01              	ld	d,(iy+1)
  1141'   CD 0000*              	call	@shr.r
  1144'   FD 77 FE              	ld	(iy-2),a	; m(iy-2) := m(iy-2) >> m(iy+1)
  1147'   18 D1                 	jr	term1
                                ;
                                ;	   opr1 := opr1 << opr2
  1149'                         term3:
  1149'   CD 1332'              	call	factor
  114C'   21 11FD'              	ld	hl,shlobj
  114F'   CD 1876'              	call	dyagen		;code generate
  1152'   30 C6                 	jr	nc,term1
  1154'   FD 7E FE              	ld	a,(iy-2)
  1157'   FD 56 01              	ld	d,(iy+1)
  115A'   CD 0000*              	call	@shl.r
  115D'   FD 77 FE              	ld	(iy-2),a	; m(iy-2) := m(iy-2) << m(iy+1)
  1160'   18 B8                 	jr	term1
                                ;
                                ;	   opr1 := opr1 % opr2
  1162'                         term4:
  1162'   CD 1332'              	call	factor
  1165'   21 124B'              	ld	hl,remobj
  1168'   CD 1876'              	call	dyagen		;code generate
  116B'   30 AD                 	jr	nc,term1
  116D'   FD 7E FE              	ld	a,(iy-2)
  1170'   FD 56 01              	ld	d,(iy+1)
  1173'   CD 0000*              	call	@rem.r
  1176'   FD 77 FE              	ld	(iy-2),a	;m(iy-2) := m(iy-2) % m(iy+1)
  1179'   18 9F                 	jr	term1
                                ;
                                ;	   opr1 := opr1 / opr2
  117B'                         term5:
  117B'   CD 1332'              	call	factor
  117E'   21 1299'              	ld	hl,divobj
  1181'   CD 1876'              	call	dyagen		;code generate
  1184'   30 94                 	jr	nc,term1
  1186'   FD 7E FE              	ld	a,(iy-2)
  1189'   FD 56 01              	ld	d,(iy+1)
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-45
Rev 1.01  08/30/1984

  118C'   CD 0000*              	call	@div.r
  118F'   FD 77 FE              	ld	(iy-2),a	;m(iy-2) := m(iy-2) / m(iy+1)
  1192'   18 86                 	jr	term1
                                ;
                                ;	   opr1 := opr1 * opr2
  1194'                         term6:
  1194'   CD 1332'              	call	factor
  1197'   21 12E7'              	ld	hl,mulobj
  119A'   CD 1876'              	call	dyagen		;code generate
  119D'   D2 111A'              	jp	nc,term1
  11A0'   FD 7E FE              	ld	a,(iy-2)
  11A3'   FD 56 01              	ld	d,(iy+1)
  11A6'   CD 0000*              	call	@mul.r
  11A9'   FD 77 FE              	ld	(iy-2),a	;m(iy-2) := m(iy-2) * m(iy+1)
  11AC'   C3 111A'              	jp	term1
                                ;
                                ;   -  shift right object  --
                                ;
  11AF'   11BF' 11C5'           shrobj:	defw	shree,shrev,shrec
  11B3'   11CC'                 
  11B5'   11D2' 11DA'           	defw	shrve,shrvv,shrvc
  11B9'   11E4'                 
  11BB'   11ED' 11F4'           	defw	shrce,shrcv
                                
  11BF'   05                    shree:	defb	5
  11C0'   57                    	ld	d,a
  11C1'   F1                    	pop	af
  11C2'   CD 0000*              	call	@shr.r-@start
                                
  11C5'   06                    shrev:	defb	6
  11C6'   21 BBBB               	ld	hl,opr2w
  11C9'   CD 0000*              	call	@shr.m-@start
                                
  11CC'   05                    shrec:	defb	5
  11CD'   16 BA                 	ld	d,opr2b
  11CF'   CD 0000*              	call	@shr.r-@start
                                
  11D2'   07                    shrve:	defb	7
  11D3'   57                    	ld	d,a
  11D4'   3A B9B9               	ld	a,(opr1w)
  11D7'   CD 0000*              	call	@shr.r-@start
                                
  11DA'   F7                    shrvv:	defb	-9
  11DB'   3A B9B9               	ld	a,(opr1w)
  11DE'   21 BBBB               	ld	hl,opr2w
  11E1'   CD 0000*              	call	@shr.m-@start
                                
  11E4'   F8                    shrvc:	defb	-8
  11E5'   3A B9B9               	ld	a,(opr1w)
  11E8'   16 BA                 	ld	d,opr2b
  11EA'   CD 0000*              	call	@shr.r-@start
                                
  11ED'   06                    shrce:	defb	6
  11EE'   57                    	ld	d,a
  11EF'   3E B8                 	ld	a,opr1b
  11F1'   CD 0000*              	call	@shr.r-@start
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-46
Rev 1.01  08/30/1984

                                
  11F4'   F8                    shrcv:	defb	-8
  11F5'   3E B8                 	ld	a,opr1b
  11F7'   21 BBBB               	ld	hl,opr2w
  11FA'   CD 0000*              	call	@shr.m-@start
                                
                                ;
                                ;  --  shift left object  --
                                ;
  11FD'   120D' 1213'           shlobj:	defw	shlee,shlev,shlec
  1201'   121A'                 
  1203'   1220' 1228'           	defw	shlve,shlvv,shlvc
  1207'   1232'                 
  1209'   123B' 1242'           	defw	shlce,shlcv
                                
  120D'   05                    shlee:	defb	5
  120E'   57                    	ld	d,a
  120F'   F1                    	pop	af
  1210'   CD 0000*              	call	@shl.r-@start
                                
  1213'   06                    shlev:	defb	6
  1214'   21 BBBB               	ld	hl,opr2w
  1217'   CD 0000*              	call	@shl.m-@start
                                
  121A'   05                    shlec:	defb	5
  121B'   16 BA                 	ld	d,opr2b
  121D'   CD 0000*              	call	@shl.r-@start
                                
  1220'   07                    shlve:	defb	7
  1221'   57                    	ld	d,a
  1222'   3A B9B9               	ld	a,(opr1w)
  1225'   CD 0000*              	call	@shl.r-@start
                                
  1228'   F7                    shlvv:	defb	-9
  1229'   3A B9B9               	ld	a,(opr1w)
  122C'   21 BBBB               	ld	hl,opr2w
  122F'   CD 0000*              	call	@shl.m-@start
                                
  1232'   F8                    shlvc:	defb	-8
  1233'   3A B9B9               	ld	a,(opr1w)
  1236'   16 BA                 	ld	d,opr2b
  1238'   CD 0000*              	call	@shl.r-@start
                                
  123B'   06                    shlce:	defb	6
  123C'   57                    	ld	d,a
  123D'   3E B8                 	ld	a,opr1b
  123F'   CD 0000*              	call	@shl.r-@start
                                
  1242'   F8                    shlcv:	defb	-8
  1243'   3E B8                 	ld	a,opr1b
  1245'   21 BBBB               	ld	hl,opr2w
  1248'   CD 0000*              	call	@shl.m-@start
                                
                                
                                ;
                                ;  --  reminder object  --
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-47
Rev 1.01  08/30/1984

                                ;
  124B'   125B' 1261'           remobj:	defw	remee,remev,remec
  124F'   1268'                 
  1251'   126E' 1276'           	defw	remve,remvv,remvc
  1255'   1280'                 
  1257'   1289' 1290'           	defw	remce,remcv
                                
  125B'   05                    remee:	defb	5
  125C'   57                    	ld	d,a
  125D'   F1                    	pop	af
  125E'   CD 0000*              	call	@rem.r-@start
                                
  1261'   06                    remev:	defb	6
  1262'   21 BBBB               	ld	hl,opr2w
  1265'   CD 0000*              	call	@rem.m-@start
                                
  1268'   05                    remec:	defb	5
  1269'   16 BA                 	ld	d,opr2b
  126B'   CD 0000*              	call	@rem.r-@start
                                
  126E'   07                    remve:	defb	7
  126F'   57                    	ld	d,a
  1270'   3A B9B9               	ld	a,(opr1w)
  1273'   CD 0000*              	call	@rem.r-@start
                                
  1276'   F7                    remvv:	defb	-9
  1277'   3A B9B9               	ld	a,(opr1w)
  127A'   21 BBBB               	ld	hl,opr2w
  127D'   CD 0000*              	call	@rem.m-@start
                                
  1280'   F8                    remvc:	defb	-8
  1281'   3A B9B9               	ld	a,(opr1w)
  1284'   16 BA                 	ld	d,opr2b
  1286'   CD 0000*              	call	@rem.r-@start
                                
  1289'   06                    remce:	defb	6
  128A'   57                    	ld	d,a
  128B'   3E B8                 	ld	a,opr1b
  128D'   CD 0000*              	call	@rem.r-@start
                                
  1290'   F8                    remcv:	defb	-8
  1291'   3E B8                 	ld	a,opr1b
  1293'   21 BBBB               	ld	hl,opr2w
  1296'   CD 0000*              	call	@rem.m-@start
                                
                                
                                ;
                                ;  --  divide object  --
                                ;
  1299'   12A9' 12AF'           divobj:	defw	divee,divev,divec
  129D'   12B6'                 
  129F'   12BC' 12C4'           	defw	divve,divvv,divvc
  12A3'   12CE'                 
  12A5'   12D7' 12DE'           	defw	divce,divcv
                                
  12A9'   05                    divee:	defb	5
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-48
Rev 1.01  08/30/1984

  12AA'   57                    	ld	d,a
  12AB'   F1                    	pop	af
  12AC'   CD 0000*              	call	@div.r-@start
                                
  12AF'   06                    divev:	defb	6
  12B0'   21 BBBB               	ld	hl,opr2w
  12B3'   CD 0000*              	call	@div.m-@start
                                
  12B6'   05                    divec:	defb	5
  12B7'   16 BA                 	ld	d,opr2b
  12B9'   CD 0000*              	call	@div.r-@start
                                
  12BC'   07                    divve:	defb	7
  12BD'   57                    	ld	d,a
  12BE'   3A B9B9               	ld	a,(opr1w)
  12C1'   CD 0000*              	call	@div.r-@start
                                
  12C4'   F7                    divvv:	defb	-9
  12C5'   3A B9B9               	ld	a,(opr1w)
  12C8'   21 BBBB               	ld	hl,opr2w
  12CB'   CD 0000*              	call	@div.m-@start
                                
  12CE'   F8                    divvc:	defb	-8
  12CF'   3A B9B9               	ld	a,(opr1w)
  12D2'   16 BA                 	ld	d,opr2b
  12D4'   CD 0000*              	call	@div.r-@start
                                
  12D7'   06                    divce:	defb	6
  12D8'   57                    	ld	d,a
  12D9'   3E B8                 	ld	a,opr1b
  12DB'   CD 0000*              	call	@div.r-@start
                                
  12DE'   F8                    divcv:	defb	-8
  12DF'   3E B8                 	ld	a,opr1b
  12E1'   21 BBBB               	ld	hl,opr2w
  12E4'   CD 0000*              	call	@div.m-@start
                                
                                
                                ;
                                ;  --  multiply object  --
                                ;
  12E7'   12F7' 12FC'           mulobj:	defw	mulee,mulev,mulec
  12EB'   1303'                 
  12ED'   1309' 1310'           	defw	mulve,mulvv,mulvc
  12F1'   131A'                 
  12F3'   1323' 1329'           	defw	mulce,mulcv
                                
  12F7'   04                    mulee:	defb	4
  12F8'   D1                    	pop	de
  12F9'   CD 0000*              	call	@mul.r-@start
                                
  12FC'   06                    mulev:	defb	6
  12FD'   21 BBBB               	ld	hl,opr2w
  1300'   CD 0000*              	call	@mul.m-@start
                                
  1303'   05                    mulec:	defb	5
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-49
Rev 1.01  08/30/1984

  1304'   16 BA                 	ld	d,opr2b
  1306'   CD 0000*              	call	@mul.r-@start
                                
  1309'   06                    mulve:	defb	6
  130A'   21 B9B9               	ld	hl,opr1w
  130D'   CD 0000*              	call	@mul.m-@start
                                
  1310'   F7                    mulvv:	defb	-9
  1311'   3A B9B9               	ld	a,(opr1w)
  1314'   21 BBBB               	ld	hl,opr2w
  1317'   CD 0000*              	call	@mul.m-@start
                                
  131A'   F8                    mulvc:	defb	-8
  131B'   3A B9B9               	ld	a,(opr1w)
  131E'   16 BA                 	ld	d,opr2b
  1320'   CD 0000*              	call	@mul.r-@start
                                
  1323'   05                    mulce:	defb	5
  1324'   16 B8                 	ld	d,opr1b
  1326'   CD 0000*              	call	@mul.r-@start
                                
  1329'   F8                    mulcv:	defb	-8
  132A'   3A BBBB               	ld	a,(opr2w)
  132D'   16 B8                 	ld	d,opr1b
  132F'   CD 0000*              	call	@mul.r-@start
                                
                                ;
                                ;  factor
                                ;
  1332'                         factor::
  1332'   CD 1B0F'              	call	gtoken		;get next token
  1335'                         factor0:
  1335'   3A 0036"              	ld	a,(tokcod)
  1338'   FE 2B                 	cp	'+'
  133A'   28 2B                 	jr	z,factor5
  133C'   FE 2D                 	cp	'-'
  133E'   20 2A                 	jr	nz,expr
  1340'   CD 1367'              	call	factor5
  1343'   FD 7E FD              	ld	a,(iy-3)
  1346'   B7                    	or	a		;expression ?
  1347'   28 18                 	jr	z,factor2
  1349'   3D                    	dec	a		;variable ?
  134A'   28 09                 	jr	z,factor1
  134C'   FD 7E FE              	ld	a,(iy-2)
  134F'   ED 44                 	neg
  1351'   FD 77 FE              	ld	(iy-2),a	;m(iy-2) := -m(iy-2)
  1354'   C9                    	ret
  1355'                         factor1:
  1355'   21 135B'              	ld	hl,$+6
  1358'   C3 188F'              	jp	codgen
                                	;-----------------------+
  135B'   FB                    	defb	-5		;
  135C'   3A B9B9               	ld	a,(opr1w)	; neg object
  135F'   ED 44                 	neg			;
                                	;-----------------------+
  1361'                         factor2:
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-50
Rev 1.01  08/30/1984

  1361'   11 ED44               	ld	de,0ed44h	;"  NEG  "
  1364'   C3 1964'              	jp	ptcod2
                                
                                ;
  1367'                         factor5:
  1367'   CD 1B0F'              	call	gtoken		;get next token
                                ;
                                ;	    (  expression  )
  136A'                         expr::
  136A'   FE 28                 	cp	'('
  136C'   20 26                 	jr	nz,fun?
  136E'   CD 1B0F'              	call	gtoken		;get next token
  1371'                         exprx:
  1371'   CD 0DF5'              	call	logexp		;expression
  1374'                         exprx1:
  1374'   FE 2C                 	cp	','
  1376'   20 14                 	jr	nz,expry
  1378'   CD 0DD2'              	call	expr5
  137B'   CD 1856'              	call	decopt		;iy := iy - 3 ; dec(optble)
  137E'   CD 1B0F'              	call	gtoken
  1381'   CD 0DCB'              	call	expr1		;expression
  1384'   3A 0036"              	ld	a,(tokcod)
  1387'   18 EB                 	jr	exprx1
  1389'                         chkpar:
  1389'   3A 0036"              	ld	a,(tokcod)
  138C'                         expry:
  138C'   FE 29                 	cp	')'
  138E'   C2 203D'              	jp	nz,experr
  1391'   C3 1B0F'              	jp	gtoken
                                ;
                                ;	    ?( exp_1 : exp_2, exp_3 )
  1394'                         fun?::
  1394'   FE 3F                 	cp	'?'
  1396'   20 53                 	jr	nz,memor
                                ;
  1398'   CD 1B0F'              	call	gtoken		;get next token
  139B'   FE 28                 	cp	'('
  139D'   C2 203D'              	jp	nz,experr
  13A0'   CD 1B0F'              	call	gtoken
  13A3'   CD 0DCF'              	call	expr2		;expression_1
  13A6'   3A 0036"              	ld	a,(tokcod)
  13A9'   FE 3B                 	cp	';'
  13AB'   C2 203D'              	jp	nz,experr
  13AE'   3E B7                 	ld	a,0b7h		;"  OR	A  "
  13B0'   CD 1953'              	call	ptcod1
  13B3'   23                    	inc	hl
  13B4'   E5                    	push	hl
  13B5'   3E CA                 	ld	a,0cah
  13B7'   21 0000               	ld	hl,0		;"L1:  JP  Z,0  "
  13BA'   CD 196E'              	call	ptcod3
  13BD'   CD 1B0F'              	call	gtoken
  13C0'   CD 0DCB'              	call	expr1		;expression_2
  13C3'   CD 1856'              	call	decopt		; iy := iy - 3 : dec(optble)
  13C6'   3A 0036"              	ld	a,(tokcod)
  13C9'   FE 2C                 	cp	','
  13CB'   C2 203D'              	jp	nz,experr
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-51
Rev 1.01  08/30/1984

  13CE'   3E C3                 	ld	a,0c3h
  13D0'   21 0000               	ld	hl,0		;"L2:  JP  0  "
  13D3'   CD 196E'              	call	ptcod3
  13D6'   2B                    	dec	hl
  13D7'   2B                    	dec	hl
  13D8'   E3                    	ex	(sp),hl
  13D9'   CD 19B7'              	call	ptcha		;"  chain L1+1 "
  13DC'   CD 1B0F'              	call	gtoken
  13DF'   CD 0DCB'              	call	expr1		;expression_3
  13E2'   CD 1856'              	call	decopt		; iy := iy - 3 : dec(optble)
  13E5'   E1                    	pop	hl
  13E6'   CD 19B7'              	call	ptcha		;"  chain L2+1  "
  13E9'   18 9E                 	jr	chkpar
                                ;
                                ;	    memory[ exp_1, exp_2 ] := exp_3
  13EB'                         memor::
  13EB'   FE B9                 	cp	0b9h		;'memory' ?
  13ED'   28 05                 	jr	z,$+7
  13EF'   FE 40                 	cp	'@'
  13F1'   C2 14F3'              	jp	nz,port
                                ;
  13F4'   CD 1B0F'              	call	gtoken
  13F7'   FE 5B                 	cp	'['
  13F9'   C2 203D'              	jp	nz,experr
  13FC'   CD 1B0F'              	call	gtoken
  13FF'   FE BF                 	cp	0bfh		;'ix' ?
  1401'   28 4B                 	jr	z,memor2
  1403'   FE C0                 	cp	0c0h		;'iy' ?
  1405'   28 4A                 	jr	z,memor3
                                ;
  1407'   CD 0DCF'              	call	expr2		;expression_1
  140A'   CD 1856'              	call	decopt		; iy := iy - 3 : dec(optble)
  140D'   3A 0036"              	ld	a,(tokcod)
  1410'   FE 2C                 	cp	','
  1412'   C2 203D'              	jp	nz,experr
  1415'   CD 1B0F'              	call	gtoken
  1418'   3E F5                 	ld	a,0f5h		;" PUSH  AF"
  141A'   CD 1953'              	call	ptcod1
  141D'   CD 0DCB'              	call	expr1		;expression_2
  1420'   3A 0036"              	ld	a,(tokcod)
  1423'   FE 5D                 	cp	']'
  1425'   C2 203D'              	jp	nz,experr
  1428'   11 E16F               	ld	de,0e16fh	;"  POP  HL "
  142B'   CD 1964'              	call	ptcod2		;"  LD   L,A  "
  142E'   CD 1B0F'              	call	gtoken
  1431'   FE F0                 	cp	0f0h		;':=' ?
  1433'   20 14                 	jr	nz,memor1
  1435'   CD 1856'              	call	decopt		; iy := iy - 3 : dec(optble)
  1438'   3E E5                 	ld	a,0e5h		;"  PUSH  HL "
  143A'   CD 1953'              	call	ptcod1
  143D'   CD 1B0F'              	call	gtoken
  1440'   CD 0DCB'              	call	expr1		;expression_3
  1443'   11 E177               	ld	de,0e177h	;"  POP	HL "
  1446'   C3 1964'              	jp	ptcod2		;"  LD  (HL),A "
                                ;
                                ;	   memory[ exp_1, exp_2 ]
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-52
Rev 1.01  08/30/1984

  1449'                         memor1:
  1449'   3E 7E                 	ld	a,7eh		;"  LD	A,(HL)  "
  144B'   C3 1953'              	jp	ptcod1
                                ;
                                ;	   memory[ index +-, const ] := exp_1
  144E'                         memor2:
  144E'   3E DD                 	ld	a,0ddh		;index register ix
  1450'   21                    	defb	21h
  1451'                         memor3:
  1451'   3E FD                 	ld	a,0fdh		;index register iy
  1453'   F5                    	push	af
  1454'   CD 1B0F'              	call	gtoken
  1457'   FE 2B                 	cp	'+'		;auto increment ?
  1459'   28 16                 	jr	z,memor5
  145B'   FE 2D                 	cp	'-'		;auto decrement ?
  145D'   28 0F                 	jr	z,memor4
  145F'   2E 00                 	ld	l,0
  1461'   FE 2C                 	cp	','
  1463'   28 1E                 	jr	z,memor6
  1465'   26 00                 	ld	h,0
  1467'   FE 5D                 	cp	']'
  1469'   28 4C                 	jr	z,memor10
  146B'   C3 203D'              	jp	experr
  146E'                         memor4:
  146E'   2E 2B                 	ld	l,2bh		;decrement
  1470'   11                    	defb	11h		; 2 byte skip
  1471'                         memor5:
  1471'   2E 23                 	ld	l,23h		;increment
  1473'   E5                    	push	hl
  1474'   CD 1B0F'              	call	gtoken
  1477'   E1                    	pop	hl
  1478'   26 00                 	ld	h,0
  147A'   FE 5D                 	cp	']'
  147C'   28 39                 	jr	z,memor10
  147E'   FE 2E                 	cp	'.'
  1480'   C2 203D'              	jp	nz,experr
  1483'                         memor6:
  1483'   E5                    	push	hl
  1484'   CD 1B0F'              	call	gtoken
  1487'   FE 2B                 	cp	'+'
  1489'   28 05                 	jr	z,memor7
  148B'   FE 2D                 	cp	'-'
  148D'   20 08                 	jr	nz,memor8
  148F'   FE                    	defb	0feh		;reset z flag & 1 byte skip
  1490'                         memor7:
  1490'   AF                    	xor	a		;set z flag
  1491'   F5                    	push	af
  1492'   CD 1B0F'              	call	gtoken
  1495'   F1                    	pop	af
  1496'   0E                    	defb	0eh		;1 byte skip
  1497'                         memor8:
  1497'   AF                    	xor	a		;set z flag
  1498'   F5                    	push	af
  1499'   CD 19ED'              	call	bytcon		;byte constant
  149C'   F1                    	pop	af
  149D'   28 04                 	jr	z,memor9
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-53
Rev 1.01  08/30/1984

  149F'   AF                    	xor	a
  14A0'   95                    	sub	l
  14A1'   6F                    	ld	l,a		; l := 0 - 1
  14A2'   9F                    	sbc	a,a
  14A3'                         memor9:
  14A3'   CB 7D                 	bit	7,l		;check l = -128...+127 ?
  14A5'   28 01                 	jr	z,$+3
  14A7'   2F                    	cpl
  14A8'   B7                    	or	a
  14A9'   C4 1F99'              	call	nz,ilcnds
  14AC'   D1                    	pop	de
  14AD'   55                    	ld	d,l
  14AE'   EB                    	ex	de,hl
  14AF'   3A 0036"              	ld	a,(tokcod)
  14B2'   FE 5D                 	cp	']'
  14B4'   C2 203D'              	jp	nz,experr
  14B7'                         memor10:
  14B7'   E5                    	push	hl
  14B8'   CD 1B0F'              	call	gtoken
  14BB'   FE F0                 	cp	0f0h		;':=' ?
  14BD'   20 19                 	jr	nz,memor11
  14BF'   CD 1B0F'              	call	gtoken
  14C2'   CD 0DCF'              	call	expr2		;expression_1
  14C5'   E1                    	pop	hl
  14C6'   D1                    	pop	de
  14C7'   7A                    	ld	a,d
  14C8'   D5                    	push	de
  14C9'   E5                    	push	hl
  14CA'   2E 77                 	ld	l,77h		;"  LD  (IX+d),A " or "  LD  (IY+d),A  "
  14CC'   CD 196E'              	call	ptcod3
  14CF'   E1                    	pop	hl
  14D0'   D1                    	pop	de
  14D1'   7D                    	ld	a,l
  14D2'   B7                    	or	a
  14D3'   C8                    	ret	z
  14D4'   5D                    	ld	e,l		;"  INC  index " or "  DEC  index "
  14D5'   C3 1964'              	jp	ptcod2
                                ;
                                ;	   memory[ index +- , const ]
  14D8'                         memor11:
  14D8'   CD 1944'              	call	pacod		;"  PUSH  AF"
  14DB'   E1                    	pop	hl
  14DC'   D1                    	pop	de
  14DD'   7A                    	ld	a,d
  14DE'   D5                    	push	de
  14DF'   E5                    	push	hl
  14E0'   2E 7E                 	ld	l,7eh		;"  LD  A,(IX+d) " or "  LD  A,(IY+d)  "
  14E2'   CD 196E'              	call	ptcod3
  14E5'   E1                    	pop	hl
  14E6'   D1                    	pop	de
  14E7'   7D                    	ld	a,l
  14E8'   B7                    	or	a
  14E9'   28 05                 	jr	z,memor12
  14EB'   5D                    	ld	e,l		;"  INC  index " or "  DEC  index "
  14EC'   CD 1964'              	call	ptcod2
  14EF'   AF                    	xor	a
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-54
Rev 1.01  08/30/1984

  14F0'                         memor12:
  14F0'   C3 183D'              	jp	stoptb
                                ;
                                ;	   port[ exp_1 ] := exp_2
  14F3'                         port::
  14F3'   FE BA                 	cp	0bah		;'port' ?
  14F5'   28 04                 	jr	z,$+6
  14F7'   FE F6                 	  cp	0f6h		;'@@' ?
  14F9'   20 3F                 	  jr	nz,itrfun
                                ;
  14FB'   CD 1B0F'              	call	gtoken
  14FE'   FE 5B                 	cp	'['
  1500'   C2 203D'              	jp	nz,experr
  1503'   CD 1B0F'              	call	gtoken
  1506'   CD 0DCF'              	call	expr2		;expression_1
  1509'   3A 0036"              	ld	a,(tokcod)
  150C'   FE 5D                 	cp	']'
  150E'   C2 203D'              	jp	nz,experr
  1511'   CD 1B0F'              	call	gtoken
  1514'   FE F0                 	cp	0f0h		;':=' ?
  1516'   20 1A                 	jr	nz,port1
  1518'   CD 1856'              	call	decopt		; iy := iy - 3 : dec(optble)
  151B'   3E F5                 	ld	a,0f5h		;"  PUSH  AF  "
  151D'   CD 1953'              	call	ptcod1
  1520'   CD 1B0F'              	call	gtoken
  1523'   CD 0DCB'              	call	expr1		;expression_2
  1526'   11 D14A               	ld	de,0d14ah	;"  POP  DE  "
  1529'   CD 1964'              	call	ptcod2		;"  LD   C,D  "
  152C'   11 ED79               	ld	de,0ed79h	;"  OUT  (C),A  "
  152F'   C3 1964'              	jp	ptcod2
                                ;
                                ;	   port[ exp_1 ]
  1532'                         port1:
  1532'   3E 4F                 	ld	a,4fh		;"  LD  C,A  "
  1534'   21 78ED               	ld	hl,78edh	;"  IN  A,(C)  "
  1537'   C3 196E'              	jp	ptcod3
                                ;
                                ;    intrinsic function    inc( var ), dec( var )
  153A'                         itrfun::
  153A'   FE AC                 	cp	0ach		;'inc' ?
  153C'   28 07                 	jr	z,itrfun1
  153E'   FE AD                 	cp	0adh		;'dec' ?
  1540'   20 48                 	jr	nz,itrfun2
  1542'   3E 01                 	ld	a,1
  1544'   FE                    	defb	0feh
  1545'                         itrfun1:
  1545'   AF                    	xor	a
  1546'   F5                    	push	af
  1547'   CD 1B0F'              	call	gtoken		;get next token
  154A'   FE 28                 	cp	'('
  154C'   C2 203D'              	jp	nz,experr
  154F'   CD 1B0F'              	call	gtoken
  1552'   3D                    	dec	a
  1553'   C2 203D'              	jp	nz,experr
  1556'   21 0016"              	ld	hl,idetyp
  1559'   CD 0000*              	call	seasym		;search symbol table
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-55
Rev 1.01  08/30/1984

  155C'   B7                    	or	a
  155D'   C4 1E74'              	call	nz,misvar
  1560'   3A 0016"              	ld	a,(idetyp)
  1563'   E6 0F                 	and	0fh
  1565'   FE 02                 	cp	2		;variable name ?
  1567'   C2 203D'              	jp	nz,experr
  156A'   2A 0023"              	ld	hl,(adrs)
  156D'   3E 21                 	ld	a,21h		;"  LD  HL,nn "
  156F'   CD 196E'              	call	ptcod3
  1572'   F1                    	pop	af
  1573'   C6 34                 	add	a,34h		;"  INC  (HL)  " or "  DEC  (HL) "
  1575'   CD 1953'              	call	ptcod1
  1578'   AF                    	xor	a
  1579'   CD 183D'              	call	stoptb
  157C'   21 1588'              	ld	hl,ldam		;"  LD  A,(HL)  "
  157F'   CD 188F'              	call	codgen
  1582'   CD 1B0F'              	call	gtoken
  1585'   C3 1389'              	jp	chkpar		;')' ?
                                ;
  1588'   FF                    ldam:	defb	-1
  1589'   7E                    	ld	a,(hl)
                                ;
                                ;   intrinsic function	rl( exp ), rlc( exp ), rr( exp )
                                ;			rrc( exp ), sra( exp ),decj( exp )
  158A'                         itrfun2:
  158A'   FE AE                 	cp	0aeh		;'rl','rlc','rr','rrc','sra','decj' ?
  158C'   DA 161E'              	jp	c,vardat
  158F'   FE B4                 	cp	0b3h+1
  1591'   30 2E                 	jr	nc,itrfun3
  1593'   D6 AE                 	sub	0aeh
  1595'   F5                    	push	af
  1596'   CD 1B0F'              	call	gtoken
  1599'   FE 28                 	cp	'('
  159B'   C2 203D'              	jp	nz,experr
  159E'   CD 1B0F'              	call	gtoken
  15A1'   CD 1371'              	call	exprx		;expression
  15A4'   CD 0DD2'              	call	expr5
  15A7'   F1                    	pop	af
  15A8'   5F                    	ld	e,a
  15A9'   16 00                 	ld	d,0
  15AB'   21 15BB'              	ld	hl,iteobj
  15AE'   19                    	add	hl,de
  15AF'   7E                    	ld	a,(hl)
  15B0'   FE CB                 	cp	0cbh
  15B2'   C2 1953'              	jp	nz,ptcod1
  15B5'   57                    	ld	d,a
  15B6'   1E 2F                 	ld	e,2fh		;"  SRA  A  "
  15B8'   C3 1964'              	jp	ptcod2
                                ;
  15BB'   17                    iteobj:	rla
  15BC'   07                    	rlca
  15BD'   1F                    	rra
  15BE'   0F                    	rrca
  15BF'   CB                    	defb	0cbh
  15C0'   27                    	daa
                                ;
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-56
Rev 1.01  08/30/1984

                                ;    intrinsic function	   carry( exp ), zero( exp )
                                ;			   sign( exp ), parity( exp ),  overflow( exp )
  15C1'                         itrfun3:
  15C1'   FE B9                 	cp	0b8h+1		;'carry','zero','sign','parity','overflow'?
  15C3'   30 59                 	jr	nc,vardat
  15C5'   D6 B4                 	sub	0b4h
  15C7'   F5                    	push	af
  15C8'   CD 1B0F'              	call	gtoken
  15CB'   FE 28                 	cp	'('
  15CD'   C2 203D'              	jp	nz,experr
  15D0'   CD 1B0F'              	call	gtoken
  15D3'   FE 29                 	cp	')'
  15D5'   28 08                 	jr	z,itrfun4
  15D7'   CD 1371'              	call	exprx		;expression
  15DA'   CD 0DD2'              	call	expr5
  15DD'   18 0A                 	jr	itrfun8
  15DF'                         itrfun4:
  15DF'   CD 1B0F'              	call	gtoken
  15E2'   CD 1944'              	call	pacod		;"  PUSH  AF  "
  15E5'   AF                    	xor	a
  15E6'   CD 183D'              	call	stoptb
  15E9'                         itrfun8:
  15E9'   F1                    	pop	af
  15EA'   20 04                 	jr	nz,itrfun5
  15EC'   3E 9F                 	ld	a,9fh		;"  SBC  A,A  "
  15EE'   18 13                 	jr	itrfun6
  15F0'                         itrfun5:
  15F0'   F5                    	push	af
  15F1'   11 3E00               	ld	de,3e00h	;"  LD  A,0  "
  15F4'   CD 1964'              	call	ptcod2
  15F7'   F1                    	pop	af
  15F8'   3D                    	dec	a
  15F9'   20 0B                 	jr	nz,itrfun7
  15FB'   11 2001               	ld	de,2001h	;"  JR  NZ,$+3"
  15FE'   CD 1964'              	call	ptcod2
  1601'   3E 2F                 	ld	a,2fh		;"  CPL  "
  1603'                         itrfun6:
  1603'   C3 1953'              	jp	ptcod1
  1606'                         itrfun7:
  1606'   21 0000               	ld	hl,0
  1609'   3D                    	dec	a
  160A'   3E F2                 	ld	a,0f2h		;"L1:  JP  P,0  "
  160C'   28 02                 	jr	z,$+4
  160E'   3E E2                 	  ld	a,0e2h		;"L1:  JP  PO.0  "
  1610'   CD 196E'              	call	ptcod3
  1613'   3E 2F                 	ld	a,2fh		;"  CPL  "
  1615'   CD 1953'              	call	ptcod1
  1618'   2B                    	dec	hl
  1619'   2B                    	dec	hl
  161A'   2B                    	dec	hl
  161B'   C3 19B7'              	jp	ptcha		;"  chain L1+1   "
                                ;
                                ;	variabel & data name
  161E'                         vardat::
  161E'   2A 0012"              	ld	hl,(conval)
  1621'   B7                    	or	a
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-57
Rev 1.01  08/30/1984

  1622'   CA 16F5'              	jp	z,const5
  1625'   3D                    	dec	a		;identifier ?
  1626'   C2 16F0'              	jp	nz,const
  1629'   21 0016"              	ld	hl,idetyp
  162C'   CD 0000*              	call	seasym		;search symbol table
  162F'   B7                    	or	a		;found ?
  1630'   20 19                 	jr	nz,uvarck	;skip if not
  1632'   2A 0023"              	ld	hl,(adrs)
  1635'   3A 0016"              	ld	a,(idetyp)
  1638'   E6 0F                 	and	0fh
  163A'   FE 01                 	cp	1		;constant name ?
  163C'   CA 16F5'              	jp	z,const5	;skip if so
  163F'   FE 08                 	cp	8		;label ?
  1641'   CA 203D'              	jp	z,experr	;error if so
  1644'   FE 09                 	cp	9		;function name ?
  1646'   CA 172D'              	jp	z,funcal	;skip if so
  1649'   18 13                 	jr	vardat0
  164B'                         uvarck:
  164B'   2A 0000"              	ld	hl,(cptr)
  164E'   CD 1DBE'              	call	spskip		;space skip
  1651'   FE 28                 	cp	'('
  1653'   CA 1704'              	jp	z,ufuncl
  1656'   CD 1E74'              	call	misvar
  1659'   3E 02                 	ld	a,2
  165B'   21 0000               	ld	hl,0
                                ;
                                ;	   var[ exp_1 ] := exp_2
  165E'                         vardat0:
  165E'   F5                    	push	af
  165F'   E5                    	push	hl
  1660'   CD 1B0F'              	call	gtoken		;get next token
  1663'   FE 5B                 	cp	'['
  1665'   20 62                 	jr	nz,vardat5
  1667'   CD 1B0F'              	call	gtoken
  166A'   CD 0DF5'              	call	logexp		;expression_1
  166D'   3A 0036"              	ld	a,(tokcod)
  1670'   FE 5D                 	cp	']'
  1672'   C2 203D'              	jp	nz,experr
  1675'   FD 7E FD              	ld	a,(iy-3)
  1678'   FE 02                 	cp	2		;constant ?
  167A'   28 3D                 	jr	z,vardat4
  167C'   B7                    	or	a		;expression ?
  167D'   28 06                 	jr	z,vardat1
  167F'   21 0DEC'              	ld	hl,ldexa
  1682'   CD 188F'              	call	codgen		;code generate
  1685'                         vardat1:
  1685'   E1                    	pop	hl
  1686'   CD 183D'              	call	stoptb		;store operand table
  1689'   21 16E8'              	ld	hl,indobj
  168C'   CD 188F'              	call	codgen		;code generate
  168F'   CD 1856'              	call	decopt		; iy :=  iy - 3 : dec(optble)
  1692'   CD 1B0F'              	call	gtoken
  1695'   FE F0                 	cp	0f0h		;':=' ?
  1697'   20 1A                 	jr	nz,vardat2
  1699'   F1                    	pop	af
  169A'   FE 03                 	cp	3		;data ?
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-58
Rev 1.01  08/30/1984

  169C'   CA 203D'              	jp	z,experr
  169F'   CD 1856'              	call	decopt		; iy := iy - 3 : dec(optble)
  16A2'   3E E5                 	ld	a,0e5h		;"  PUSH  HL  "
  16A4'   CD 1953'              	call	ptcod1
  16A7'   CD 1B0F'              	call	gtoken
  16AA'   CD 0DCB'              	call	expr1		;expression_2
  16AD'   11 E177               	ld	de,0e177h	;"  POP  HL  "
  16B0'   C3 1964'              	jp	ptcod2		;"  LD   (HL),A  "
                                ;
                                ;	   var[ exp ]
  16B3'                         vardat2:
  16B3'   F1                    	pop	af
  16B4'   3E 7E                 	ld	a,7eh		;"  LD   A,(HL)  "
  16B6'   C3 1953'              	jp	ptcod1
                                ;
                                ;	   var[ const ] := exp
  16B9'                         vardat4:
  16B9'   E1                    	pop	hl
  16BA'   FD 7E FE              	ld	a,(iy-2)
  16BD'   85                    	add	a,l
  16BE'   6F                    	ld	l,a
  16BF'   30 01                 	jr	nc,$+3
  16C1'   24                    	  inc	h		;hl := hl + opr
  16C2'   E5                    	push	hl
  16C3'   CD 1856'              	call	decopt		;iy := iy - 3 : dec(optble)
  16C6'   CD 1B0F'              	call	gtoken
                                ;
                                ;	   var := exp
  16C9'                         vardat5:
  16C9'   FE F0                 	cp	0f0h		;':=' ?
  16CB'   20 14                 	jr	nz,vardat6
  16CD'   E1                    	pop	hl
  16CE'   F1                    	pop	af
  16CF'   FE 03                 	cp	3		;data ?
  16D1'   CA 203D'              	jp	z,experr
  16D4'   E5                    	push	hl
  16D5'   CD 1B0F'              	call	gtoken
  16D8'   CD 0DCF'              	call	expr2		;expression
  16DB'   E1                    	pop	hl
  16DC'   3E 32                 	ld	a,32h		;"  LD  (nn),A  "
  16DE'   C3 196E'              	jp	ptcod3
                                ;
                                ;	   val
  16E1'                         vardat6:
  16E1'   E1                    	pop	hl
  16E2'   F1                    	pop	af
  16E3'   3E 01                 	ld	a,1
  16E5'   C3 183D'              	jp	stoptb
                                ;
  16E8'   07                    indobj:	defb	7
  16E9'   5F                    	ld	e,a
  16EA'   16 00                 	ld	d,0
  16EC'   21 B9B9               	ld	hl,opr1w
  16EF'   19                    	add	hl,de
                                ;
                                ;	constant
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-59
Rev 1.01  08/30/1984

  16F0'                         const::
  16F0'   CD 19ED'              	call	bytcon		;byte constant
  16F3'   18 0A                 	jr	const6
  16F5'                         const5:
  16F5'   7C                    	ld	a,h
  16F6'   B7                    	or	a		;check h=0...+127 ?
  16F7'   C4 1FAB'              	call	nz,ilcnor
  16FA'   E5                    	push	hl
  16FB'   CD 1B0F'              	call	gtoken
  16FE'   E1                    	pop	hl
  16FF'                         const6:
  16FF'   3E 02                 	ld	a,2
  1701'   C3 183D'              	jp	stoptb		;store operand table
                                ;
                                ;	function call
  1704'                         ufuncl:
  1704'   21 0000               	ld	hl,0
  1707'                         ufuncl1:
  1707'   22 0078"              	ld	(caladr),hl
  170A'   01 000C               	ld	bc,adrs-identi
  170D'   21 0017"              	ld	hl,identi
  1710'   CD 1AF3'              	call	blkpsh		;block push
  1713'   CD 1736'              	call	func1
  1716'   01 000C               	ld	bc,adrs-identi
  1719'   21 0017"              	ld	hl,identi
  171C'   CD 1B03'              	call	blkpop		;block pop
  171F'   2A 0078"              	ld	hl,(caladr)
  1722'   22 0023"              	ld	(adrs),hl
  1725'   21 0016"              	ld	hl,idetyp
  1728'   36 89                 	ld	(hl),89h	;type = undefined function
  172A'   C3 0000*              	jp	regsym		;symbol table register
                                ;
  172D'                         funcal::
  172D'   3A 0016"              	ld	a,(idetyp)
  1730'   07                    	rlca			;undefined function ?
  1731'   38 D4                 	jr	c,ufuncl1
  1733'   22 0078"              	ld	(caladr),hl
                                ;
                                ;	   func( exp_1, ... , exp_n : const1, const_2 )
  1736'                         func1::
  1736'   CD 1B0F'              	call	gtoken
  1739'   FE 28                 	cp	'('
  173B'   C2 203D'              	jp	nz,experr
  173E'   CD 1944'              	call	pacod		;"  PUSH  AF  "
  1741'   3A 0039"              	ld	a,(loopb)
  1744'   B7                    	or	a		;loop # ?
  1745'   F5                    	push	af
  1746'   3E C5                 	ld	a,0c5h		;"  PUSH  BC  "
  1748'   C4 1953'              	call	nz,ptcod1
  174B'   2A 0078"              	ld	hl,(caladr)
  174E'   E5                    	push	hl
  174F'   CD 1B0F'              	call	gtoken
  1752'   FE 3B                 	cp	';'
  1754'   28 4D                 	jr	z,funcal4
  1756'   FE 29                 	cp	')'
  1758'   CA 1808'              	jp	z,funcal7
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-60
Rev 1.01  08/30/1984

  175B'   11 3601               	ld	de,3601h
  175E'   D5                    	push	de
  175F'   18 04                 	jr	funcal2
  1761'                         funcal1:
  1761'   D5                    	push	de
  1762'   CD 1B0F'              	call	gtoken
  1765'                         funcal2:
  1765'   CD 0DCB'              	call	expr1		;expression_n
  1768'   CD 1856'              	call	decopt		;iy := iy - 3 : dec(optble)
  176B'   3E F5                 	ld	a,0f5h		;"  PUSH  AF  "
  176D'   CD 1953'              	call	ptcod1
  1770'   D1                    	pop	de
  1771'   3A 0036"              	ld	a,(tokcod)
  1774'   FE 3B                 	cp	';'
  1776'   28 16                 	jr	z,funcal3
  1778'   FE 29                 	cp	')'
  177A'   28 12                 	jr	z,funcal3
  177C'   FE 2C                 	cp	','
  177E'   C2 203D'              	jp	nz,experr
  1781'   1C                    	inc	e
  1782'   7B                    	ld	a,e
  1783'   FE 21                 	cp	32+1
  1785'   38 DA                 	jr	c,funcal1
  1787'   CC 1F5F'              	call	z,tmarg
  178A'   1E 21                 	ld	e,32+1
  178C'   18 D3                 	jr	funcal1
  178E'                         funcal3:
  178E'   F5                    	push	af
  178F'   D5                    	push	de
  1790'   3E 21                 	ld	a,21h
  1792'   2A 0008"              	ld	hl,(datorg)	;"  LD  HL,DSEG  "
  1795'   CD 196E'              	call	ptcod3
  1798'   D1                    	pop	de
  1799'   CD 1964'              	call	ptcod2		;"  LD  (HL),n  "
  179C'   F1                    	pop	af
  179D'   FE 29                 	cp	')'
  179F'   28 74                 	jr	z,funcal8
  17A1'   18 0D                 	jr	funcal5
  17A3'                         funcal4:
  17A3'   3E AF                 	ld	a,0afh		;"  XOR  A  "
  17A5'   CD 1953'              	call	ptcod1
  17A8'   3E 32                 	ld	a,32h
  17AA'   2A 0008"              	ld	hl,(datorg)	;"  LD   (DSEG),A  "
  17AD'   CD 196E'              	call	ptcod3
  17B0'                         funcal5:
  17B0'   CD 1B0F'              	call	gtoken
  17B3'   FE 2C                 	cp	','
  17B5'   28 28                 	jr	z,funcal6
  17B7'   FE BF                 	cp	0bfh		; ix ?
  17B9'   20 10                 	jr	nz,funcal5.2
  17BB'   11 DDE5               	ld	de,0dde5h	;"  PUSH  IX  "
  17BE'   CD 1964'              	call	ptcod2
  17C1'   3E E1                 	ld	a,0e1h		;"  POP   HL  "
  17C3'   CD 1953'              	call	ptcod1
  17C6'   CD 1B0F'              	call	gtoken
  17C9'   18 08                 	jr	funcal5.5
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-61
Rev 1.01  08/30/1984

  17CB'                         funcal5.2:
  17CB'   CD 19C7'              	call	conexp		;constant expression
  17CE'   3E 21                 	ld	a,21h
  17D0'   CD 196E'              	call	ptcod3		;"  LD   HL,nn  "
  17D3'                         funcal5.5:
  17D3'   3A 0036"              	ld	a,(tokcod)
  17D6'   FE 29                 	cp	')'
  17D8'   28 3B                 	jr	z,funcal8
  17DA'   FE 2C                 	cp	','
  17DC'   C2 203D'              	jp	nz,experr
  17DF'                         funcal6:
  17DF'   CD 1B0F'              	call	gtoken
  17E2'   FE C0                 	cp	0c0h		; iy ?
  17E4'   20 10                 	jr	nz,funcal6.2
  17E6'   11 FDE5               	ld	de,0fde5h	;"  PUSH  IY  "
  17E9'   CD 1964'              	call	ptcod2
  17EC'   3E D1                 	ld	a,0d1h		;"  POP   HL  "
  17EE'   CD 1953'              	call	ptcod1
  17F1'   CD 1B0F'              	call	gtoken
  17F4'   18 08                 	jr	funcal6.5
  17F6'                         funcal6.2:
  17F6'   CD 19C7'              	call	conexp		;constant expression
  17F9'   3E 11                 	ld	a,11h
  17FB'   CD 196E'              	call	ptcod3
  17FE'                         funcal6.5:
  17FE'   3A 0036"              	ld	a,(tokcod)
  1801'   FE 29                 	cp	')'
  1803'   C2 203D'              	jp	nz,experr
  1806'   18 0D                 	jr	funcal8
  1808'                         funcal7:
  1808'   3E AF                 	ld	a,0afh		;"  XOR  A  "
  180A'   CD 1953'              	call	ptcod1
  180D'   3E 32                 	ld	a,32h
  180F'   2A 0008"              	ld	hl,(datorg)	;"  LD   (DSEG),A  "
  1812'   CD 196E'              	call	ptcod3
  1815'                         funcal8:
  1815'   D1                    	pop	de
  1816'   2A 000C"              	ld	hl,(cloc)
  1819'   23                    	inc	hl
  181A'   22 0078"              	ld	(caladr),hl	; funadr := cloc + 1
  181D'   EB                    	ex	de,hl
  181E'   3E CD                 	ld	a,0cdh
  1820'   CD 196E'              	call	ptcod3		;"  CALL  nn  "
  1823'   F1                    	pop	af
  1824'   3E C1                 	ld	a,0c1h		;"  POP   BC  "
  1826'   C4 1953'              	call	nz,ptcod1
  1829'   3E 00                 	ld	a,0
  182B'   CD 183D'              	call	stoptb		;store operand table
  182E'   C3 1B0F'              	jp	gtoken
                                ;
                                ;	**  preset operand table pointer & work clear  **
                                ;
  1831'                         propt::
  1831'   FD 21 003C"           	ld	iy,oprtbl
  1835'   AF                    	xor	a
  1836'   32 003B"              	ld	(optble),a
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-62
Rev 1.01  08/30/1984

  1839'   32 003A"              	ld	(puhptf),a
  183C'   C9                    	ret
                                ;
                                ;	**  store operand table
  183D'                         stoptb::  ;	a : operand type ( 0=exp, 1=var, 2=cons )
                                	  ;	hl: address or constant
  183D'   FD 77 00              	ld	(iy+0),a
  1840'   FD 75 01              	ld	(iy+1),l
  1843'   FD 74 02              	ld	(iy+2),h	;store
  1846'   11 0003               	ld	de,3
  1849'   FD 19                 	add	iy,de
  184B'   21 003B"              	ld	hl,optble
  184E'   34                    	inc	(hl)
  184F'   7E                    	ld	a,(hl)		;check
  1850'   FE 14                 	cp	(oprtbe-oprtbl)/3
  1852'   D2 203D'              	jp	nc,experr
  1855'   C9                    	ret
                                ;
                                ;	**  decrement operand table pointer  **
                                ;
  1856'                         decopt::
  1856'   FD 2B                 	dec	iy
  1858'   FD 2B                 	dec	iy
  185A'   FD 2B                 	dec	iy
  185C'   E5                    	push	hl
  185D'   21 003B"              	ld	hl,optble
  1860'   35                    	dec	(hl)
  1861'   E1                    	pop	hl
  1862'   C9                    	ret
                                ;
                                ;	**  exchange operand 1, operand 2  **
                                ;
  1863'                         oprexc::
  1863'   FD E5                 	push	iy
  1865'   D1                    	pop	de
  1866'   21 FFFD               	ld	hl,-3
  1869'   19                    	add	hl,de
  186A'   06 03                 	ld	b,3
  186C'                         oprexc1:
  186C'   2B                    	dec	hl
  186D'   1B                    	dec	de
  186E'   1A                    	ld	a,(de)
  186F'   4E                    	ld	c,(hl)
  1870'   EB                    	ex	de,hl
  1871'   71                    	ld	(hl),c
  1872'   12                    	ld	(de),a
  1873'   10 F7                 	djnz	oprexc1
  1875'   C9                    	ret
                                ;
                                ;
  00B8                          opr1b	equ	0b8h		;operand 1 byte data mark
  B9B9                          opr1w	equ	0b9b9h		;operand 1 word data mark
  00BA                          opr2b	equ	0bah		;operand 2 byte data mark
  BBBB                          opr2w	equ	0bbbbh		;operand 2 word data mark
                                ;
                                ;	**  dyadic operation, code generate  **
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-63
Rev 1.01  08/30/1984

                                ;
  1876'                         dyagen:: ;	hl: address table address
                                	 ;	iy: operand table pointer
  1876'   FD 7E FA              	ld	a,(iy-6)
  1879'   5F                    	ld	e,a
  187A'   87                    	add	a,a
  187B'   83                    	add	a,e
  187C'   FD 86 FD              	add	a,(iy-3)	;a := m(iy-6)*3 + m(iy-3)
  187F'   FE 08                 	cp	8
  1881'   CA 192B'              	jp	z,codgen10	;skip if so
  1884'   87                    	add	a,a
  1885'   5F                    	ld	e,a
  1886'   16 00                 	ld	d,0
  1888'   19                    	add	hl,de
  1889'   5E                    	ld	e,(hl)
  188A'   23                    	inc	hl
  188B'   56                    	ld	d,(hl)
  188C'   EB                    	ex	de,hl		;hl = object code store address
  188D'   18 0B                 	jr	codgen0
                                ;
                                ;	**  code generate  **
  188F'                         codgen::  ;	hl: object code store address
                                	  ;	iy: operand table pointer
  188F'   11 0003               	ld	de,3
  1892'   FD 19                 	add	iy,de		; iy := iy + 3
  1894'   EB                    	ex	de,hl
  1895'   21 003B"              	ld	hl,optble
  1898'   34                    	inc	(hl)		;inc(optble)
  1899'   EB                    	ex	de,hl
                                ;
  189A'                         codgen0:
  189A'   7E                    	ld	a,(hl)
  189B'   47                    	ld	b,a
  189C'   B7                    	or	a		;"PUSH  AF" output ?
  189D'   FC 1930'              	call	m,codgen15
  18A0'   C5                    	push	bc
  18A1'   E5                    	push	hl
  18A2'   CD 0000*              	call	putobj		;put object
  18A5'   E1                    	pop	hl
  18A6'   C1                    	pop	bc
  18A7'                         codgen1:
  18A7'   23                    	inc	hl
  18A8'   C5                    	push	bc
  18A9'   7E                    	ld	a,(hl)
  18AA'   FE B8                 	cp	opr1b		;operand 1, byte out ?
  18AC'   20 05                 	jr	nz,codgen2
  18AE'   FD 7E FB              	ld	a,(iy-5)
  18B1'   18 62                 	jr	codgen7
  18B3'                         codgen2:
  18B3'   FE B9                 	cp	low opr1w	;operand 1, word out ?
  18B5'   20 0C                 	jr	nz,codgen3
  18B7'   FD 7E FB              	ld	a,(iy-5)
  18BA'   E5                    	push	hl
  18BB'   CD 0000*              	call	putobj
  18BE'   FD 7E FC              	ld	a,(iy-4)
  18C1'   18 17                 	jr	codgen5
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-64
Rev 1.01  08/30/1984

  18C3'                         codgen3:
  18C3'   FE BA                 	cp	opr2b		;operand 2, byte out ?
  18C5'   20 05                 	jr	nz,codgen4
  18C7'   FD 7E FE              	ld	a,(iy-2)
  18CA'   18 49                 	jr	codgen7
  18CC'                         codgen4:
  18CC'   FE BB                 	cp	low opr2w	;operand 2, word out ?
  18CE'   20 1B                 	jr	nz,codgen6
  18D0'   FD 7E FE              	ld	a,(iy-2)
  18D3'   E5                    	push	hl
  18D4'   CD 0000*              	call	putobj
  18D7'   FD 7E FF              	ld	a,(iy-1)
  18DA'                         codgen5:
  18DA'   CD 0000*              	call	putobj
  18DD'   2A 000C"              	ld	hl,(cloc)
  18E0'   23                    	inc	hl
  18E1'   23                    	inc	hl
  18E2'   22 000C"              	ld	(cloc),hl	;cloc := cloc + 2
  18E5'   E1                    	pop	hl
  18E6'   23                    	inc	hl
  18E7'   C1                    	pop	bc
  18E8'   05                    	dec	b
  18E9'   18 30                 	jr	codgen8
  18EB'                         codgen6:
  18EB'   FE CD                 	cp	0cdh		;call ?
  18ED'   20 26                 	jr	nz,codgen7
  18EF'   E5                    	push	hl
  18F0'   CD 0000*              	call	putobj
  18F3'   E1                    	pop	hl
  18F4'   23                    	inc	hl
  18F5'   5E                    	ld	e,(hl)
  18F6'   23                    	inc	hl
  18F7'   56                    	ld	d,(hl)
  18F8'   E5                    	push	hl
  18F9'   2A 0006"              	ld	hl,(codorg)
  18FC'   19                    	add	hl,de		;add bias to call addres
  18FD'   E5                    	push	hl
  18FE'   7D                    	ld	a,l
  18FF'   CD 0000*              	call	putobj		;put call hi-address
  1902'   F1                    	pop	af
  1903'   CD 0000*              	call	putobj		;put call low-address
  1906'   2A 000C"              	ld	hl,(cloc)
  1909'   23                    	inc	hl
  190A'   23                    	inc	hl
  190B'   23                    	inc	hl
  190C'   22 000C"              	ld	(cloc),hl	;cloc := cloc + 3
  190F'   E1                    	pop	hl
  1910'   C1                    	pop	bc
  1911'   05                    	dec	b
  1912'   05                    	dec	b
  1913'   18 06                 	jr	codgen8
  1915'                         codgen7:
  1915'   E5                    	push	hl
  1916'   CD 1959'              	call	ptcodx		;code out
  1919'   E1                    	pop	hl
  191A'   C1                    	pop	bc
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-65
Rev 1.01  08/30/1984

  191B'                         codgen8:
  191B'   10 8A                 	djnz	codgen1
  191D'   FD 36 FA 00           	ld	(iy-6),0
  1921'   3E FF                 	ld	a,0ffh
  1923'   32 003A"              	ld	(puhptf),a
  1926'   CD 1856'              	call	decopt		; iy := iy - 3 : dec(optble)
  1929'   B7                    	or	a		; cy := 0
  192A'   C9                    	ret
                                ;
  192B'                         codgen10:
  192B'   CD 1856'              	call	decopt		; iy := iy - 3 : dec(optble)
  192E'   37                    	scf
  192F'   C9                    	ret
                                ;
  1930'                         codgen15:
  1930'   ED 44                 	neg
  1932'   47                    	ld	b,a
  1933'   3A 003A"              	ld	a,(puhptf)
  1936'   B7                    	or	a
  1937'   78                    	ld	a,b
  1938'   C8                    	ret	z
  1939'   3C                    	inc	a
  193A'   C5                    	push	bc
  193B'   E5                    	push	hl
  193C'   CD 1959'              	call	ptcodx		;put code length
  193F'   E1                    	pop	hl
  1940'   C1                    	pop	bc
  1941'   3E F5                 	ld	a,0f5h		;"  PUSH  AF  "
  1943'   C9                    	ret
                                ;
                                ;	**  put  "  PUSH  AF  " code  **
                                ;
  1944'                         pacod::
  1944'   3A 003A"              	ld	a,(puhptf)
  1947'   B7                    	or	a
  1948'   3E F5                 	ld	a,0f5h		;"  PUSH  AF  "
  194A'   C2 1953'              	jp	nz,ptcod1
  194D'   3E FF                 	ld	a,0ffh
  194F'   32 003A"              	ld	(puhptf),a
  1952'   C9                    	ret
                                ;
                                ;	**  put object code  (1..3 byte )  **
                                ;
  1953'                         ptcod1::	; 1 byte out  ( reg a )
  1953'   F5                    	push	af
  1954'   AF                    	xor	a
  1955'   CD 0000*              	call	putobj		;code length 1 byte
  1958'   F1                    	pop	af
  1959'                         ptcodx:
  1959'   CD 0000*              	call	putobj		;put reg a
  195C'   2A 000C"              	ld	hl,(cloc)
  195F'   23                    	inc	hl
  1960'   22 000C"              	ld	(cloc),hl
  1963'   C9                    	ret
                                ;
  1964'                         ptcod2::	; 2 byte out	( reg d, e )
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-66
Rev 1.01  08/30/1984

  1964'   63                    	ld	h,e
  1965'   6A                    	ld	l,d
                                ;
  1966'                         ptcodw:		; word out  ( reg l,h )
  1966'   E5                    	push	hl
  1967'   3E 02                 	ld	a,2
  1969'   CD 0000*              	call	putobj		;code length 2 byte
  196C'   18 0B                 	jr	ptcody
                                ;
  196E'                         ptcod3:		; 3 byte out ( reg a, l, h )
  196E'   E5                    	push	hl
  196F'   F5                    	push	af
  1970'   3E 03                 	ld	a,3
  1972'   CD 0000*              	call	putobj		;code length 3 byte
  1975'   F1                    	pop	af
  1976'   CD 1959'              	call	ptcodx
  1979'                         ptcody:
  1979'   E1                    	pop	hl
  197A'   7D                    	ld	a,l
  197B'   E5                    	push	hl
  197C'   CD 0000*              	call	putobj		;put reg 1
  197F'   F1                    	pop	af
  1980'   CD 0000*              	call	putobj		;put reg h
  1983'   2A 000C"              	ld	hl,(cloc)
  1986'   23                    	inc	hl
  1987'   23                    	inc	hl
  1988'   22 000C"              	ld	(cloc),hl
  198B'   C9                    	ret
                                ;
                                ;	**  move identifier to anme adra  **
                                ;
  198C'                         movname::
  198C'   21 0017"              	ld	hl,identi
  198F'   11 0026"              	ld	de,strbuf
  1992'   06 0C                 	ld	b,adrs-identi
  1994'                         movnam1:
  1994'   7E                    	ld	a,(hl)
  1995'   12                    	ld	(de),a
  1996'   B7                    	or	a
  1997'   C8                    	ret	z
  1998'   23                    	inc	hl
  1999'   13                    	inc	de
  199A'   10 F8                 	djnz	movnam1
  199C'   78                    	ld	a,b
  199D'   12                    	ld	(de),a
  199E'   C9                    	ret
                                ;
                                ;	**  put name  **
                                ;
  199F'                         ptname::  ;	a : name type ( 56h...5ah )
  199F'   CD 0000*              	call	putobj
  19A2'   21 0026"              	ld	hl,strbuf
  19A5'                         ptname1:
  19A5'   7E                    	ld	a,(hl)
  19A6'   B7                    	or	a
  19A7'   CA 0000*              	jp	z,putobj
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-67
Rev 1.01  08/30/1984

  19AA'   E5                    	push	hl
  19AB'   CD 0000*              	call	putobj
  19AE'   E1                    	pop	hl
  19AF'   23                    	inc	hl
  19B0'   18 F3                 	jr	ptname1
                                ;
                                ;	**  put location count  **
                                ;
  19B2'                         ptloc::
  19B2'   E5                    	push	hl
  19B3'   3E 80                 	ld	a,80h
  19B5'   18 03                 	jr	ptcha1
                                ;
                                ;	**  put chain address  **
                                ;
  19B7'                         ptcha::
  19B7'   E5                    	push	hl
  19B8'   3E 81                 	ld	a,81h
  19BA'                         ptcha1:
  19BA'   CD 0000*              	call	putobj		;chain
  19BD'   E1                    	pop	hl
  19BE'   7D                    	ld	a,l
  19BF'   E5                    	push	hl
  19C0'   CD 0000*              	call	putobj		;put reg l
  19C3'   F1                    	pop	af
  19C4'   C3 0000*              	jp	putobj		;put reg h
                                ;
                                ;	**  constant expression  **
                                ;
  19C7'                         conexp::
  19C7'   CD 1A01'              	call	wodcon
  19CA'                         conexp1:
  19CA'   3A 0036"              	ld	a,(tokcod)
  19CD'   FE 2B                 	cp	'+'
  19CF'   28 11                 	jr	z,conexp2
  19D1'   FE 2D                 	cp	'-'
  19D3'   C0                    	ret	nz
  19D4'   E5                    	push	hl
  19D5'   CD 1B0F'              	call	gtoken
  19D8'   CD 1A01'              	call	wodcon		;word constant
  19DB'   EB                    	ex	de,hl
  19DC'   E1                    	pop	hl
  19DD'   B7                    	or	a
  19DE'   ED 52                 	sbc	hl,de		; subtract
  19E0'   18 E8                 	jr	conexp1
  19E2'                         conexp2:
  19E2'   E5                    	push	hl
  19E3'   CD 1B0F'              	call	gtoken
  19E6'   CD 1A01'              	call	wodcon		;wrod constant
  19E9'   D1                    	pop	de
  19EA'   19                    	add	hl,de
  19EB'   18 DD                 	jr	conexp1		;
                                ;
                                ;	** byte constant  **
                                ;
  19ED'                         bytcon::
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-68
Rev 1.01  08/30/1984

  19ED'   21 0038"              	ld	hl,datinl
  19F0'   7E                    	ld	a,(hl)
  19F1'   F5                    	push	af
  19F2'   36 00                 	ld	(hl),0
  19F4'   CD 1A01'              	call	wodcon
  19F7'   F1                    	pop	af
  19F8'   32 0038"              	ld	(datinl),a
  19FB'   7C                    	ld	a,h
  19FC'   B7                    	or	a
  19FD'   C2 1FAB'              	jp	nz,ilcnor	;error : illegal constant
  1A00'   C9                    	ret
                                ;
                                ;	**  word constant  **
                                ;
  1A01'                         wodcon::
  1A01'   21 0038"              	ld	hl,datinl
  1A04'   46                    	ld	b,(hl)
  1A05'   3A 0036"              	ld	a,(tokcod)
  1A08'   FE BB                 	cp	0bbh		;'hi' ?
  1A0A'   28 07                 	jr	z,bytcon1
  1A0C'   FE BC                 	cp	0bch		;'low' ?
  1A0E'   28 0F                 	jr	z,bytcon2
  1A10'   C3 1A2F'              	jp	wodcon0
  1A13'                         bytcon1:
  1A13'   C5                    	push	bc
  1A14'   36 00                 	ld	(hl),0
  1A16'   CD 1B0F'              	call	gtoken
  1A19'   CD 1A2F'              	call	wodcon0
  1A1C'   6C                    	ld	l,h
  1A1D'   18 09                 	jr	bytcon3
  1A1F'                         bytcon2:
  1A1F'   C5                    	push	bc
  1A20'   36 00                 	ld	(hl),0
  1A22'   CD 1B0F'              	call	gtoken
  1A25'   CD 1A2F'              	call	wodcon0
  1A28'                         bytcon3:
  1A28'   F1                    	pop	af
  1A29'   32 0038"              	ld	(datinl),a
  1A2C'   26 00                 	ld	h,0
  1A2E'   C9                    	ret
                                ;
  1A2F'                         wodcon0:
  1A2F'   3A 0036"              	ld	a,(tokcod)
  1A32'   B7                    	or	a
  1A33'   20 05                 	jr	nz,wodcon1
  1A35'   2A 0012"              	ld	hl,(conval)
  1A38'   18 43                 	jr	wodcon5
  1A3A'                         wodcon1:
  1A3A'   3D                    	dec	a
  1A3B'   20 15                 	jr	nz,wodcon2
  1A3D'   21 0016"              	ld	hl,idetyp
  1A40'   CD 0000*              	call	seasym		;search symbol table
  1A43'   B7                    	or	a		;found ?
  1A44'   C4 1E86'              	call	nz,miscon
  1A47'   3A 0016"              	ld	a,(idetyp)
  1A4A'   E6 0F                 	and	0fh
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-69
Rev 1.01  08/30/1984

  1A4C'   3D                    	dec	a		;constant name ?
  1A4D'   C2 1FDE'              	jp	nz,badcon
  1A50'   18 28                 	jr	wodcon4
  1A52'                         wodcon2:
  1A52'   FE 2D                 	cp	'.'-1
  1A54'   C2 1FDE'              	jp	nz,badcon
  1A57'   CD 1B0F'              	call	gtoken		;get next token
  1A5A'   3D                    	dec	a
  1A5B'   C2 1FF2'              	jp	nz,conerr
  1A5E'   21 0016"              	ld	hl,idetyp
  1A61'   CD 0000*              	call	seasym		;search symbol table
  1A64'   B7                    	or	a		;found ?
  1A65'   20 49                 	jr	nz,wodcon8
  1A67'   3A 0016"              	ld	a,(idetyp)	
  1A6A'   E6 0F                 	and	0fh
  1A6C'   3D                    	dec	a		;constant name ?
  1A6D'   CA 1FF2'              	jp	z,conerr	;error if so
  1A70'   3D                    	dec	a		;variable name ?
  1A71'   28 07                 	jr	z,wodcon4
  1A73'   3D                    	dec	a		;data name ?
  1A74'   28 04                 	jr	z,wodcon4
  1A76'   D6 05                 	sub	5		;table or function name ?
  1A78'   30 09                 	jr	nc,wodcon6
  1A7A'                         wodcon4:
  1A7A'   2A 0023"              	ld	hl,(adrs)
  1A7D'                         wodcon5:
  1A7D'   E5                    	push	hl
  1A7E'   CD 1B0F'              	call	gtoken
  1A81'   E1                    	pop	hl
  1A82'   C9                    	ret
  1A83'                         wodcon6:
  1A83'   3A 0038"              	ld	a,(datinl)
  1A86'   B7                    	or	a		;data or inline ?
  1A87'   CA 1FF2'              	jp	z,conerr	;error if not
  1A8A'   ED 5B 0023"           	ld	de,(adrs)
  1A8E'   3A 0016"              	ld	a,(idetyp)
  1A91'   4F                    	ld	c,a
  1A92'   E6 0F                 	and	0fh
  1A94'   FE 09                 	cp	9		;function name ?
  1A96'   38 0C                 	jr	c,wodcon7
  1A98'   CD 1AD6'              	call	funchk		;function ?
  1A9B'   D2 1FF2'              	jp	nc,conerr	;error if label
  1A9E'   CB 79                 	bit 	7,c
  1AA0'   20 24                 	jr	nz,wodcon9
  1AA2'   18 D6                 	jr	wodcon4
  1AA4'                         wodcon7:
  1AA4'   CD 1AD6'              	call	funchk		;label ?
  1AA7'   DA 1FF2'              	jp	c,conerr	;error if function
  1AAA'   CB 79                 	bit	7,c
  1AAC'   20 18                 	jr	nz,wodcon9
  1AAE'   18 CA                 	jr	wodcon4
  1AB0'                         wodcon8:
  1AB0'   3A 0038"              	ld	a,(datinl)
  1AB3'   B7                    	or	a		;data or inline ?
  1AB4'   CA 1FF2'              	jp	z,conerr	;error if not
  1AB7'   11 0000               	ld	de,0
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-70
Rev 1.01  08/30/1984

  1ABA'   CD 1AD6'              	call	funchk		;function ?
  1ABD'   3E 98                 	ld	a,98h		;undefined label
  1ABF'   30 02                 	jr	nc,$+4
  1AC1'   3E 89                 	  ld	a,89h		;undefined function
  1AC3'   32 0016"              	ld	(idetyp),a	;set type
  1AC6'                         wodcon9:
  1AC6'   2A 000C"              	ld	hl,(cloc)
  1AC9'   22 0023"              	ld	(adrs),hl
  1ACC'   D5                    	push	de
  1ACD'   21 0016"              	ld	hl,idetyp
  1AD0'   CD 0000*              	call	regsym		;symbol table register
  1AD3'   E1                    	pop	hl
  1AD4'   18 A7                 	jr	wodcon5
                                ;
  1AD6'                         funchk:
  1AD6'   2A 0000"              	ld	hl,(cptr)
  1AD9'   CD 1DBE'              	call	spskip		;space skip
  1ADC'   28 13                 	jr	z,funchk1	;end of line ?
  1ADE'   FE 28                 	cp	'('
  1AE0'   20 0F                 	jr	nz,funchk1
  1AE2'   CD 1DC8'              	call	nxspsk		;space skip
  1AE5'   28 0A                 	jr	z,funchk1	;end of line ?
  1AE7'   FE 29                 	cp	')'
  1AE9'   20 06                 	jr	nz,funchk1
  1AEB'   23                    	inc	hl
  1AEC'   22 0000"              	ld	(cptr),hl
  1AEF'   37                    	scf			; cy := 1
  1AF0'   C9                    	ret
  1AF1'                         funchk1:
  1AF1'   B7                    	or	a		; cy := 0
  1AF2'   C9                    	ret
                                ;
                                ;	**  block push  **
                                ;
  1AF3'                         blkpsh:: ;	bc: push size
                                	 ;	hl: source address
  1AF3'   DD E1                 	pop	ix
  1AF5'   EB                    	ex	de,hl
  1AF6'   21 0000               	ld	hl,0
  1AF9'   39                    	add	hl,sp
  1AFA'   B7                    	or	a
  1AFB'   ED 42                 	sbc	hl,bc
  1AFD'   F9                    	ld	sp,hl
  1AFE'   EB                    	ex	de,hl
  1AFF'   ED B0                 	ldir			;push
  1B01'   DD E9                 	jp	(ix)
                                ;
                                ;	**  block pop  **
                                ;
  1B03'                         blkpop:: ;	bc: pop size
                                	 ;	hl: source address
  1B03'   DD E1                 	pop	ix
  1B05'   EB                    	ex	de,hl
  1B06'   21 0000               	ld	hl,0
  1B09'   39                    	add	hl,sp
  1B0A'   ED B0                 	ldir			;pop
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-71
Rev 1.01  08/30/1984

  1B0C'   F9                    	ld	sp,hl
  1B0D'   DD E9                 	jp	(ix)
                                ;
                                ;	**  get next token  **
                                ;
  1B0F'                         gtoken::
  1B0F'   3A 0036"              	ld	a,(tokcod)
  1B12'   FE FF                 	cp	0ffh		;end ?
  1B14'   C8                    	ret	z		;return if so
                                ;
  1B15'   2A 0000"              	ld	hl,(cptr)
  1B18'                         gtoken0:
  1B18'   CD 1DBE'              	call	spskip
  1B1B'   20 22                 	jr	nz,gtoken3
  1B1D'                         gtoken1:
  1B1D'   CD 0000*              	call	getsou		;get source program ( 1 line )
  1B20'   30 0A                 	jr	nc,gtoken2
  1B22'                         gtoken1.5:
  1B22'   CD 0000*              	call	edincl		;end check
  1B25'   38 F1                 	jr	c,gtoken0
  1B27'   3E FF                 	ld	a,0ffh		;a = 0ffh : end of program
  1B29'   C3 1C4B'              	jp	gtoken33
  1B2C'                         gtoken2:
  1B2C'   ED 53 0002"           	ld	(lino),de
  1B30'   E5                    	push	hl
  1B31'   EB                    	ex	de,hl
  1B32'   3A 0005"              	ld	a,(stmflg)
  1B35'   B7                    	or	a
  1B36'   C4 0000*              	call	nz,ddspli	;line number display object out
  1B39'   E1                    	pop	hl
  1B3A'   CD 1DBE'              	call	spskip		;space skip
  1B3D'   28 DE                 	jr	z,gtoken1
  1B3F'                         gtoken3:
  1B3F'   FE 2F                 	cp	'/'
  1B41'   20 10                 	jr	nz,gtoken3.5
  1B43'   23                    	inc	hl
  1B44'   7E                    	ld	a,(hl)
  1B45'   2B                    	dec	hl
  1B46'   FE 2A                 	cp	'*'		;'/*' ?
  1B48'   7E                    	ld	a,(hl)
  1B49'   20 08                 	jr	nz,gtoken3.5
  1B4B'   23                    	inc	hl
  1B4C'   CD 1D92'              	call	coment		;comment skip
  1B4F'   38 D1                 	jr	c,gtoken1.5
  1B51'   18 C5                 	jr	gtoken0
  1B53'                         gtoken3.5:
  1B53'   22 0014"              	ld	(eptr),hl
  1B56'   EB                    	ex	de,hl
                                ;
                                ;  constant  ( decimal , hexadecimal & character )
                                ;
  1B57'   CD 1DCB'              	call	numtst		;numeric ?
  1B5A'   38 05                 	jr	c,gtoken4	;skip if not
  1B5C'   CD 1DF2'              	call	decbin		;convert decimal string into binary value
  1B5F'   18 3D                 	jr	gtoken7
  1B61'                         gtoken4:
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-72
Rev 1.01  08/30/1984

  1B61'   FE 24                 	cp	'$'
  1B63'   20 11                 	jr	nz,gtoken6
  1B65'   13                    	inc	de
  1B66'   1A                    	ld	a,(de)
  1B67'   CD 1DD2'              	call	hextst		;hexadecimal ?
  1B6A'   38 05                 	jr	c,gtoken5	;skip if not
  1B6C'   CD 1E2A'              	call	hexbin		;convert hex string into binary value
  1B6F'   18 2D                 	jr	gtoken7
  1B71'                         gtoken5:
  1B71'   2A 000C"              	ld	hl,(cloc)	;load code location counter
  1B74'   18 28                 	jr	gtoken7
  1B76'                         gtoken6:
  1B76'   FE 27                 	cp	''''
  1B78'   20 2B                 	jr	nz,gtoken10
  1B7A'   26 00                 	ld	h,0
  1B7C'   13                    	inc	de
  1B7D'   1A                    	ld	a,(de)
  1B7E'   B7                    	or	a
  1B7F'   28 0A                 	jr	z,ccher1
  1B81'   6F                    	ld	l,a		;load character coustant
  1B82'   13                    	inc	de
  1B83'   1A                    	ld	a,(de)
  1B84'   FE 27                 	cp	''''
  1B86'   20 0E                 	jr	nz,ccher2
  1B88'   13                    	inc	de
  1B89'   18 13                 	jr	gtoken7
  1B8B'                         ccher1:
  1B8B'   21 0027               	ld	hl,''''
  1B8E'   22 0026"              	ld	(strbuf),hl
  1B91'   21 0020               	ld	hl,' '
  1B94'   18 08                 	jr	gtoken7
  1B96'                         ccher2:
  1B96'   22 0027"              	ld	(strbuf+1),hl
  1B99'   3E 27                 	ld	a,''''
  1B9B'   32 0026"              	ld	(strbuf),a
  1B9E'                         gtoken7:
  1B9E'   AF                    	xor	a		; a = 0 : constant
  1B9F'   22 0012"              	ld	(conval),hl
  1BA2'   C3 1C44'              	jp	gtoken31.5
                                ;
                                ;  reserved word & identifier
                                ;
  1BA5'                         gtoken10:
  1BA5'   FE 5F                 	cp	'_'
  1BA7'   28 05                 	jr	z,$+7
  1BA9'   CD 1DE4'              	  call	lettst		;letter ?
  1BAC'   38 51                 	  jr	c,gtoken25	;skip if not
  1BAE'   21 0017"              	ld	hl,identi
  1BB1'   06 0C                 	ld	b,adrs-identi
  1BB3'                         gtoken11:
  1BB3'   77                    	ld	(hl),a		;store identifier area
  1BB4'   23                    	inc	hl
  1BB5'                         gtoken12:
  1BB5'   13                    	inc	de
  1BB6'   1A                    	ld	a,(de)
  1BB7'   CD 1DCB'              	call	numtst		;numeric ?
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-73
Rev 1.01  08/30/1984

  1BBA'   30 09                 	jr	nc,gtoken13
  1BBC'   CD 1DE4'              	call	lettst		;letter ?
  1BBF'   30 04                 	jr	nc,gtoken13
  1BC1'   FE 5F                 	cp	'_'		;'_' ?
  1BC3'   20 06                 	jr	nz,gtoken14	;skip if not
  1BC5'                         gtoken13:
  1BC5'   10 EC                 	djnz	gtoken11
  1BC7'   06 01                 	ld	b,1
  1BC9'   18 EA                 	jr	gtoken12
  1BCB'                         gtoken14:
  1BCB'   36 00                 	ld	(hl),0		;store end of string mark
  1BCD'   ED 53 0000"           	ld	(cptr),de
                                ;
                                ;  search reserved word
                                ;
  1BD1'   11 1C58'              	ld	de,rsword
  1BD4'                         gtoken15:
  1BD4'   21 0017"              	ld	hl,identi
  1BD7'                         gtoken16:
  1BD7'   1A                    	ld	a,(de)
  1BD8'   B7                    	or	a
  1BD9'   FA 1BEA'              	jp	m,gtoken17
  1BDC'   28 1D                 	jr	z,gtoken20
  1BDE'   4F                    	ld	c,a
  1BDF'   7E                    	ld	a,(hl)
  1BE0'   CD 1DB5'              	call	traupc		;translate to upper case
  1BE3'   B9                    	cp	c
  1BE4'   20 0C                 	jr	nz,gtoken18
  1BE6'   13                    	inc	de
  1BE7'   23                    	inc	hl
  1BE8'   18 ED                 	jr	gtoken16
  1BEA'                         gtoken17:
  1BEA'   7E                    	ld	a,(hl)
  1BEB'   B7                    	or	a
  1BEC'   20 0A                 	jr	nz,gtoken19
  1BEE'   1A                    	ld	a,(de)		;a = reserved word No.
  1BEF'   C3 1C4B'              	jp	gtoken33
  1BF2'                         gtoken18:
  1BF2'   13                    	inc	de
  1BF3'   1A                    	ld	a,(de)
  1BF4'   B7                    	or	a
  1BF5'   F2 1BF2'              	jp	p,gtoken18
  1BF8'                         gtoken19:
  1BF8'   13                    	inc	de
  1BF9'   18 D9                 	jr	gtoken15
  1BFB'                         gtoken20:
  1BFB'   3E 01                 	ld	a,1		; a = 1 : identifier
  1BFD'   18 4C                 	jr	gtoken33
                                ;
                                ;  search special character ( delimiter,operation, ... )
                                ;
  1BFF'                         gtoken25:
  1BFF'   21 1D77'              	ld	hl,specha
  1C02'   01 001B               	ld	bc,speche-specha
  1C05'   ED B1                 	cpir			;search
  1C07'   20 46                 	jr	nz,gtoken35
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-74
Rev 1.01  08/30/1984

  1C09'   4F                    	ld	c,a
  1C0A'   13                    	inc	de
  1C0B'   ED 53 0000"           	ld	(cptr),de
                                ;
  1C0F'   FE 3A                 	cp	':'
  1C11'   20 07                 	jr	nz,gtoken27
  1C13'   1A                    	ld	a,(de)
  1C14'   FE 3D                 	cp	'='		;':=' ?
  1C16'   3E F0                 	ld	a,0f0h
  1C18'   18 27                 	jr	gtoken30
  1C1A'                         gtoken27:
  1C1A'   FE 3C                 	cp	'<'
  1C1C'   20 0B                 	jr	nz,gtoken28
  1C1E'   1A                    	ld	a,(de)
  1C1F'   D6 3C                 	sub	'<'		;'<<' or '<=' or '<>'
  1C21'   FE 03                 	cp	3
  1C23'   30 25                 	jr	nc,gtoken32
  1C25'   C6 F1                 	add	a,0f1h
  1C27'   18 1A                 	jr	gtoken31
  1C29'                         gtoken28:
  1C29'   FE 3E                 	cp	'>'
  1C2B'   20 0B                 	jr	nz,gtoken29
  1C2D'   1A                    	ld	a,(de)
  1C2E'   D6 3D                 	sub	'='		;'>=' or '>>'
  1C30'   FE 02                 	cp	2
  1C32'   30 16                 	jr	nc,gtoken32
  1C34'   C6 F4                 	add	a,0f4h
  1C36'   18 0B                 	jr	gtoken31
  1C38'                         gtoken29:
  1C38'   FE 40                 	cp	'@'
  1C3A'   20 0E                 	jr	nz,gtoken32
  1C3C'   1A                    	ld	a,(de)
  1C3D'   FE 40                 	cp	'@'		;'@@' ?
  1C3F'   3E F6                 	ld	a,0f6h
  1C41'                         gtoken30:
  1C41'   20 07                 	jr	nz,gtoken32
  1C43'                         gtoken31:
  1C43'   13                    	inc	de
  1C44'                         gtoken31.5:
  1C44'   ED 53 0000"           	ld	(cptr),de
  1C48'   18 01                 	jr	gtoken33
  1C4A'                         gtoken32:
  1C4A'   79                    	ld	a,c
  1C4B'                         gtoken33:
  1C4B'   32 0036"              	ld	(tokcod),a
  1C4E'   C9                    	ret
                                ;
  1C4F'                         gtoken35:
  1C4F'   6F                    	ld	l,a
  1C50'   26 00                 	ld	h,0
  1C52'   22 0026"              	ld	(strbuf),hl
  1C55'   C3 1F79'              	jp	illchr
                                ;
                                ;	<<  reserved word  >>
                                ;
  1C58'                         rsword::
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-75
Rev 1.01  08/30/1984

  1C58'   41 4E 44 A8           	defb	'AND',		0a8h
  1C5C'   41 54 BE              	defb	'AT',		0beh
  1C5F'   42 52 45 41           	defb	'BREAK',	08bh
  1C63'   4B 8B                 
  1C65'   42 59 9A              	defb	'BY',		09ah
  1C68'   42 59 54 45           	defb	'BYTE',		091h
  1C6C'   91                    
  1C6D'   43 41 52 52           	defb	'CARRY',	0b4h
  1C71'   59 B4                 
  1C73'   43 4F 4E 53           	defb	'CONS',		08ch
  1C77'   8C                    
  1C78'   44 41 54 41           	defb	'DATA',		08eh
  1C7C'   8E                    
  1C7D'   44 45 43 AD           	defb	'DEC',		0adh
  1C81'   44 45 43 4A           	defb	'DECJ',		0b3h
  1C85'   B3                    
  1C86'   44 45 58 A5           	defb	'DEX',		0a5h
  1C8A'   44 45 42 55           	defb	'DEBUG',	084h
  1C8E'   47 84                 
  1C90'   45 4C 53 45           	defb	'ELSE',		095h
  1C94'   95                    
  1C95'   45 4C 53 45           	defb	'ELSEIF',	0bdh
  1C99'   49 46 BD              
  1C9C'   45 58 49 54           	defb	'EXIT',		09eh
  1CA0'   9E                    
  1CA1'   46 4F 52 98           	defb	'FOR',		098h
  1CA5'   47 4F 9C              	defb	'GO',		09ch
  1CA8'   47 4F 54 4F           	defb	'GOTO',		09dh
  1CAC'   9D                    
  1CAD'   48 49 BB              	defb	'HI',		0bbh
  1CB0'   49 46 93              	defb	'IF',		093h
  1CB3'   49 4E 43 AC           	defb	'INC',		0ach
  1CB7'   49 4E 43 4C           	defb	'INCLUDE',	081h
  1CBB'   55 44 45 81           
  1CBF'   49 4E 4C 49           	defb	'INLINE',	090h
  1CC3'   4E 45 90              
  1CC6'   49 4E 58 A4           	defb	'INX',		0a4h
  1CCA'   49 58 BF              	defb	'IX',		0bfh
  1CCD'   49 59 C0              	defb	'IY',		0c0h
  1CD0'   4C 44 58 A2           	defb	'LDX',		0a2h
  1CD4'   4C 4F 4F 50           	defb	'LOOP',		09bh
  1CD8'   9B                    
  1CD9'   4C 4F 57 BC           	defb	'LOW',		0bch
  1CDD'   4D 45 4D 4F           	defb	'MEMORY',	0b9h
  1CE1'   52 59 B9              
  1CE4'   4D 49 4E 55           	defb	'MINUS',	0abh
  1CE8'   53 AB                 
  1CEA'   4E 4F 54 A9           	defb	'NOT',		0a9h
  1CEE'   4F 52 A7              	defb	'OR',		0a7h
  1CF1'   4F 56 45 52           	defb	'OVERFLOW',	0b8h
  1CF5'   46 4C 4F 57           
  1CF9'   B8                    
  1CFA'   50 41 52 49           	defb	'PARITY',	0b7h
  1CFE'   54 59 B7              
  1D01'   50 4C 55 53           	defb	'PLUS',		0aah
  1D05'   AA                    
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-76
Rev 1.01  08/30/1984

  1D06'   50 4F 52 54           	defb	'PORT',		0bah
  1D0A'   BA                    
  1D0B'   50 52 4F 47           	defb	'PROG',		080h
  1D0F'   80                    
  1D10'   52 45 43 55           	defb	'RECURSIVE',	08fh
  1D14'   52 53 49 56           
  1D18'   45 8F                 
  1D1A'   52 45 54 55           	defb	'RETURN',	09fh
  1D1E'   52 4E 9F              
  1D21'   52 4C AE              	defb	'RL',		0aeh
  1D24'   52 4C 43 AF           	defb	'RLC',		0afh
  1D28'   52 52 B0              	defb	'RR',		0b0h
  1D2B'   52 52 43 B1           	defb	'RRC',		0b1h
  1D2F'   53 45 54 A1           	defb	'SET',		0a1h
  1D33'   53 49 47 4E           	defb	'SIGN',		0b6h
  1D37'   B6                    
  1D38'   53 52 41 B2           	defb	'SRA',		0b2h
  1D3C'   53 54 4F 50           	defb	'STOP',		0a0h
  1D40'   A0                    
  1D41'   53 54 58 A3           	defb	'STX',		0a3h
  1D45'   54 48 45 4E           	defb	'THEN',		094h
  1D49'   94                    
  1D4A'   54 4F 99              	defb	'TO',		099h
  1D4D'   54 52 4F 46           	defb	'TROFF',	086h
  1D51'   46 86                 
  1D53'   54 52 4F 4E           	defb	'TRON',		085h
  1D57'   85                    
  1D58'   55 4E 54 49           	defb	'UNTIL',	097h
  1D5C'   4C 97                 
  1D5E'   56 41 52 8D           	defb	'VAR',		08dh
  1D62'   57 48 49 4C           	defb	'WHILE',	096h
  1D66'   45 96                 
  1D68'   57 4F 52 44           	defb	'WORD',		092h
  1D6C'   92                    
  1D6D'   58 4F 52 A6           	defb	'XOR',		0a6h
  1D71'   5A 45 52 4F           	defb	'ZERO',		0b5h
  1D75'   B5                    
  1D76'   00                    	defb	0
                                ;
                                ;	<<  special character  >>
                                ;
  1D77'                         specha::
  1D77'   21 22 23 25           	defb	'!"#%&()*+,-./:;'
  1D7B'   26 28 29 2A           
  1D7F'   2B 2C 2D 2E           
  1D83'   2F 3A 3B              
  1D86'   3C 3D 3E 3F           	defb	'<=>?@[]^{|}~'
  1D8A'   40 5B 5D 5E           
  1D8E'   7B 7C 7D 7E           
  1D92'                         speche	equ	$
                                ;
                                ;	**  comment skip  **
                                ;
  1D92'                         coment::
  1D92'   23                    	inc	hl
  1D93'                         coment1:
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-77
Rev 1.01  08/30/1984

  1D93'   7E                    	ld	a,(hl)
  1D94'   B7                    	or	a
  1D95'   28 14                 	jr	z,coment2
  1D97'   FE 2A                 	cp	'*'
  1D99'   20 F7                 	jr	nz,coment
  1D9B'   23                    	inc	hl
  1D9C'   7E                    	ld	a,(hl)
  1D9D'   B7                    	or	a
  1D9E'   28 0B                 	jr	z,coment2
  1DA0'   FE 2A                 	cp	'*'
  1DA2'   28 EF                 	jr	z,coment1
  1DA4'   FE 2F                 	cp	'/'
  1DA6'   20 EA                 	jr	nz,coment
  1DA8'   B7                    	or	a		;cy := 0
  1DA9'   23                    	inc	hl
  1DAA'   C9                    	ret
  1DAB'                         coment2:
  1DAB'   CD 0000*              	call	getsou		;get source program
  1DAE'   D8                    	ret	c		;return if cy = 1
  1DAF'   ED 53 0002"           	ld	(lino),de
  1DB3'   18 DE                 	jr	coment1
                                ;
                                ;	**  translate to upper case  **
                                ;
  1DB5'                         traupc:: ;	a: character
  1DB5'   FE 61                 	cp	'a'
  1DB7'   D8                    	ret	c
  1DB8'   FE 7B                 	cp	'z'+1
  1DBA'   D0                    	ret	nc
  1DBB'   D6 20                 	sub	20h
  1DBD'   C9                    	ret
                                ;
                                ;	**  space skip  **
                                ;
  1DBE'                         spskip:: ;	hl : string address
  1DBE'   7E                    	ld	a,(hl)
  1DBF'   B7                    	or	a		;end of line ?
  1DC0'   C8                    	ret	z		;return if so ( eol : z=1 )
  1DC1'   FE 09                 	cp	09h		;tab code ?
  1DC3'   28 03                 	jr	z,nxspsk	;skip if so
  1DC5'   FE 20                 	cp	' '		;space ?
  1DC7'   C0                    	ret	nz		;return if not ( non space : z=0 )
  1DC8'                         nxspsk::
  1DC8'   23                    	inc	hl
  1DC9'   18 F3                 	jr	spskip
                                ;
                                ;	**  numeric test  **
                                ;
  1DCB'                         numtst:: ;	a : character
  1DCB'   FE 30                 	cp	'0'
  1DCD'   D8                    	ret	c
  1DCE'   FE 3A                 	cp	'9'+1
  1DD0'   3F                    	ccf			; cy = 1 : non numeric
  1DD1'   C9                    	ret			; cy = 0 : numeric
  1DD2'                         hextst:: ;	a : character
  1DD2'   CD 1DCB'              	call	numtst
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-78
Rev 1.01  08/30/1984

  1DD5'   D0                    	ret	nc
  1DD6'   FE 41                 	cp	'A'
  1DD8'   D8                    	ret	c
  1DD9'   FE 47                 	cp	'F'+1
  1DDB'   3F                    	ccf
  1DDC'   D0                    	ret	nc
  1DDD'   FE 61                 	cp	'a'
  1DDF'   D8                    	ret	c
  1DE0'   FE 67                 	cp	'f'+1
  1DE2'   3F                    	ccf			; cy = 1 : non hexadecimal
  1DE3'   C9                    	ret			; cy = 0 : hexadecimal
                                ;
                                ;	** latter test  **
                                ;
  1DE4'                         lettst:: ;	a : cahracter
  1DE4'   FE 41                 	cp	'A'
  1DE6'   D8                    	ret	c
  1DE7'   FE 5B                 	cp	'Z'+1
  1DE9'   3F                    	ccf
  1DEA'   D0                    	ret	nc
  1DEB'   FE 61                 	cp	'a'
  1DED'   D8                    	ret	c
  1DEE'   FE 7B                 	cp	'z'+1
  1DF0'   3F                    	ccf			; cy = 1 : non letter
  1DF1'   C9                    	ret			; cy = 0 : letter
                                ;
                                ;	**  convert decimal string into binary value  **
                                ;
  1DF2'                         decbin:: ;	de : string address
  1DF2'   21 0000               	ld	hl,0
  1DF5'                         decbin1:
  1DF5'   1A                    	ld	a,(de)
  1DF6'   D6 30                 	sub	'0'		; a := m(de) - '0'
  1DF8'   FE 0A                 	cp	9+1		;numeric ?
  1DFA'   D0                    	ret	nc		;return if not ( hl : value )
  1DFB'   44                    	ld	b,h
  1DFC'   4D                    	ld	c,l
  1DFD'   29                    	add	hl,hl
  1DFE'   38 12                 	jr	c,dcoverr
  1E00'   29                    	add	hl,hl
  1E01'   38 0F                 	jr	c,dcoverr
  1E03'   09                    	add	hl,bc
  1E04'   38 0C                 	jr	c,dcoverr
  1E06'   29                    	add	hl,hl		; hl := hl * 10
  1E07'   38 09                 	jr	c,dcoverr
  1E09'   4F                    	ld	c,a
  1E0A'   06 00                 	ld	b,0
  1E0C'   09                    	add	hl,bc		; hl := hl + a
  1E0D'   38 03                 	jr	c,dcoverr
  1E0F'   13                    	inc	de
  1E10'   18 E3                 	jr	decbin1
                                ;
  1E12'                         dcoverr:
  1E12'   2A 0014"              	ld	hl,(eptr)
  1E15'   11 0026"              	ld	de,strbuf
  1E18'   06 0F                 	ld	b,strbfe-strbuf-1
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-79
Rev 1.01  08/30/1984

  1E1A'                         dcver1:
  1E1A'   7E                    	ld	a,(hl)
  1E1B'   CD 1DCB'              	call	numtst
  1E1E'   38 49                 	jr	c,hcver3
  1E20'   05                    	dec	b
  1E21'   04                    	inc	b
  1E22'   28 03                 	jr	z,dcver2
  1E24'   12                    	ld	(de),a
  1E25'   13                    	inc	de
  1E26'   05                    	dec	b
  1E27'                         dcver2:
  1E27'   23                    	inc	hl
  1E28'   18 F0                 	jr	dcver1
                                ;
                                ;	**  convert hex string into binary value  **
                                ;
  1E2A'                         hexbin:: ;	de : string
  1E2A'   21 0000               	ld	hl,0
  1E2D'                         hexbin1:
  1E2D'   1A                    	ld	a,(de)
  1E2E'   CD 1DD2'              	call	hextst		;hexadecimal ?
  1E31'   D8                    	ret	c		;return if not ( hl : value )
  1E32'   CD 1DB5'              	call	traupc		;translate to upper case
  1E35'   D6 30                 	sub	'0'
  1E37'   FE 0A                 	cp	9+1
  1E39'   38 02                 	jr	c,hexbin2
  1E3B'   D6 07                 	sub	'A'-'9'-1
  1E3D'                         hexbin2:
  1E3D'   4F                    	ld	c,a
  1E3E'   06 00                 	ld	b,0
  1E40'   7C                    	ld	a,h
  1E41'   E6 F0                 	and	0f0h
  1E43'   20 08                 	jr	nz,hcoverr
  1E45'   29                    	add	hl,hl
  1E46'   29                    	add	hl,hl
  1E47'   29                    	add	hl,hl
  1E48'   29                    	add	hl,hl		; hl := hl << 4
  1E49'   09                    	add	hl,bc
  1E4A'   13                    	inc	de
  1E4B'   18 E0                 	jr	hexbin1
                                ;
  1E4D'                         hcoverr:
  1E4D'   2A 0014"              	ld	hl,(eptr)
  1E50'   11 0026"              	ld	de,strbuf
  1E53'   06 0E                 	ld	b,strbfe-strbuf-2
  1E55'   7E                    	ld	a,(hl)
  1E56'   23                    	inc	hl
  1E57'   12                    	ld	(de),a		;move '$' character
  1E58'   13                    	inc	de
  1E59'                         hcver1:
  1E59'   7E                    	ld	a,(hl)
  1E5A'   CD 1DD2'              	call	hextst
  1E5D'   38 0A                 	jr	c,hcver3
  1E5F'   05                    	dec	b
  1E60'   04                    	inc	b
  1E61'   28 03                 	jr	z,hcver2
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-80
Rev 1.01  08/30/1984

  1E63'   12                    	ld	(de),a
  1E64'   13                    	inc	de
  1E65'   05                    	dec	b
  1E66'                         hcver2:
  1E66'   23                    	inc	hl
  1E67'   18 F0                 	jr	hcver1
  1E69'                         hcver3:
  1E69'   E5                    	push	hl
  1E6A'   AF                    	xor	a
  1E6B'   12                    	ld	(de),a
  1E6C'   CD 1FBB'              	call	illcon
  1E6F'   D1                    	pop	de
  1E70'   21 0000               	ld	hl,0
  1E73'   C9                    	ret
                                ;
                                ;	**  error  **
                                ;
                                
                                ;
                                ;  missing variable name
                                ;
  1E74'                         misvar::
  1E74'   11 1E7D'              	ld	de,mvar
  1E77'   CD 1E98'              	call	ermisn
  1E7A'   36 02                 	ld	(hl),2
  1E7C'   C9                    	ret
  1E7D'   76 61 72 69           mvar:	defb	'variable',0
  1E81'   61 62 6C 65           
  1E85'   00                    
                                ;
                                ; missing constant name
                                ;
  1E86'                         miscon::
  1E86'   11 1E8F'              	ld	de,mcon
  1E89'   CD 1E98'              	call	ermisn
  1E8C'   36 01                 	ld	(hl),1
  1E8E'   C9                    	ret
  1E8F'   63 6F 6E 73           mcon:	defb	'constant',0
  1E93'   74 61 6E 74           
  1E97'   00                    
                                ;
  1E98'                         ermisn:
  1E98'   21 0000               	ld	hl,0
  1E9B'   22 0023"              	ld	(adrs),hl
  1E9E'   21 1EA8'              	ld	hl,mserm
  1EA1'   CD 0000*              	call	error
  1EA4'   21 0016"              	ld	hl,idetyp
  1EA7'   C9                    	ret
  1EA8'   23 4D 69 73           mserm:	defb	'#Missing \ name : @'
  1EAC'   73 69 6E 67           
  1EB0'   20 5C 20 6E           
  1EB4'   61 6D 65 20           
  1EB8'   3A 20 40              
  1EBB'   0017"                 	defw	identi
  1EBD'   00                    	defb	0
                                ;
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-81
Rev 1.01  08/30/1984

                                ; bad option switch
                                ;
  1EBE'                         opserr::
  1EBE'   21 1EC4'              	ld	hl,opserm
  1EC1'   C3 2053'              	jp	abt
  1EC4'   23 42 61 64           opserm:	defb	'#Bad option switch',0
  1EC8'   20 6F 70 74           
  1ECC'   69 6F 6E 20           
  1ED0'   73 77 69 74           
  1ED4'   63 68 00              
                                ;
                                ; illegal function name
                                ;
  1ED7'                         ilferr::
  1ED7'   21 1EDD'              	ld	hl,ilferm
  1EDA'   C3 2053'              	jp	abt
  1EDD'   23                    ilferm:	defb	'#'
  1EDE'   49 6C 6C 65           illfun:	defb	'Illegal function name',0
  1EE2'   67 61 6C 20           
  1EE6'   66 75 6E 63           
  1EEA'   74 69 6F 6E           
  1EEE'   20 6E 61 6D           
  1EF2'   65 00                 
                                ;
  1EF4'                         ilefun::
  1EF4'   21 1EFD'              	ld	hl,ilefum
  1EF7'   11 0017"              	ld	de,identi
  1EFA'   C3 0000*              	jp	error
  1EFD'   23 40                 ilefum:	defb	'#@'
  1EFF'   1EDE'                 	defw	illfun
  1F01'   20 3A 20 5C           	defb	' : \',0
  1F05'   00                    
                                ;
                                ; illegal name
                                ;
  1F06'                         ilnerr::
  1F06'   21 1F0C'              	ld	hl,ilnerm
  1F09'   C3 2053'              	jp	abt
  1F0C'   23                    ilnerm:	defb	'#'
  1F0D'   49 6C 6C 65           illnam:	defb	'Illegal name',0
  1F11'   67 61 6C 20           
  1F15'   6E 61 6D 65           
  1F19'   00                    
                                ;
  1F1A'                         ilenam::
  1F1A'   21 1F23'              	ld	hl,ilenmm
  1F1D'   11 0017"              	ld	de,identi
  1F20'   C3 0000*              	jp	error
  1F23'   23 40                 ilenmm:	defb	'#@'
  1F25'   1F0D'                 	defw	illnam
  1F27'   20 3A 20 5C           	defb	' : \',0
  1F2B'   00                    
                                ;
                                ; illegal label
                                ;
  1F2C'                         ilelab::
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-82
Rev 1.01  08/30/1984

  1F2C'   11 0017"              	ld	de,identi
  1F2F'   21 1F35'              	ld	hl,illbem
  1F32'   C3 0000*              	jp	error
  1F35'   23 49 6C 6C           illbem:	defb	'#Illegal label : \',0
  1F39'   65 67 61 6C           
  1F3D'   20 6C 61 62           
  1F41'   65 6C 20 3A           
  1F45'   20 5C 00              
                                ;
                                ; bad string data
                                ;
  1F48'                         bstrdt::
  1F48'   21 1F4E'              	ld	hl,bstrms
  1F4B'   C3 0000*              	jp	error
  1F4E'   23 42 61 64           bstrms:	defb	'#Bad string data',00
  1F52'   20 73 74 72           
  1F56'   69 6E 67 20           
  1F5A'   64 61 74 61           
  1F5E'   00                    
                                ;
                                ; too many arguments
                                ;
  1F5F'                         tmarg::
  1F5F'   21 1F65'              	ld	hl,tmargm
  1F62'   C3 0000*              	jp	error
  1F65'   23 54 6F 6F           tmargm:	defb	'#Too many arguments',0
  1F69'   20 6D 61 6E           
  1F6D'   79 20 61 72           
  1F71'   67 75 6D 65           
  1F75'   6E 74 73 00           
                                ;
                                ; illegal character
                                ;
  1F79'                         illchr::
  1F79'   21 1F82'              	ld	hl,illchm
  1F7C'   11 0026"              	ld	de,strbuf
  1F7F'   C3 2053'              	jp	abt
  1F82'   23 49 6C 6C           illchm:	defb	'#Illegal character : \',0
  1F86'   65 67 61 6C           
  1F8A'   20 63 68 61           
  1F8E'   72 61 63 74           
  1F92'   65 72 20 3A           
  1F96'   20 5C 00              
                                ;
                                ; illegal constant
                                ;
  1F99'                         ilcnds::
  1F99'   11 1F9E'              	ld	de,ilcndm
  1F9C'   18 20                 	jr	illcon1
  1F9E'   64 69 73 70           ilcndm:	defb	'displacement',0
  1FA2'   6C 61 63 65           
  1FA6'   6D 65 6E 74           
  1FAA'   00                    
                                ;
  1FAB'                         ilcnor::
  1FAB'   11 1FB0'              	ld	de,ilcnom
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-83
Rev 1.01  08/30/1984

  1FAE'   18 0E                 	jr	illcon1
  1FB0'   6F 76 65 72           ilcnom:	defb	'over range',0
  1FB4'   20 72 61 6E           
  1FB8'   67 65 00              
                                ;
  1FBB'                         illcon:
  1FBB'   11 0026"              	ld	de,strbuf
  1FBE'                         illcon1:
  1FBE'   21 1FC8'              	ld	hl,illcnm
  1FC1'   CD 0000*              	call	error
  1FC4'   21 0000               	ld	hl,0
  1FC7'   C9                    	ret
  1FC8'   23 49 6C 6C           illcnm:	defb	'#Illegal constant : \',0
  1FCC'   65 67 61 6C           
  1FD0'   20 63 6F 6E           
  1FD4'   73 74 61 6E           
  1FD8'   74 20 3A 20           
  1FDC'   5C 00                 
                                ;
                                ; bad constant
                                ;
  1FDE'                         badcon::
  1FDE'   21 1FE4'              	ld	hl,badcnm
  1FE1'   C3 2053'              	jp	abt
  1FE4'   23 42 61 64           badcnm:	defb	'#Bad constant',0
  1FE8'   20 63 6F 6E           
  1FEC'   73 74 61 6E           
  1FF0'   74 00                 
                                ;
                                ; bad address constant
                                ;
  1FF2'                         conerr::
  1FF2'   21 1FF8'              	ld	hl,bdadcm
  1FF5'   C3 2053'              	jp	abt
  1FF8'   23 42 61 64           bdadcm:	defb	'#Bad address constant',0
  1FFC'   20 61 64 64           
  2000'   72 65 73 73           
  2004'   20 63 6F 6E           
  2008'   73 74 61 6E           
  200C'   74 00                 
                                ;
                                ; syntax error
                                ;
  200E'                         synerr::
  200E'   21 2014'              	ld	hl,syems
  2011'   C3 2053'              	jp	abt
  2014'   23 53 79 6E           syems:	defb	'#Syntax error',0
  2018'   74 61 78 20           
  201C'   65 72 72 6F           
  2020'   72 00                 
                                ;
                                ; bad index operation
                                ;
  2022'                         idxerr::
  2022'   21 2028'              	ld	hl,idems
  2025'   C3 2053'              	jp	abt
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-84
Rev 1.01  08/30/1984

  2028'   23 42 61 64           idems:	defb	'#Bad index operation',0
  202C'   20 69 6E 64           
  2030'   65 78 20 6F           
  2034'   70 65 72 61           
  2038'   74 69 6F 6E           
  203C'   00                    
                                ;
                                ; bad expression
                                ;
  203D'                         experr::
  203D'   21 2043'              	ld	hl,exems
  2040'   C3 2053'              	jp	abt
  2043'   23 42 61 64           exems:	defb	'#Bad expression',0
  2047'   20 65 78 70           
  204B'   72 65 73 73           
  204F'   69 6F 6E 00           
                                ;
                                ;	abort
  2053'                         abt:
  2053'   CD 0000*              	call	error
  2056'   C3 0000*              	jp	abort
                                	
                                ;------------------------------------------------------
                                ;-		w o r k   a r e a
                                ;------------------------------------------------------
  2059'                         	dseg
                                	
  0000"                         cptr::		defs	2	;character pointer ( source program )
  0002"                         lino::		defs	2	;source line number
  0004"                         optisw::	defs	1	;option switch
  0005"                         stmflg::	defs	1	;not 00h; statement, 00h: non statement
                                
  0006"                         codorg::	defs	2	;code segment origin address
  0008"                         datorg::	defs	2	;data segment origin address
  000A"                         stkbot::	defs	2	;stack bottom address + 1
                                
  000C"                         cloc::		defs	2	;code location counter
  000E"                         dloc::		defs	2	;data location counter
  0010"                         wloc::		defs	2	;work data location counter
  0012"                         conval::	defs	2	;constant value
                                
  0014"                         eptr::		defs	2	;error string pointer
  0016"                         idetyp::	defs	1	;identifier type
  0017"                         identi::	defs	12	;identifier ( max 12 character )
  0023"                         adrs::		defs	2	;address ( & constant value )
  0025"                         		defs	1	;filler
                                		
  0026"                         strbuf::	defs	16	;string buffer
  0036"                         strbfe		equ	$
                                
  0036"                         tokcod::	defs	1	;token code
  0037"                         localf::	defs	1	; 00h: global, not 00h: local
  0038"                         datinl::	defs	1	; 01h: data declare, 02h inline statment
  0039"                         loopb::		defs	1	;not 00h: use loop # statement
  003A"                         puhptf::	defs	1	;not 00h: object " PUSH  AF " output
                                
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	1-85
Rev 1.01  08/30/1984

  003B"                         optble::	defs	1	;operand table store length
  003C"                         oprtbl::	defs	3*20	;operand table
  0078"                         oprtbe		equ	$
                                
  0078"                         caladr::	defs	2	;function & subroutine call address
                                
  007A"                         lopadr::	defs	2	;loop address
  007C"                         extadr::	defs	2	;exit address
  007E"                         convar::	defs	2	;constant variable address
  0080"                         terpar::	defs	2	;terminal parameter address
  0082"                         incpar::	defs	2	;incrementation parameter address
  0084"                         skpadr::	defs	2	;skip address
  0086"                         nxtadr::	defs	2	;next address
                                
  0088"                         varadr::	defs	2	;variable address
  008A"                         varsiz::	defs	2	;variable size
                                
  008C"                         idxpsf::	defs	1	;index push flag
  008D"                         retjad::	defs	2	;return statement jump address
                                
  008F"                         work.e::
                                
                                	end
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	S
Rev 1.01  08/30/1984

Macros:

Symbols:
0000*	@DIV.M          118D*	@DIV.R          0000*	@MUL.M          
11A7*	@MUL.R          0000*	@PROG           0000*	@REM.M          
1174*	@REM.R          0000*	@RETAD          0457*	@RTWORK         
0000*	@SETAG          0000*	@SHL.M          115B*	@SHL.R          
0000*	@SHR.M          1142*	@SHR.R          0436*	@START          
0000*	@STOP           0000*	@STPTP          0000*	@TEMP           
0000*	@VAR            2057*	ABORT           2053'	ABT             
110B'	ADDCE           110E'	ADDCV           10F5'	ADDEC           
10ED'	ADDEE           10F0'	ADDEV           10DD'	ADDOBJ          
1105'	ADDVC           10F8'	ADDVE           10FD'	ADDVV           
0023I"	ADRS            0EF8'	ANDCE           0EFB'	ANDCV           
0EE2'	ANDEC           0EDA'	ANDEE           0EDD'	ANDEV           
0ECA'	ANDOBJ          0EF2'	ANDVC           0EE5'	ANDVE           
0EEA'	ANDVV           0FB7I'	ARIEXP          0FBA'	ARIEXP0         
0FBD'	ARIEXP1         0FCF'	ARIEXP2         0FE2'	ARIEXP3         
0FF5'	ARIEXP4         100E'	ARIEXP5         1FE4'	BADCNM          
1FDEI'	BADCON          1FF8'	BDADCM          1B03I'	BLKPOP          
1AF3I'	BLKPSH          071FI'	BRKSTM          1F48I'	BSTRDT          
1F4E'	BSTRMS          19EDI'	BYTCON          1A13'	BYTCON1         
1A1F'	BYTCON2         1A28'	BYTCON3         0078I"	CALADR          
1B8B'	CCHER1          1B96'	CCHER2          1389'	CHKPAR          
000CI"	CLOC            00EA*	CLRSTB          188FI'	CODGEN          
189A'	CODGEN0         18A7'	CODGEN1         192B'	CODGEN10        
1930'	CODGEN15        18B3'	CODGEN2         18C3'	CODGEN3         
18CC'	CODGEN4         18DA'	CODGEN5         18EB'	CODGEN6         
1915'	CODGEN7         191B'	CODGEN8         0006I"	CODORG          
1D92I'	COMENT          1D93'	COMENT1         1DAB'	COMENT2         
0000I'	COMPIL          0029'	COMPIL1         0047'	COMPIL2         
006E'	COMPIL3         007B'	COMPIL4         0087'	COMPIL5         
00A1'	COMPIL6         00AD'	COMPIL7         0788I'	COMPOU          
078B'	COMPOU1         075CI'	COMSTM          0784'	COMSTM1         
04CAI'	CONDEF          1FF2I'	CONERR          19C7I'	CONEXP          
19CA'	CONEXP1         19E2'	CONEXP2         16F0I'	CONST           
16F5'	CONST5          16FF'	CONST6          0012I"	CONVAL          
007EI"	CONVAR          0000I"	CPTR            041F*	CRELAT          
05AC'	DATDCL          05C1'	DATDCL1         05C4'	DATDCL2         
05F1'	DATDCL3         05FB'	DATDCL4         0610'	DATDCL5         
061F'	DATDCL5.5       0626'	DATDCL6         0639'	DATDCL7         
0645'	DATDCL8         0038I"	DATINL          0008I"	DATORG          
1E12'	DCOVERR         1E1A'	DCVER1          1E27'	DCVER2          
0229*	DDSPFN          1B37*	DDSPLI          1DF2I'	DECBIN          
1DF5'	DECBIN1         1856I'	DECOPT          049EI'	DEFDCL          
04A1'	DEFDCL1         04B0'	DEFDCL2         04B9'	DEFDCL3         
04C2'	DEFDCL4         0487I'	DEFICN          0490'	DEFICN1         
0156*	DEFSTA          0DA0I'	DEX             12D7'	DIVCE           
12DE'	DIVCV           12B6'	DIVEC           12A9'	DIVEE           
12AF'	DIVEV           1299'	DIVOBJ          12CE'	DIVVC           
12BC'	DIVVE           12C4'	DIVVV           000EI"	DLOC            
0423*	DRELAT          0000*	DSAIND          0787'	DUMSTM          
1876I'	DYAGEN          1B23*	EDINCL          01AE*	ELISYM          
03E8I'	ENDCOM          0014I"	EPTR            1E98'	ERMISN          
2054*	ERROR           2043'	EXEMS           203DI'	EXPERR          
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	S-1
Rev 1.01  08/30/1984

136AI'	EXPR            0DBD'	EXPR0           0DCB'	EXPR1           
0DCF'	EXPR2           0DD2'	EXPR5           0DE9'	EXPR6           
0DBAI'	EXPRE           0DAFI'	EXPRES          1371'	EXPRX           
1374'	EXPRX1          138C'	EXPRY           007CI"	EXTADR          
0A7BI'	EXTSTM          1332I'	FACTOR          1335'	FACTOR0         
1355'	FACTOR1         1361'	FACTOR2         1367'	FACTOR5         
08EE'	FOROBJ1         08F9'	FOROBJ2         07CCI'	FORSTM          
085F'	FORSTM1         089F'	FORSTM3         08B8'	FORSTM4         
08DD'	FORSTM8         1394I'	FUN?            0404'	FUNATI          
1736I'	FUNC1           172DI'	FUNCAL          1761'	FUNCAL1         
1765'	FUNCAL2         178E'	FUNCAL3         17A3'	FUNCAL4         
17B0'	FUNCAL5         17CB'	FUNCAL5.2       17D3'	FUNCAL5.5       
17DF'	FUNCAL6         17F6'	FUNCAL6.2       17FE'	FUNCAL6.5       
1808'	FUNCAL7         1815'	FUNCAL8         1AD6'	FUNCHK          
1AF1'	FUNCHK1         01ADI'	FUNCTI          01D3'	FUNCTI0         
01DE'	FUNCTI1         01FB'	FUNCTI1.5       02C3'	FUNCTI10        
02D6'	FUNCTI11        02EC'	FUNCTI12        030E'	FUNCTI13        
0332'	FUNCTI14        0343'	FUNCTI15        0359'	FUNCTI16        
036F'	FUNCTI17        03B5'	FUNCTI18        03C1'	FUNCTI19        
0203'	FUNCTI2         024E'	FUNCTI3         0288'	FUNCTI5         
0296'	FUNCTI6         02A1'	FUNCTI7         02B3'	FUNCTI8         
02BE'	FUNCTI9         1DAC*	GETSOU          0A93I'	GOSTM           
0A9BI'	GOTSTM          0AB5'	GOTSTM1         0AD3'	GOTSTM2         
0AE6'	GOTSTM3         1B0FI'	GTOKEN          1B18'	GTOKEN0         
1B1D'	GTOKEN1         1B22'	GTOKEN1.5       1BA5'	GTOKEN10        
1BB3'	GTOKEN11        1BB5'	GTOKEN12        1BC5'	GTOKEN13        
1BCB'	GTOKEN14        1BD4'	GTOKEN15        1BD7'	GTOKEN16        
1BEA'	GTOKEN17        1BF2'	GTOKEN18        1BF8'	GTOKEN19        
1B2C'	GTOKEN2         1BFB'	GTOKEN20        1BFF'	GTOKEN25        
1C1A'	GTOKEN27        1C29'	GTOKEN28        1C38'	GTOKEN29        
1B3F'	GTOKEN3         1B53'	GTOKEN3.5       1C41'	GTOKEN30        
1C43'	GTOKEN31        1C44'	GTOKEN31.5      1C4A'	GTOKEN32        
1C4B'	GTOKEN33        1C4F'	GTOKEN35        1B61'	GTOKEN4         
1B71'	GTOKEN5         1B76'	GTOKEN6         1B9E'	GTOKEN7         
1E4D'	HCOVERR         1E59'	HCVER1          1E66'	HCVER2          
1E69'	HCVER3          1E2AI'	HEXBIN          1E2D'	HEXBIN1         
1E3D'	HEXBIN2         1DD2I'	HEXTST          0715I'	ICLSTM          
2028'	IDEMS           0017I"	IDENTI          0016I"	IDETYP          
0B8D'	IDOPAD          2022I'	IDXERR          0B71I'	IDXOPR          
008CI"	IDXPSF          0B97I'	IDXSET          0BA0'	IDXSET1         
0C12'	IDXSET10        0C24'	IDXSET11        0C33'	IDXSET12        
0BBB'	IDXSET2         0BC0'	IDXSET3         0BD2'	IDXSET4         
0BFA'	IDXSET5         0C08'	IDXSET6         0C0C'	IDXSET7         
09F7I'	IFSTM           0A08'	IFSTM1          0A3E'	IFSTM2          
0A4B'	IFSTM3          0A5C'	IFSTM4          0A64'	IFSTM5          
1F9E'	ILCNDM          1F99I'	ILCNDS          1FB0'	ILCNOM          
1FABI'	ILCNOR          1EFD'	ILEFUM          1EF4I'	ILEFUN          
1F2CI'	ILELAB          1F1AI'	ILENAM          1F23'	ILENMM          
1EDD'	ILFERM          1ED7I'	ILFERR          1F35'	ILLBEM          
1F82'	ILLCHM          1F79I'	ILLCHR          1FC8'	ILLCNM          
1FBB'	ILLCON          1FBE'	ILLCON1         1EDE'	ILLFUN          
1F0D'	ILLNAM          1F0C'	ILNERM          1F06I'	ILNERR          
071A*	INCLU           0082I"	INCPAR          16E8'	INDOBJ          
05A5I'	INLSTM          0D9DI'	INX             15BB'	ITEOBJ          
153AI'	ITRFUN          1545'	ITRFUN1         158A'	ITRFUN2         
15C1'	ITRFUN3         15DF'	ITRFUN4         15F0'	ITRFUN5         
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	S-2
Rev 1.01  08/30/1984

1603'	ITRFUN6         1606'	ITRFUN7         15E9'	ITRFUN8         
1588'	LDAM            09F4'	LDBIM           0DEC'	LDEXA           
0DF0'	LDIME           0C44I'	LDX             0C50'	LDX1            
0C7A'	LDX2            0CAA'	LDX3            0CBC'	LDX5            
0CC6'	LDX6            0CD2'	LDX7            0CDD'	LDXOBJ1         
0CE1'	LDXOBJ2         1DE4I'	LETTST          0002I"	LINO            
0037I"	LOCALF          0DF5I'	LOGEXP          0DF8'	LOGEXP1         
0E0A'	LOGEXP4         0E20'	LOGEXP6         0F01I'	LOGFAC          
0F04'	LOGFAC0         0F13'	LOGFAC1         0F2A'	LOGFAC2         
0F30'	LOGFAC3         0EA4I'	LOGTEM          0EA7'	LOGTEM0         
0EAA'	LOGTEM1         0EB4'	LOGTEM2         0039I"	LOOPB           
007AI"	LOPADR          098C'	LOPSTB          09C6'	LOPSTB1         
09C9'	LOPSTB2         09CE'	LOPSTB3         09EA'	LOPSTB4         
0902I'	LOPSTM          010FI'	MAIN            0149'	MAIN0           
0132'	MAIN0.5         013F'	MAIN0.6         0168'	MAIN1           
016D'	MAIN2           1E8F'	MCON            13EBI'	MEMOR           
1449'	MEMOR1          14B7'	MEMOR10         14D8'	MEMOR11         
14F0'	MEMOR12         144E'	MEMOR2          1451'	MEMOR3          
146E'	MEMOR4          1471'	MEMOR5          1483'	MEMOR6          
1490'	MEMOR7          1497'	MEMOR8          14A3'	MEMOR9          
1060'	MINCC           1054'	MINCE           1059'	MINCV           
103D'	MINEC           1034'	MINEE           1038'	MINEV           
1024'	MINOBJ          104E'	MINVC           1040'	MINVE           
1046'	MINVV           1E86I'	MISCON          1E74I'	MISVAR          
1994'	MOVNAM1         198CI'	MOVNAME         1EA8'	MSERM           
1323'	MULCE           1329'	MULCV           1303'	MULEC           
12F7'	MULEE           12FC'	MULEV           12E7'	MULOBJ          
131A'	MULVC           1309'	MULVE           1310'	MULVV           
1E7D'	MVAR            0F35'	NOTOBJ          1DCBI'	NUMTST          
1DC8I'	NXSPSK          0086I"	NXTADR          00B8 	OPR1B           
B9B9 	OPR1W           00BA 	OPR2B           BBBB 	OPR2W           
1863I'	OPREXC          186C'	OPREXC1         0078"	OPRTBE          
003CI"	OPRTBL          1EC4'	OPSERM          1EBEI'	OPSERR          
003BI"	OPTBLE          0004I"	OPTISW          0E64'	ORCE            
0E67'	ORCV            0E4E'	OREC            0E46'	OREE            
0E49'	OREV            0E36'	OROBJ           0E5E'	ORVC            
0E51'	ORVE            0E56'	ORVV            0417I'	OTRUNT          
0425'	OTRUNT1         0446'	OTRUNT2         0467'	OTRUNT3         
046F'	OTRUNT4         0474'	OTRUNT5         1944I'	PACOD           
0733*	PBREAK          03F1'	PGNATI          109C'	PLUCC           
1093'	PLUCE           1096'	PLUCV           107D'	PLUEC           
1075'	PLUEE           1078'	PLUEV           1065'	PLUOBJ          
108D'	PLUVC           1080'	PLUVE           1085'	PLUVV           
0B5DI'	POPLEA          14F3I'	PORT            1532'	PORT1           
1831I'	PROPT           0225*	PRTMSG          0B45I'	PSHLEA          
19B7I'	PTCHA           19BA'	PTCHA1          1953I'	PTCOD1          
1964I'	PTCOD2          196E'	PTCOD3          1966'	PTCODW          
1959'	PTCODX          1979'	PTCODY          0B2AI'	PTJR            
0B43'	PTJR1           19B2I'	PTLOC           199FI'	PTNAME          
19A5'	PTNAME1         003AI"	PUHPTF          03E9*	PUTGLO          
19C5*	PUTOBJ          1AD1*	REGSYM          0F3AI'	RELEXP          
0F57'	RELEXP1         0F62'	RELEXP10        0F6A'	RELEXP20        
0F72'	RELEXP21        0F79'	RELEXP30        0F84'	RELEXP31        
0F8A'	RELEXP40        0F9B'	RELEXP50        0FAB'	RELEXP60        
0FA2'	RELOBJ0         0F91'	RELOBJ1         0F83'	RELOBJ2         
0F71'	RELOBJ3         1289'	REMCE           1290'	REMCV           
Stellar compiler  compile module	MACRO-80 3.44	17-Feb-82	PAGE	S-3
Rev 1.01  08/30/1984

1268'	REMEC           125B'	REMEE           1261'	REMEV           
124B'	REMOBJ          1280'	REMVC           126E'	REMVE           
1276'	REMVV           0135*	RETADR          008DI"	RETJAD          
0AF1I'	RETSTM          0B0E'	RETSTM1         0B13'	RETSTM2         
1C58I'	RSWORD          1A62*	SEASYM          123B'	SHLCE           
1242'	SHLCV           121A'	SHLEC           120D'	SHLEE           
1213'	SHLEV           11FD'	SHLOBJ          1232'	SHLVC           
1220'	SHLVE           1228'	SHLVV           11ED'	SHRCE           
11F4'	SHRCV           11CC'	SHREC           11BF'	SHREE           
11C5'	SHREV           11AF'	SHROBJ          11E4'	SHRVC           
11D2'	SHRVE           11DA'	SHRVV           0084I"	SKPADR          
1D77I'	SPECHA          1D92'	SPECHE          1DBEI'	SPSKIP          
0686I'	STATEM          06B6'	STATEM0         06BC'	STATEM1         
06CD'	STATEM2         000AI"	STKBOT          06FB'	STMADR          
06EE'	STMCOD          06FB'	STMCODE         0005I"	STMFLG          
183DI'	STOPTB          0B16I'	STPSTM          0000*	STPTYP          
0036"	STRBFE          0026I"	STRBUF          0CEDI'	STX             
0D35'	STX1            0D5F'	STX2            0D6C'	STX3            
0D85'	STX4            0D90'	STXOBJ1         0D98'	STXOBJ2         
10D1'	SUBCE           10D6'	SUBCV           10BA'	SUBEC           
10B1'	SUBEE           10B5'	SUBEV           10A1'	SUBOBJ          
0FFD'	SUBTRA          10CB'	SUBVC           10BD'	SUBVE           
10C3'	SUBVV           2014'	SYEMS           0662I'	SYMCHK          
0676'	SYMCHK1         067E'	SYMCHK2         200EI'	SYNERR          
1114I'	TERM            1117'	TERM0           111A'	TERM1           
1130'	TERM2           1149'	TERM3           1162'	TERM4           
117B'	TERM5           1194'	TERM6           0080I"	TERPAR          
1F5FI'	TMARG           1F65'	TMARGM          0036I"	TOKCOD          
1DB5I'	TRAUPC          0757*	TROFF           074AI'	TROFST          
0745*	TRON            0738I'	TRONST          1704'	UFUNCL          
1707'	UFUNCL1         164B'	UVARCK          0088I"	VARADR          
161EI'	VARDAT          165E'	VARDAT0         1685'	VARDAT1         
16B3'	VARDAT2         16B9'	VARDAT4         16C9'	VARDAT5         
16E1'	VARDAT6         050FI'	VARDCL          054C'	VARDCL1         
0572'	VARDCL2         008AI"	VARSIZ          0796I'	WHISTM          
0010I"	WLOC            1A01I'	WODCON          1A2F'	WODCON0         
1A3A'	WODCON1         1A52'	WODCON2         1A7A'	WODCON4         
1A7D'	WODCON5         1A83'	WODCON6         1AA4'	WODCON7         
1AB0'	WODCON8         1AC6'	WODCON9         008FI"	WORK.E          
0DF3'	XORA            0E9B'	XORCE           0E9E'	XORCV           
0E85'	XOREC           0E7D'	XOREE           0E80'	XOREV           
0E6D'	XOROBJ          0E95'	XORVC           0E88'	XORVE           
0E8D'	XORVV           



No Fatal error(s)


  1A01I'	WODCON          1A2F'	WODCON0         
1A3A'	WODCON1         1A52'	WODCON2         1A7A'	WODCON4         
1A7D